<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Logistic regression | Reading Notes for Regression and Other Stories</title>
  <meta name="description" content="Chapter 13 Logistic regression | Reading Notes for Regression and Other Stories" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Logistic regression | Reading Notes for Regression and Other Stories" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="pherephobia/regression_hgv" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Logistic regression | Reading Notes for Regression and Other Stories" />
  
  
  

<meta name="author" content="Sanghoon Park" />


<meta name="date" content="2021-07-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="transformations-and-regression.html"/>
<link rel="next" href="simulation-1.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-88838732-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GHV</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-three-challenges-of-statistics"><i class="fa fa-check"></i><b>1.1</b> The three challenges of statistics</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-learn-regression"><i class="fa fa-check"></i><b>1.2</b> Why learn regression?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#some-examples-of-regression"><i class="fa fa-check"></i><b>1.3</b> Some examples of regression</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#a-randomized-experiment-on-the-effect-of-an-educational-television-program"><i class="fa fa-check"></i><b>1.3.1</b> A randomized experiment on the effect of an educational television program</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#comparing-the-peacekeeping-and-gun-control-studies"><i class="fa fa-check"></i><b>1.3.2</b> Comparing the peacekeeping and gun-control studies</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#challenges-in-building-understanding-and-interpreting-regressions"><i class="fa fa-check"></i><b>1.4</b> Challenges in building, understanding, and interpreting regressions</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#regression-to-estimate-a-relationship-of-interest"><i class="fa fa-check"></i><b>1.4.1</b> Regression to estimate a relationship of interest</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#regression-to-adjust-for-differences-between-treatment-and-control-groups"><i class="fa fa-check"></i><b>1.4.2</b> Regression to adjust for differences between treatment and control groups</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#interpreting-coefficients-in-a-predictive-model"><i class="fa fa-check"></i><b>1.4.3</b> Interpreting coefficients in a predictive model</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#building-interpreting-and-checking-regression-models"><i class="fa fa-check"></i><b>1.4.4</b> Building, interpreting, and checking regression models</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#classical-and-bayesian-inference"><i class="fa fa-check"></i><b>1.5</b> Classical and Bayesian inference</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#information"><i class="fa fa-check"></i><b>1.5.1</b> Information</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#assumptions"><i class="fa fa-check"></i><b>1.5.2</b> Assumptions</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#classical-inference"><i class="fa fa-check"></i><b>1.5.3</b> Classical inference</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#bayesian-inference"><i class="fa fa-check"></i><b>1.5.4</b> Bayesian inference</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#computing-least-squares-and-bayesian-regression"><i class="fa fa-check"></i><b>1.6</b> Computing least squares and Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-and-measurement.html"><a href="data-and-measurement.html"><i class="fa fa-check"></i><b>2</b> Data and Measurement</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#examining-where-data-come-from"><i class="fa fa-check"></i><b>2.1</b> Examining where data come from</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#details-of-measurement-can-be-important"><i class="fa fa-check"></i><b>2.1.1</b> Details of measurement can be important</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-and-measurement.html"><a href="data-and-measurement.html#validity-and-reliability"><i class="fa fa-check"></i><b>2.2</b> Validity and reliability</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#validity"><i class="fa fa-check"></i><b>2.2.1</b> Validity</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-and-measurement.html"><a href="data-and-measurement.html#reliability"><i class="fa fa-check"></i><b>2.2.2</b> Reliability</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-and-measurement.html"><a href="data-and-measurement.html#sample-selection"><i class="fa fa-check"></i><b>2.2.3</b> Sample selection</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-and-measurement.html"><a href="data-and-measurement.html#all-graphs-are-comparisons"><i class="fa fa-check"></i><b>2.3</b> All graphs are comparisons</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#simple-scatterplots"><i class="fa fa-check"></i><b>2.3.1</b> Simple scatterplots</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-and-measurement.html"><a href="data-and-measurement.html#displaying-more-information-on-a-graph"><i class="fa fa-check"></i><b>2.3.2</b> Displaying more information on a graph</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-and-measurement.html"><a href="data-and-measurement.html#multiple-plots"><i class="fa fa-check"></i><b>2.3.3</b> Multiple plots</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-and-measurement.html"><a href="data-and-measurement.html#grids-of-plots"><i class="fa fa-check"></i><b>2.3.4</b> Grids of plots</a></li>
<li class="chapter" data-level="2.3.5" data-path="data-and-measurement.html"><a href="data-and-measurement.html#applying-graphical-principles-to-numerical-displays-and-communication-more-generally"><i class="fa fa-check"></i><b>2.3.5</b> Applying graphical principles to numerical displays and communication more generally</a></li>
<li class="chapter" data-level="2.3.6" data-path="data-and-measurement.html"><a href="data-and-measurement.html#graphics-for-understanding-statistical-models"><i class="fa fa-check"></i><b>2.3.6</b> Graphics for understanding statistical models</a></li>
<li class="chapter" data-level="2.3.7" data-path="data-and-measurement.html"><a href="data-and-measurement.html#graphs-as-comparisons"><i class="fa fa-check"></i><b>2.3.7</b> Graphs as comparisons</a></li>
<li class="chapter" data-level="2.3.8" data-path="data-and-measurement.html"><a href="data-and-measurement.html#graphs-of-fitted-models"><i class="fa fa-check"></i><b>2.3.8</b> Graphs of fitted models</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-and-measurement.html"><a href="data-and-measurement.html#data-and-adjustment-trends-in-mortality-rates"><i class="fa fa-check"></i><b>2.4</b> Data and adjustment: trends in mortality rates</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html"><i class="fa fa-check"></i><b>3</b> Some Basic Methods in Mathematics and Probability</a>
<ul>
<li class="chapter" data-level="3.1" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#weighted-averages"><i class="fa fa-check"></i><b>3.1</b> Weighted averages</a></li>
<li class="chapter" data-level="3.2" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#vectors-and-matrices"><i class="fa fa-check"></i><b>3.2</b> Vectors and matrices</a></li>
<li class="chapter" data-level="3.3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#graphing-a-line"><i class="fa fa-check"></i><b>3.3</b> Graphing a line</a></li>
<li class="chapter" data-level="3.4" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#exponential-and-power-law-growth-and-decline-logarithmic-and-log-log-relationships"><i class="fa fa-check"></i><b>3.4</b> Exponential and power-law growth and decline; logarithmic and log-log relationships</a></li>
<li class="chapter" data-level="3.5" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#probability-distributions"><i class="fa fa-check"></i><b>3.5</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#mean-and-standard-deviation-of-a-probability-distribution"><i class="fa fa-check"></i><b>3.5.1</b> Mean and standard deviation of a probability distribution</a></li>
<li class="chapter" data-level="3.5.2" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#normal-distribution-mean-and-standard-deviation"><i class="fa fa-check"></i><b>3.5.2</b> Normal distribution; mean and standard deviation</a></li>
<li class="chapter" data-level="3.5.3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#linear-transformations"><i class="fa fa-check"></i><b>3.5.3</b> Linear transformations</a></li>
<li class="chapter" data-level="3.5.4" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#mean-and-standard-deviation-of-the-sum-of-correlated-random-variables"><i class="fa fa-check"></i><b>3.5.4</b> Mean and standard deviation of the sum of correlated random variables</a></li>
<li class="chapter" data-level="3.5.5" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#lognormal-distribution"><i class="fa fa-check"></i><b>3.5.5</b> Lognormal distribution</a></li>
<li class="chapter" data-level="3.5.6" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#binomial-distribution"><i class="fa fa-check"></i><b>3.5.6</b> Binomial distribution</a></li>
<li class="chapter" data-level="3.5.7" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#poisson-distribution"><i class="fa fa-check"></i><b>3.5.7</b> Poisson distribution</a></li>
<li class="chapter" data-level="3.5.8" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#unclassified-probability-distribution"><i class="fa fa-check"></i><b>3.5.8</b> Unclassified probability distribution</a></li>
<li class="chapter" data-level="3.5.9" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#probability-distributions-for-error"><i class="fa fa-check"></i><b>3.5.9</b> Probability distributions for error</a></li>
<li class="chapter" data-level="3.5.10" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#comparing-distributions"><i class="fa fa-check"></i><b>3.5.10</b> Comparing distributions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#probability-modeling"><i class="fa fa-check"></i><b>3.6</b> Probability modeling</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#using-an-empirical-forecast"><i class="fa fa-check"></i><b>3.6.1</b> Using an empirical forecast</a></li>
<li class="chapter" data-level="3.6.2" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#using-an-reasonable-seeming-but-inappropriate-probability-model"><i class="fa fa-check"></i><b>3.6.2</b> Using an reasonable-seeming but inappropriate probability model</a></li>
<li class="chapter" data-level="3.6.3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#general-lessons-for-probability-modeling"><i class="fa fa-check"></i><b>3.6.3</b> General lessons for probability modeling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-distributions-and-generative-models"><i class="fa fa-check"></i><b>4.1</b> Sampling distributions and generative models</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-measurement-error-and-model-error"><i class="fa fa-check"></i><b>4.1.1</b> Sampling, measurement error, and model error</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistical-inference.html"><a href="statistical-inference.html#the-sampling-distribution"><i class="fa fa-check"></i><b>4.1.2</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#estimates-standard-errors-and-confidence-intervals"><i class="fa fa-check"></i><b>4.2</b> Estimates, standard errors, and confidence intervals</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="statistical-inference.html"><a href="statistical-inference.html#parameters-estimands-and-estimates"><i class="fa fa-check"></i><b>4.2.1</b> Parameters, estimands, and estimates</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-errors-inferential-uncertainty-and-confidence-intervals"><i class="fa fa-check"></i><b>4.2.2</b> Standard errors, inferential uncertainty, and confidence intervals</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-errors-and-confidence-intervals-for-average-and-proportions"><i class="fa fa-check"></i><b>4.2.3</b> Standard errors and confidence intervals for average and proportions</a></li>
<li class="chapter" data-level="4.2.4" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-error-and-confidence-interval-for-a-proportion-when-y-0-or-y-n"><i class="fa fa-check"></i><b>4.2.4</b> Standard error and confidence interval for a proportion when <span class="math inline">\(y = 0\)</span> or <span class="math inline">\(y = n\)</span></a></li>
<li class="chapter" data-level="4.2.5" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-error-for-a-comparison"><i class="fa fa-check"></i><b>4.2.5</b> Standard error for a comparison</a></li>
<li class="chapter" data-level="4.2.6" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-distribution-of-the-sample-mean-and-standard-deviation-normal-and-chi2-distributions"><i class="fa fa-check"></i><b>4.2.6</b> Sampling distribution of the sample mean and standard deviation; normal and <span class="math inline">\(\chi^2\)</span> distributions</a></li>
<li class="chapter" data-level="4.2.7" data-path="statistical-inference.html"><a href="statistical-inference.html#degrees-of-freedom"><i class="fa fa-check"></i><b>4.2.7</b> Degrees of freedom</a></li>
<li class="chapter" data-level="4.2.8" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals-from-the-t-distribution"><i class="fa fa-check"></i><b>4.2.8</b> Confidence intervals from the <span class="math inline">\(t\)</span> distribution</a></li>
<li class="chapter" data-level="4.2.9" data-path="statistical-inference.html"><a href="statistical-inference.html#inference-for-discrete-data"><i class="fa fa-check"></i><b>4.2.9</b> Inference for discrete data</a></li>
<li class="chapter" data-level="4.2.10" data-path="statistical-inference.html"><a href="statistical-inference.html#linear-transformations-1"><i class="fa fa-check"></i><b>4.2.10</b> Linear transformations</a></li>
<li class="chapter" data-level="4.2.11" data-path="statistical-inference.html"><a href="statistical-inference.html#comparisons-visual-and-numerical"><i class="fa fa-check"></i><b>4.2.11</b> Comparisons, visual and numerical</a></li>
<li class="chapter" data-level="4.2.12" data-path="statistical-inference.html"><a href="statistical-inference.html#weighted-averages-1"><i class="fa fa-check"></i><b>4.2.12</b> Weighted averages</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#bias-and-unmodeled-uncertainty"><i class="fa fa-check"></i><b>4.3</b> Bias and unmodeled uncertainty</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="statistical-inference.html"><a href="statistical-inference.html#bias-in-estimation"><i class="fa fa-check"></i><b>4.3.1</b> Bias in estimation</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistical-inference.html"><a href="statistical-inference.html#adjusting-inferences-to-account-for-bias-and-unmodeled-uncertainty"><i class="fa fa-check"></i><b>4.3.2</b> Adjusting inferences to account for bias and unmodeled uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#statistical-significance-hypothesis-testing-and-statistical-errors"><i class="fa fa-check"></i><b>4.4</b> Statistical significance, hypothesis testing, and statistical errors</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#statistical-significance"><i class="fa fa-check"></i><b>4.4.1</b> Statistical significance</a></li>
<li class="chapter" data-level="4.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#hypothesis-testing-for-simple-comparisons."><i class="fa fa-check"></i><b>4.4.2</b> Hypothesis testing for simple comparisons.</a></li>
<li class="chapter" data-level="4.4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#hypothesis-testing-general-formulation."><i class="fa fa-check"></i><b>4.4.3</b> Hypothesis testing: general formulation.</a></li>
<li class="chapter" data-level="4.4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#comparisons-of-parameters-to-fixed-values-and-each-other-interpreting-confidence-intervals-as-hypothesis-tests."><i class="fa fa-check"></i><b>4.4.4</b> Comparisons of parameters to fixed values and each other: interpreting confidence intervals as hypothesis tests.</a></li>
<li class="chapter" data-level="4.4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#type-1-and-type-2-errors-and-why-we-dont-like-talking-about-them."><i class="fa fa-check"></i><b>4.4.5</b> Type 1 and type 2 errors and why we don’t like talking about them.</a></li>
<li class="chapter" data-level="4.4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#type-m-magnitude-and-type-s-sign-errors."><i class="fa fa-check"></i><b>4.4.6</b> 4.4.6 Type M (magnitude) and type S (sign) errors.</a></li>
<li class="chapter" data-level="4.4.7" data-path="statistical-inference.html"><a href="statistical-inference.html#hypothesis-testing-and-statistical-practice."><i class="fa fa-check"></i><b>4.4.7</b> Hypothesis testing and statistical practice.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#problems-with-the-concept-of-statistical-significance"><i class="fa fa-check"></i><b>4.5</b> Problems with the concept of statistical significance</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="statistical-inference.html"><a href="statistical-inference.html#statistical-significance-is-not-the-same-as-practical-importance."><i class="fa fa-check"></i><b>4.5.1</b> Statistical significance is not the same as practical importance.</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistical-inference.html"><a href="statistical-inference.html#non-significance-is-not-the-same-as-zero."><i class="fa fa-check"></i><b>4.5.2</b> Non-significance is not the same as zero.</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistical-inference.html"><a href="statistical-inference.html#the-difference-between-significant-and-not-significant-is-not-itself-statistically-significant."><i class="fa fa-check"></i><b>4.5.3</b> The difference between “significant” and “not significant” is not itself statistically significant.</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistical-inference.html"><a href="statistical-inference.html#researcher-degrees-of-freedom-p-hacking-and-forking-paths."><i class="fa fa-check"></i><b>4.5.4</b> Researcher degrees of freedom, <span class="math inline">\(p\)</span>-hacking, and forking paths.</a></li>
<li class="chapter" data-level="4.5.5" data-path="statistical-inference.html"><a href="statistical-inference.html#the-statistical-significance-filter."><i class="fa fa-check"></i><b>4.5.5</b> The statistical significance filter.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#moving-beyond-hypothesis-testing"><i class="fa fa-check"></i><b>4.6</b> Moving beyond hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>5</b> Simulation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulation.html"><a href="simulation.html#simulation-of-discrete-probability-models"><i class="fa fa-check"></i><b>5.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="simulation.html"><a href="simulation.html#how-many-girls-in-400-births"><i class="fa fa-check"></i><b>5.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="5.1.2" data-path="simulation.html"><a href="simulation.html#accounting-for-twins"><i class="fa fa-check"></i><b>5.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="simulation.html"><a href="simulation.html#simulation-of-continuous-and-mixed-discretecontinuous-models"><i class="fa fa-check"></i><b>5.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="simulation.html"><a href="simulation.html#simulation-in-r-using-custom-made-functions"><i class="fa fa-check"></i><b>5.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulation.html"><a href="simulation.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation"><i class="fa fa-check"></i><b>5.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="5.4" data-path="simulation.html"><a href="simulation.html#bootstrapping-to-simulate-a-sampling-distribution"><i class="fa fa-check"></i><b>5.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="simulation.html"><a href="simulation.html#choices-in-defining-the-bootstrap-distribution"><i class="fa fa-check"></i><b>5.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="5.4.2" data-path="simulation.html"><a href="simulation.html#limitations-of-bootstrapping"><i class="fa fa-check"></i><b>5.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="simulation.html"><a href="simulation.html#fake-data-simulation-as-a-way-of-life"><i class="fa fa-check"></i><b>5.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html"><i class="fa fa-check"></i><b>6</b> Background on regression modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#regression-models"><i class="fa fa-check"></i><b>6.1</b> Regression models</a></li>
<li class="chapter" data-level="6.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#fitting-a-simple-regression-to-fake-data"><i class="fa fa-check"></i><b>6.2</b> Fitting a simple regression to fake data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#fitting-a-regression-and-displaying-the-results"><i class="fa fa-check"></i><b>6.2.1</b> Fitting a regression and displaying the results</a></li>
<li class="chapter" data-level="6.2.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#comparing-estimates-to-assumed-parameter-values"><i class="fa fa-check"></i><b>6.2.2</b> Comparing estimates to assumed parameter values</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#interpret-coefficients-as-comparisons-not-effects"><i class="fa fa-check"></i><b>6.3</b> Interpret coefficients as comparisons, not effects</a></li>
<li class="chapter" data-level="6.4" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#historical-origins-of-regression"><i class="fa fa-check"></i><b>6.4</b> Historical origins of regression</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#daughters-heights-regressing-to-the-mean"><i class="fa fa-check"></i><b>6.4.1</b> Daughters’ heights “regressing” to the mean</a></li>
<li class="chapter" data-level="6.4.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#fitting-the-model-in-r"><i class="fa fa-check"></i><b>6.4.2</b> Fitting the model in R</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#the-paradox-of-regression-to-the-mean"><i class="fa fa-check"></i><b>6.5</b> The paradox of regression to the mean</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#how-regression-to-the-mean-can-confuse-people-about-causal-inference-demonstration-using-fake-data"><i class="fa fa-check"></i><b>6.5.1</b> How regression to the mean can confuse people about causal inference; demonstration using fake data</a></li>
<li class="chapter" data-level="6.5.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#relation-of-regression-to-the-mean-to-the-larger-themes-of-the-book"><i class="fa fa-check"></i><b>6.5.2</b> Relation of “regression to the mean” to the larger themes of the book</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html"><i class="fa fa-check"></i><b>7</b> Linear regression with a single predictor</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#example-predicting-presidential-vote-share-from-the-economy"><i class="fa fa-check"></i><b>7.1</b> Example: predicting presidential vote share from the economy</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#fitting-a-linear-model-to-data"><i class="fa fa-check"></i><b>7.1.1</b> Fitting a linear model to data</a></li>
<li class="chapter" data-level="7.1.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#understanding-the-fitted-model"><i class="fa fa-check"></i><b>7.1.2</b> Understanding the fitted model</a></li>
<li class="chapter" data-level="7.1.3" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#graphing-the-fitted-regression-line"><i class="fa fa-check"></i><b>7.1.3</b> Graphing the fitted regression line</a></li>
<li class="chapter" data-level="7.1.4" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#using-the-model-to-predict"><i class="fa fa-check"></i><b>7.1.4</b> Using the model to predict</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#checking-the-model-fitting-procedure-using-fake-data-simulation"><i class="fa fa-check"></i><b>7.2</b> Checking the model-fitting procedure using fake-data simulation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-1-creating-the-pretend-world"><i class="fa fa-check"></i><b>7.2.1</b> Step 1: Creating the pretend world</a></li>
<li class="chapter" data-level="7.2.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-2-simulating-fake-data"><i class="fa fa-check"></i><b>7.2.2</b> Step 2: Simulating fake data</a></li>
<li class="chapter" data-level="7.2.3" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-3-fitting-the-model-and-comparing-fitted-to-assumed-values"><i class="fa fa-check"></i><b>7.2.3</b> Step 3: Fitting the model and comparing fitted to assumed values</a></li>
<li class="chapter" data-level="7.2.4" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-4-embedding-the-simulation-in-a-loop"><i class="fa fa-check"></i><b>7.2.4</b> Step 4: Embedding the simulation in a loop</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#formulating-comparisons-as-regression-models"><i class="fa fa-check"></i><b>7.3</b> Formulating comparisons as regression models</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#estimating-the-mean-is-the-same-as-regressing-on-a-constant-term"><i class="fa fa-check"></i><b>7.3.1</b> Estimating the mean is the same as regressing on a constant term</a></li>
<li class="chapter" data-level="7.3.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#estimating-a-difference-is-the-same-as-regressing-on-an-indicator-variable"><i class="fa fa-check"></i><b>7.3.2</b> Estimating a difference is the same as regressing on an indicator variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html"><i class="fa fa-check"></i><b>8</b> Fitting regression models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#least-squares-maximum-likelihood-and-bayesian-inference"><i class="fa fa-check"></i><b>8.1</b> Least squares, maximum likelihood, and Bayesian inference</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#least-squares"><i class="fa fa-check"></i><b>8.1.1</b> Least squares</a></li>
<li class="chapter" data-level="8.1.2" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#estimation-of-residual-standard-deviation-sigma"><i class="fa fa-check"></i><b>8.1.2</b> Estimation of residual standard deviation <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="8.1.3" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#computing-the-sum-of-squares-directly"><i class="fa fa-check"></i><b>8.1.3</b> Computing the sum of squares directly</a></li>
<li class="chapter" data-level="8.1.4" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#maximum-likelihood"><i class="fa fa-check"></i><b>8.1.4</b> Maximum likelihood</a></li>
<li class="chapter" data-level="8.1.5" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#where-do-the-standard-errors-come-from-using-the-likelihood-surface-to-assess-uncertainty-in-the-parameter-estimates"><i class="fa fa-check"></i><b>8.1.5</b> Where do the standard errors come from? Using the likelihood surface to assess uncertainty in the parameter estimates</a></li>
<li class="chapter" data-level="8.1.6" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#bayesian-inference-1"><i class="fa fa-check"></i><b>8.1.6</b> Bayesian inference</a></li>
<li class="chapter" data-level="8.1.7" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#point-estimate-mode-based-approximation-and-posterior-simulations"><i class="fa fa-check"></i><b>8.1.7</b> Point estimate, mode-based approximation, and posterior simulations</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#influence-of-individual-points-in-a-fitted-regression"><i class="fa fa-check"></i><b>8.2</b> Influence of individual points in a fitted regression</a></li>
<li class="chapter" data-level="8.3" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#least-squares-slope-as-a-weighted-average-of-slopes-of-pairs"><i class="fa fa-check"></i><b>8.3</b> Least squares slope as a weighted average of slopes of pairs</a></li>
<li class="chapter" data-level="8.4" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#comparing-two-fitting-functions-lm-and-stan_glm"><i class="fa fa-check"></i><b>8.4</b> Comparing two fitting functions: <code>lm</code> and <code>stan_glm</code></a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#reproducing-maximum-likelihood-using-stan_glm-with-flat-priors-and-optimization"><i class="fa fa-check"></i><b>8.4.1</b> Reproducing maximum likelihood using <code>stan_glm</code> with flat priors and optimization</a></li>
<li class="chapter" data-level="8.4.2" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#running-lm"><i class="fa fa-check"></i><b>8.4.2</b> Running <code>lm</code></a></li>
<li class="chapter" data-level="8.4.3" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#confidence-intervals-uncertainty-intervals-compatibility-intervals"><i class="fa fa-check"></i><b>8.4.3</b> Confidence intervals, uncertainty intervals, compatibility intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html"><i class="fa fa-check"></i><b>9</b> Prediction and Bayesian inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#propagating-uncertainty-in-inference-using-posterior-simulations"><i class="fa fa-check"></i><b>9.1</b> Propagating uncertainty in inference using posterior simulations</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#uncertainty-in-the-regression-coefficients-and-implied-uncertainty-in-the-regression-line"><i class="fa fa-check"></i><b>9.1.1</b> Uncertainty in the regression coefficients and implied uncertainty in the regression line</a></li>
<li class="chapter" data-level="9.1.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#using-the-matrix-of-posterior-simulations-to-express-uncertainty-about-a-parameter-estimate-or-function-of-parameter-estimates"><i class="fa fa-check"></i><b>9.1.2</b> Using the matrix of posterior simulations to express uncertainty about a parameter estimate or function of parameter estimates</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prediction-and-uncertainty-predict-posterior_linpred-and-posterior_predict"><i class="fa fa-check"></i><b>9.2</b> Prediction and uncertainty: predict, posterior_linpred, and posterior_predict</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#point-prediction-using-predict"><i class="fa fa-check"></i><b>9.2.1</b> Point prediction using predict</a></li>
<li class="chapter" data-level="9.2.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#linear-predictor-with-uncertainty-using-posterior_linpred-or-posterior_epred"><i class="fa fa-check"></i><b>9.2.2</b> Linear predictor with uncertainty using posterior_linpred or posterior_epred</a></li>
<li class="chapter" data-level="9.2.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#predictive-distribution-for-a-new-observation-using-posterior_predict"><i class="fa fa-check"></i><b>9.2.3</b> Predictive distribution for a new observation using posterior_predict</a></li>
<li class="chapter" data-level="9.2.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prediction-given-a-range-of-input-values"><i class="fa fa-check"></i><b>9.2.4</b> Prediction given a range of input values</a></li>
<li class="chapter" data-level="9.2.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#propagating-uncertainty"><i class="fa fa-check"></i><b>9.2.5</b> Propagating uncertainty</a></li>
<li class="chapter" data-level="9.2.6" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#simulating-uncertainty-for-the-linear-predictor-and-new-observations"><i class="fa fa-check"></i><b>9.2.6</b> Simulating uncertainty for the linear predictor and new observations</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prior-information-and-bayesian-synthesis"><i class="fa fa-check"></i><b>9.3</b> Prior information and Bayesian synthesis</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#expressing-data-and-prior-information-on-the-same-scale"><i class="fa fa-check"></i><b>9.3.1</b> Expressing data and prior information on the same scale</a></li>
<li class="chapter" data-level="9.3.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#bayesian-information-aggregation"><i class="fa fa-check"></i><b>9.3.2</b> Bayesian information aggregation</a></li>
<li class="chapter" data-level="9.3.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#different-ways-of-assigning-prior-distributions-and-performing-bayesian-calculations"><i class="fa fa-check"></i><b>9.3.3</b> Different ways of assigning prior distributions and performing Bayesian calculations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#example-of-bayesian-inference-beauty-and-sex-ratio"><i class="fa fa-check"></i><b>9.4</b> Example of Bayesian inference: beauty and sex ratio</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prior-information"><i class="fa fa-check"></i><b>9.4.1</b> Prior information</a></li>
<li class="chapter" data-level="9.4.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prior-estimate-and-standard-error"><i class="fa fa-check"></i><b>9.4.2</b> Prior estimate and standard error</a></li>
<li class="chapter" data-level="9.4.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#data-estimate-and-standard-error"><i class="fa fa-check"></i><b>9.4.3</b> Data estimate and standard error</a></li>
<li class="chapter" data-level="9.4.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#bayes-estimate"><i class="fa fa-check"></i><b>9.4.4</b> Bayes estimate</a></li>
<li class="chapter" data-level="9.4.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#understanding-the-bayes-estimate"><i class="fa fa-check"></i><b>9.4.5</b> Understanding the Bayes estimate</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#uniform-weakly-informative-and-informative-priors-in-regression"><i class="fa fa-check"></i><b>9.5</b> Uniform, weakly informative, and informative priors in regression</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#uniform-prior-distribution"><i class="fa fa-check"></i><b>9.5.1</b> Uniform prior distribution</a></li>
<li class="chapter" data-level="9.5.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#default-prior-distribution"><i class="fa fa-check"></i><b>9.5.2</b> Default prior distribution</a></li>
<li class="chapter" data-level="9.5.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#weakly-informative-prior-distribution-based-on-subject-matter-knowledge"><i class="fa fa-check"></i><b>9.5.3</b> Weakly informative prior distribution based on subject-matter knowledge</a></li>
<li class="chapter" data-level="9.5.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#example-where-an-informative-prior-makes-a-difference-beauty-and-sex-ratio"><i class="fa fa-check"></i><b>9.5.4</b> Example where an informative prior makes a difference: Beauty and sex ratio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html"><i class="fa fa-check"></i><b>10</b> Linear regression with multiple predictors</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#adding-predictors-to-a-model"><i class="fa fa-check"></i><b>10.1</b> Adding predictors to a model</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#starting-with-a-binary-predictor"><i class="fa fa-check"></i><b>10.1.1</b> Starting with a binary predictor</a></li>
<li class="chapter" data-level="10.1.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#a-single-continuous-predictor"><i class="fa fa-check"></i><b>10.1.2</b> A single continuous predictor</a></li>
<li class="chapter" data-level="10.1.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#including-both-predictors"><i class="fa fa-check"></i><b>10.1.3</b> Including both predictors</a></li>
<li class="chapter" data-level="10.1.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#understanding-the-fitted-model-1"><i class="fa fa-check"></i><b>10.1.4</b> Understanding the fitted model</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#interpreting-regression-coefficients"><i class="fa fa-check"></i><b>10.2</b> Interpreting regression coefficients</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#its-not-always-possible-to-change-one-predictor-while-holding-all-others-constant"><i class="fa fa-check"></i><b>10.2.1</b> It’s not always possible to change one predictor while holding all others constant</a></li>
<li class="chapter" data-level="10.2.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#counterfactual-and-predictive-interpretations"><i class="fa fa-check"></i><b>10.2.2</b> Counterfactual and predictive interpretations</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#interactions"><i class="fa fa-check"></i><b>10.3</b> Interactions</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#when-should-we-look-for-interactions"><i class="fa fa-check"></i><b>10.3.1</b> When should we look for interactions?</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#interpreting-regression-coefficients-in-the-presence-of-interactions"><i class="fa fa-check"></i><b>10.3.2</b> Interpreting regression coefficients in the presence of interactions</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#indicator-variables"><i class="fa fa-check"></i><b>10.4</b> Indicator variables</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#centering-a-predictor"><i class="fa fa-check"></i><b>10.4.1</b> Centering a predictor</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#including-a-binary-variable-in-a-regression"><i class="fa fa-check"></i><b>10.4.2</b> Including a binary variable in a regression</a></li>
<li class="chapter" data-level="10.4.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#using-indicator-variables-for-multiple-levels-of-a-categorical-predictor"><i class="fa fa-check"></i><b>10.4.3</b> Using indicator variables for multiple levels of a categorical predictor</a></li>
<li class="chapter" data-level="10.4.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#changing-the-baseline-factor-level"><i class="fa fa-check"></i><b>10.4.4</b> Changing the baseline factor level</a></li>
<li class="chapter" data-level="10.4.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#using-an-index-variable-to-access-a-group-level-predictor"><i class="fa fa-check"></i><b>10.4.5</b> Using an index variable to access a group-level predictor</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#formulating-paired-or-blocked-designs-as-a-regression-problem"><i class="fa fa-check"></i><b>10.5</b> Formulating paired or blocked designs as a regression problem</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#completely-randomized-experiment"><i class="fa fa-check"></i><b>10.5.1</b> Completely randomized experiment</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#paired-design"><i class="fa fa-check"></i><b>10.5.2</b> Paired design</a></li>
<li class="chapter" data-level="10.5.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#block-design"><i class="fa fa-check"></i><b>10.5.3</b> Block design</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#example-uncertainty-in-predicting-congressional-elections"><i class="fa fa-check"></i><b>10.6</b> Example: uncertainty in predicting congressional elections</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#background"><i class="fa fa-check"></i><b>10.6.1</b> Background</a></li>
<li class="chapter" data-level="10.6.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#data-issues"><i class="fa fa-check"></i><b>10.6.2</b> Data issues</a></li>
<li class="chapter" data-level="10.6.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#fitting-the-model"><i class="fa fa-check"></i><b>10.6.3</b> Fitting the model</a></li>
<li class="chapter" data-level="10.6.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#simulation-for-inferences-and-predictions-of-new-data-points"><i class="fa fa-check"></i><b>10.6.4</b> Simulation for inferences and predictions of new data points</a></li>
<li class="chapter" data-level="10.6.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#predictive-simulation-for-a-nonlinear-function-of-new-data"><i class="fa fa-check"></i><b>10.6.5</b> Predictive simulation for a nonlinear function of new data</a></li>
<li class="chapter" data-level="10.6.6" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#combining-simulation-and-analytic-calculations"><i class="fa fa-check"></i><b>10.6.6</b> Combining simulation and analytic calculations</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#mathematical-notation-and-statistical-inference"><i class="fa fa-check"></i><b>10.7</b> Mathematical notation and statistical inference</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#predictors"><i class="fa fa-check"></i><b>10.7.1</b> Predictors</a></li>
<li class="chapter" data-level="10.7.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#regression-in-vector-matrix-notation"><i class="fa fa-check"></i><b>10.7.2</b> Regression in vector-matrix notation</a></li>
<li class="chapter" data-level="10.7.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#two-ways-of-writing-the-model"><i class="fa fa-check"></i><b>10.7.3</b> Two ways of writing the model</a></li>
<li class="chapter" data-level="10.7.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#nonidentified-parameters-collinearity-and-the-likelihood-function"><i class="fa fa-check"></i><b>10.7.4</b> Nonidentified parameters, collinearity, and the likelihood function</a></li>
<li class="chapter" data-level="10.7.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#hypothesis-testing-why-we-do-not-like-t-tests-and-f-tests"><i class="fa fa-check"></i><b>10.7.5</b> Hypothesis testing: why we do not like <span class="math inline">\(t\)</span> tests and <span class="math inline">\(F\)</span> tests</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#weighted-regression"><i class="fa fa-check"></i><b>10.8</b> Weighted regression</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#three-models-leading-to-weighted-regression"><i class="fa fa-check"></i><b>10.8.1</b> Three models leading to weighted regression</a></li>
<li class="chapter" data-level="10.8.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#using-a-matrix-of-weights-to-account-for-correlated-errors"><i class="fa fa-check"></i><b>10.8.2</b> Using a matrix of weights to account for correlated errors</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#fitting-the-same-model-to-many-datasets"><i class="fa fa-check"></i><b>10.9</b> Fitting the same model to many datasets</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#predicting-party-identification"><i class="fa fa-check"></i><b>10.9.1</b> Predicting party identification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html"><i class="fa fa-check"></i><b>11</b> Assumptions, diagnostics, and model evaluation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#assumptions-of-regression-analysis"><i class="fa fa-check"></i><b>11.1</b> Assumptions of regression analysis</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#failures-of-the-assumptions"><i class="fa fa-check"></i><b>11.1.1</b> Failures of the assumptions</a></li>
<li class="chapter" data-level="11.1.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#causal-inference"><i class="fa fa-check"></i><b>11.1.2</b> Causal inference</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#plotting-the-data-and-fitted-model"><i class="fa fa-check"></i><b>11.2</b> Plotting the data and fitted model</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-a-regression-line-as-a-function-of-one-input-variable"><i class="fa fa-check"></i><b>11.2.1</b> Displaying a regression line as a function of one input variable</a></li>
<li class="chapter" data-level="11.2.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-two-fitted-regression-lines"><i class="fa fa-check"></i><b>11.2.2</b> Displaying two fitted regression lines</a></li>
<li class="chapter" data-level="11.2.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-uncertainty-in-the-fitted-regression"><i class="fa fa-check"></i><b>11.2.3</b> Displaying uncertainty in the fitted regression</a></li>
<li class="chapter" data-level="11.2.4" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-using-one-plot-for-each-input-variable"><i class="fa fa-check"></i><b>11.2.4</b> Displaying using one plot for each input variable</a></li>
<li class="chapter" data-level="11.2.5" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#plotting-the-outcome-vs.-a-continuous-predictor"><i class="fa fa-check"></i><b>11.2.5</b> Plotting the outcome vs. a continuous predictor</a></li>
<li class="chapter" data-level="11.2.6" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#forming-a-linear-predictor-from-a-multiple-regression"><i class="fa fa-check"></i><b>11.2.6</b> Forming a linear predictor from a multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#residual-plots"><i class="fa fa-check"></i><b>11.3</b> Residual plots</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#using-fake-data-simulation-to-understand-residual-plots"><i class="fa fa-check"></i><b>11.3.1</b> Using fake-data simulation to understand residual plots</a></li>
<li class="chapter" data-level="11.3.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#a-confusing-choice-plot-residuals-vs.-predicted-values-or-residuals-vs.-observed-values"><i class="fa fa-check"></i><b>11.3.2</b> A confusing choice: plot residuals vs. predicted values, or residuals vs. observed values?</a></li>
<li class="chapter" data-level="11.3.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#understanding-the-choice-using-fake-data-simulation"><i class="fa fa-check"></i><b>11.3.3</b> Understanding the choice using fake-data simulation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#comparing-data-to-replications-from-a-fitted-model"><i class="fa fa-check"></i><b>11.4</b> Comparing data to replications from a fitted model</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#example-simulation-based-checking-of-a-fitted-normal-distribution"><i class="fa fa-check"></i><b>11.4.1</b> Example: simulation-based checking of a fitted normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#example-predictive-simulation-to-check-the-fit-of-a-time-series-model"><i class="fa fa-check"></i><b>11.5</b> Example: predictive simulation to check the fit of a time-series model</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#fitting-a-first-order-autoregression-to-the-unemployment-series"><i class="fa fa-check"></i><b>11.5.1</b> Fitting a first-order autoregression to the unemployment series</a></li>
<li class="chapter" data-level="11.5.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#simulating-replicated-datasets"><i class="fa fa-check"></i><b>11.5.2</b> Simulating replicated datasets</a></li>
<li class="chapter" data-level="11.5.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#visual-and-numerical-comparisons-of-replicated-to-actual-data"><i class="fa fa-check"></i><b>11.5.3</b> Visual and numerical comparisons of replicated to actual data</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#residual-standard-deviation-sigma-and-explained-variance-r2"><i class="fa fa-check"></i><b>11.6</b> Residual standard deviation <span class="math inline">\(\sigma\)</span> and explained variance <span class="math inline">\(R^2\)</span></a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#difficulties-in-interpreting-residual-standard-deviation-and-explained-variance"><i class="fa fa-check"></i><b>11.6.1</b> Difficulties in interpreting residual standard deviation and explained variance</a></li>
<li class="chapter" data-level="11.6.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#bayesian-r2"><i class="fa fa-check"></i><b>11.6.2</b> Bayesian <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#external-validation-checking-fitted-model-on-new-data"><i class="fa fa-check"></i><b>11.7</b> External validation: checking fitted model on new data</a></li>
<li class="chapter" data-level="11.8" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#cross-validation"><i class="fa fa-check"></i><b>11.8</b> Cross validation</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>11.8.1</b> Leave-one-out cross validation</a></li>
<li class="chapter" data-level="11.8.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#fast-leave-one-out-cross-validation"><i class="fa fa-check"></i><b>11.8.2</b> Fast leave-one-out cross validation</a></li>
<li class="chapter" data-level="11.8.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#summarizing-prediction-error-using-the-log-score-and-deviance"><i class="fa fa-check"></i><b>11.8.3</b> Summarizing prediction error using the log score and deviance</a></li>
<li class="chapter" data-level="11.8.4" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#overfitting-and-aic"><i class="fa fa-check"></i><b>11.8.4</b> Overfitting and AIC</a></li>
<li class="chapter" data-level="11.8.5" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#interpreting-differences-in-log-scores"><i class="fa fa-check"></i><b>11.8.5</b> Interpreting differences in log scores</a></li>
<li class="chapter" data-level="11.8.6" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#demonstration-of-adding-pure-noise-predictors-to-a-model"><i class="fa fa-check"></i><b>11.8.6</b> Demonstration of adding pure noise predictors to a model</a></li>
<li class="chapter" data-level="11.8.7" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>11.8.7</b> <span class="math inline">\(K\)</span>-fold cross validation</a></li>
<li class="chapter" data-level="11.8.8" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#demonstration-of-k-fold-cross-validation-using-simulated-data"><i class="fa fa-check"></i><b>11.8.8</b> Demonstration of <span class="math inline">\(K\)</span>-fold cross validation using simulated data</a></li>
<li class="chapter" data-level="11.8.9" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#concerns-about-model-selection"><i class="fa fa-check"></i><b>11.8.9</b> Concerns about model selection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html"><i class="fa fa-check"></i><b>12</b> Transformations and regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#linear-transformations-2"><i class="fa fa-check"></i><b>12.1</b> Linear transformations</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#scaling-of-predictors-and-regression-coefficients"><i class="fa fa-check"></i><b>12.1.1</b> Scaling of predictors and regression coefficients</a></li>
<li class="chapter" data-level="12.1.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardization-using-z-scores"><i class="fa fa-check"></i><b>12.1.2</b> Standardization using z-scores</a></li>
<li class="chapter" data-level="12.1.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardization-using-an-externally-specified-population-distribution"><i class="fa fa-check"></i><b>12.1.3</b> Standardization using an externally specified population distribution</a></li>
<li class="chapter" data-level="12.1.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardization-using-reasonable-scales"><i class="fa fa-check"></i><b>12.1.4</b> Standardization using reasonable scales</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#centering-and-standardizing-for-models-with-interactions"><i class="fa fa-check"></i><b>12.2</b> Centering and standardizing for models with interactions</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#centering-by-subtracting-the-mean-of-the-data"><i class="fa fa-check"></i><b>12.2.1</b> Centering by subtracting the mean of the data</a></li>
<li class="chapter" data-level="12.2.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-a-conventional-centering-point"><i class="fa fa-check"></i><b>12.2.2</b> Using a conventional centering point</a></li>
<li class="chapter" data-level="12.2.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardizing-by-subtracting-the-mean-and-dividing-by-2-standard-deviations"><i class="fa fa-check"></i><b>12.2.3</b> Standardizing by subtracting the mean and dividing by 2 standard deviations</a></li>
<li class="chapter" data-level="12.2.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#why-scale-by-2-standard-deviations"><i class="fa fa-check"></i><b>12.2.4</b> Why scale by 2 standard deviations?</a></li>
<li class="chapter" data-level="12.2.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#multiplying-each-regression-coefficient-by-2-standard-deviations-of-its-predictor"><i class="fa fa-check"></i><b>12.2.5</b> Multiplying each regression coefficient by 2 standard deviations of its predictor</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#correlation-and-regression-to-the-mean"><i class="fa fa-check"></i><b>12.3</b> Correlation and “regression to the mean”</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#the-principal-component-line-and-the-regression-line"><i class="fa fa-check"></i><b>12.3.1</b> The principal component line and the regression line</a></li>
<li class="chapter" data-level="12.3.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#regression-to-the-mean"><i class="fa fa-check"></i><b>12.3.2</b> Regression to the mean</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#logarithmic-transformations"><i class="fa fa-check"></i><b>12.4</b> Logarithmic transformations</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#earnings-and-height-example"><i class="fa fa-check"></i><b>12.4.1</b> Earnings and height example</a></li>
<li class="chapter" data-level="12.4.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#why-we-use-natural-log-rather-than-log-base-10"><i class="fa fa-check"></i><b>12.4.2</b> Why we use natural log rather than log base 10</a></li>
<li class="chapter" data-level="12.4.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#building-a-regression-model-on-the-log-scale"><i class="fa fa-check"></i><b>12.4.3</b> Building a regression model on the log scale</a></li>
<li class="chapter" data-level="12.4.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#further-difficulties-in-interpretation"><i class="fa fa-check"></i><b>12.4.4</b> Further difficulties in interpretation</a></li>
<li class="chapter" data-level="12.4.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#log-log-model-transforming-the-input-and-outcome-variables"><i class="fa fa-check"></i><b>12.4.5</b> Log-log model: transforming the input and outcome variables</a></li>
<li class="chapter" data-level="12.4.6" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#taking-logarithms-even-when-not-necessary"><i class="fa fa-check"></i><b>12.4.6</b> Taking logarithms even when not necessary</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#other-transformations"><i class="fa fa-check"></i><b>12.5</b> Other transformations</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#square-root-transformations"><i class="fa fa-check"></i><b>12.5.1</b> Square root transformations</a></li>
<li class="chapter" data-level="12.5.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#idiosyncratic-transformations"><i class="fa fa-check"></i><b>12.5.2</b> Idiosyncratic transformations</a></li>
<li class="chapter" data-level="12.5.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-continuous-rather-than-discrete-predictors"><i class="fa fa-check"></i><b>12.5.3</b> Using continuous rather than discrete predictors</a></li>
<li class="chapter" data-level="12.5.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-discrete-rather-than-continuous-predictors"><i class="fa fa-check"></i><b>12.5.4</b> Using discrete rather than continuous predictors</a></li>
<li class="chapter" data-level="12.5.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#index-and-indicator-variables"><i class="fa fa-check"></i><b>12.5.5</b> Index and indicator variables</a></li>
<li class="chapter" data-level="12.5.6" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#indicator-variables-identifiability-and-the-baseline-condition"><i class="fa fa-check"></i><b>12.5.6</b> Indicator variables, identifiability, and the baseline condition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#building-and-comparing-regression-models-for-prediction"><i class="fa fa-check"></i><b>12.6</b> Building and comparing regression models for prediction</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#general-principles"><i class="fa fa-check"></i><b>12.6.1</b> General principles</a></li>
<li class="chapter" data-level="12.6.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#example-predicting-the-yields-of-mesquite-bushes"><i class="fa fa-check"></i><b>12.6.2</b> Example: predicting the yields of mesquite bushes</a></li>
<li class="chapter" data-level="12.6.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-the-jacobian-to-adjust-the-predictive-comparison-after-a-transformation"><i class="fa fa-check"></i><b>12.6.3</b> Using the Jacobian to adjust the predictive comparison after a transformation</a></li>
<li class="chapter" data-level="12.6.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#constructing-a-simpler-model"><i class="fa fa-check"></i><b>12.6.4</b> Constructing a simpler model</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#models-for-regression-coefficients"><i class="fa fa-check"></i><b>12.7</b> Models for regression coefficients</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#other-models-for-regression-coefficients"><i class="fa fa-check"></i><b>12.7.1</b> Other models for regression coefficients</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>13</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="13.1" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-a-single-predictor"><i class="fa fa-check"></i><b>13.1</b> Logistic regression with a single predictor</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#example-modeling-political-preference-given-income"><i class="fa fa-check"></i><b>13.1.1</b> Example: modeling political preference given income</a></li>
<li class="chapter" data-level="13.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#the-logistic-regression-model"><i class="fa fa-check"></i><b>13.1.2</b> The logistic regression model</a></li>
<li class="chapter" data-level="13.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#fitting-the-model-using-stan_glm-and-displaying-uncertainty-in-the-fitted-model"><i class="fa fa-check"></i><b>13.1.3</b> Fitting the model using stan_glm and displaying uncertainty in the fitted model</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="logistic-regression.html"><a href="logistic-regression.html#interpreting-logistic-regression-coefficients-and-the-divide-by-4-rule"><i class="fa fa-check"></i><b>13.2</b> Interpreting logistic regression coefficients and the divide-by-4 rule</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#evaluation-at-and-near-the-mean-of-the-data"><i class="fa fa-check"></i><b>13.2.1</b> Evaluation at and near the mean of the data</a></li>
<li class="chapter" data-level="13.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#the-divide-by-4-rule"><i class="fa fa-check"></i><b>13.2.2</b> The divide-by-4 rule</a></li>
<li class="chapter" data-level="13.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#interpretation-of-coefficients-as-odds-ratios"><i class="fa fa-check"></i><b>13.2.3</b> Interpretation of coefficients as odds ratios</a></li>
<li class="chapter" data-level="13.2.4" data-path="logistic-regression.html"><a href="logistic-regression.html#coefficient-estimates-and-standard-errors"><i class="fa fa-check"></i><b>13.2.4</b> Coefficient estimates and standard errors</a></li>
<li class="chapter" data-level="13.2.5" data-path="logistic-regression.html"><a href="logistic-regression.html#statistical-significance-1"><i class="fa fa-check"></i><b>13.2.5</b> Statistical significance</a></li>
<li class="chapter" data-level="13.2.6" data-path="logistic-regression.html"><a href="logistic-regression.html#displaying-the-results-of-several-logistic-regressions"><i class="fa fa-check"></i><b>13.2.6</b> Displaying the results of several logistic regressions</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="logistic-regression.html"><a href="logistic-regression.html#predictions-and-comparisons"><i class="fa fa-check"></i><b>13.3</b> Predictions and comparisons</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#point-prediction-using-predict-1"><i class="fa fa-check"></i><b>13.3.1</b> Point prediction using <code>predict</code></a></li>
<li class="chapter" data-level="13.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#linear-predictor-with-uncertainty-using-posterior_linpred"><i class="fa fa-check"></i><b>13.3.2</b> Linear predictor with uncertainty using <code>posterior_linpred</code></a></li>
<li class="chapter" data-level="13.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#expected-outcome-with-uncertainty-using-posterior_epred"><i class="fa fa-check"></i><b>13.3.3</b> Expected outcome with uncertainty using <code>posterior_epred</code></a></li>
<li class="chapter" data-level="13.3.4" data-path="logistic-regression.html"><a href="logistic-regression.html#predictive-distribution-for-a-new-observation-using-posterior_predict-1"><i class="fa fa-check"></i><b>13.3.4</b> Predictive distribution for a new observation using <code>posterior_predict</code></a></li>
<li class="chapter" data-level="13.3.5" data-path="logistic-regression.html"><a href="logistic-regression.html#prediction-given-a-range-of-input-values-1"><i class="fa fa-check"></i><b>13.3.5</b> Prediction given a range of input values</a></li>
<li class="chapter" data-level="13.3.6" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-just-an-intercept"><i class="fa fa-check"></i><b>13.3.6</b> Logistic regression with just an intercept</a></li>
<li class="chapter" data-level="13.3.7" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-a-single-binary-predictor"><i class="fa fa-check"></i><b>13.3.7</b> Logistic regression with a single binary predictor</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="logistic-regression.html"><a href="logistic-regression.html#latent-data-formulation"><i class="fa fa-check"></i><b>13.4</b> Latent-data formulation</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#interpretation-of-the-latent-variables"><i class="fa fa-check"></i><b>13.4.1</b> Interpretation of the latent variables</a></li>
<li class="chapter" data-level="13.4.2" data-path="logistic-regression.html"><a href="logistic-regression.html#nonidentifiability-of-the-latent-scale-parameter"><i class="fa fa-check"></i><b>13.4.2</b> Nonidentifiability of the latent scale parameter</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="logistic-regression.html"><a href="logistic-regression.html#maximum-likelihood-and-bayesian-inference-for-logistic-regression"><i class="fa fa-check"></i><b>13.5</b> Maximum likelihood and Bayesian inference for logistic regression</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="logistic-regression.html"><a href="logistic-regression.html#maximum-likelihood-using-iteratively-weighted-least-squares"><i class="fa fa-check"></i><b>13.5.1</b> Maximum likelihood using iteratively weighted least squares</a></li>
<li class="chapter" data-level="13.5.2" data-path="logistic-regression.html"><a href="logistic-regression.html#bayesian-inference-with-a-uniform-prior-distribution"><i class="fa fa-check"></i><b>13.5.2</b> Bayesian inference with a uniform prior distribution</a></li>
<li class="chapter" data-level="13.5.3" data-path="logistic-regression.html"><a href="logistic-regression.html#default-prior-in-stan_glm"><i class="fa fa-check"></i><b>13.5.3</b> Default prior in <code>stan_glm</code></a></li>
<li class="chapter" data-level="13.5.4" data-path="logistic-regression.html"><a href="logistic-regression.html#bayesian-inference-with-some-prior-information"><i class="fa fa-check"></i><b>13.5.4</b> Bayesian inference with some prior information</a></li>
<li class="chapter" data-level="13.5.5" data-path="logistic-regression.html"><a href="logistic-regression.html#comparing-maximum-likelihood-and-bayesian-inference-using-a-simulation-study"><i class="fa fa-check"></i><b>13.5.5</b> Comparing maximum likelihood and Bayesian inference using a simulation study</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="logistic-regression.html"><a href="logistic-regression.html#cross-validation-and-log-score-for-logistic-regression"><i class="fa fa-check"></i><b>13.6</b> Cross validation and log score for logistic regression</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#understanding-the-log-score-for-discrete-predictions"><i class="fa fa-check"></i><b>13.6.1</b> Understanding the log score for discrete predictions</a></li>
<li class="chapter" data-level="13.6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#log-score-for-logistic-regression"><i class="fa fa-check"></i><b>13.6.2</b> Log score for logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>14</b> Simulation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="simulation-1.html"><a href="simulation-1.html#simulation-of-discrete-probability-models-1"><i class="fa fa-check"></i><b>14.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="simulation-1.html"><a href="simulation-1.html#how-many-girls-in-400-births-1"><i class="fa fa-check"></i><b>14.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="14.1.2" data-path="simulation-1.html"><a href="simulation-1.html#accounting-for-twins-1"><i class="fa fa-check"></i><b>14.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="simulation-1.html"><a href="simulation-1.html#simulation-of-continuous-and-mixed-discretecontinuous-models-1"><i class="fa fa-check"></i><b>14.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="simulation-1.html"><a href="simulation-1.html#simulation-in-r-using-custom-made-functions-1"><i class="fa fa-check"></i><b>14.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="simulation-1.html"><a href="simulation-1.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-1"><i class="fa fa-check"></i><b>14.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="14.4" data-path="simulation-1.html"><a href="simulation-1.html#bootstrapping-to-simulate-a-sampling-distribution-1"><i class="fa fa-check"></i><b>14.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="simulation-1.html"><a href="simulation-1.html#choices-in-defining-the-bootstrap-distribution-1"><i class="fa fa-check"></i><b>14.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="14.4.2" data-path="simulation-1.html"><a href="simulation-1.html#limitations-of-bootstrapping-1"><i class="fa fa-check"></i><b>14.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="simulation-1.html"><a href="simulation-1.html#fake-data-simulation-as-a-way-of-life-1"><i class="fa fa-check"></i><b>14.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>15</b> Simulation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="simulation-2.html"><a href="simulation-2.html#simulation-of-discrete-probability-models-2"><i class="fa fa-check"></i><b>15.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="simulation-2.html"><a href="simulation-2.html#how-many-girls-in-400-births-2"><i class="fa fa-check"></i><b>15.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="15.1.2" data-path="simulation-2.html"><a href="simulation-2.html#accounting-for-twins-2"><i class="fa fa-check"></i><b>15.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="simulation-2.html"><a href="simulation-2.html#simulation-of-continuous-and-mixed-discretecontinuous-models-2"><i class="fa fa-check"></i><b>15.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="simulation-2.html"><a href="simulation-2.html#simulation-in-r-using-custom-made-functions-2"><i class="fa fa-check"></i><b>15.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="simulation-2.html"><a href="simulation-2.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-2"><i class="fa fa-check"></i><b>15.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="15.4" data-path="simulation-2.html"><a href="simulation-2.html#bootstrapping-to-simulate-a-sampling-distribution-2"><i class="fa fa-check"></i><b>15.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="simulation-2.html"><a href="simulation-2.html#choices-in-defining-the-bootstrap-distribution-2"><i class="fa fa-check"></i><b>15.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="15.4.2" data-path="simulation-2.html"><a href="simulation-2.html#limitations-of-bootstrapping-2"><i class="fa fa-check"></i><b>15.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="simulation-2.html"><a href="simulation-2.html#fake-data-simulation-as-a-way-of-life-2"><i class="fa fa-check"></i><b>15.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="simulation-3.html"><a href="simulation-3.html"><i class="fa fa-check"></i><b>16</b> Simulation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="simulation-3.html"><a href="simulation-3.html#simulation-of-discrete-probability-models-3"><i class="fa fa-check"></i><b>16.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="simulation-3.html"><a href="simulation-3.html#how-many-girls-in-400-births-3"><i class="fa fa-check"></i><b>16.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="16.1.2" data-path="simulation-3.html"><a href="simulation-3.html#accounting-for-twins-3"><i class="fa fa-check"></i><b>16.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="simulation-3.html"><a href="simulation-3.html#simulation-of-continuous-and-mixed-discretecontinuous-models-3"><i class="fa fa-check"></i><b>16.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="simulation-3.html"><a href="simulation-3.html#simulation-in-r-using-custom-made-functions-3"><i class="fa fa-check"></i><b>16.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="simulation-3.html"><a href="simulation-3.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-3"><i class="fa fa-check"></i><b>16.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="16.4" data-path="simulation-3.html"><a href="simulation-3.html#bootstrapping-to-simulate-a-sampling-distribution-3"><i class="fa fa-check"></i><b>16.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="simulation-3.html"><a href="simulation-3.html#choices-in-defining-the-bootstrap-distribution-3"><i class="fa fa-check"></i><b>16.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="16.4.2" data-path="simulation-3.html"><a href="simulation-3.html#limitations-of-bootstrapping-3"><i class="fa fa-check"></i><b>16.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="simulation-3.html"><a href="simulation-3.html#fake-data-simulation-as-a-way-of-life-3"><i class="fa fa-check"></i><b>16.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="simulation-4.html"><a href="simulation-4.html"><i class="fa fa-check"></i><b>17</b> Simulation</a>
<ul>
<li class="chapter" data-level="17.1" data-path="simulation-4.html"><a href="simulation-4.html#simulation-of-discrete-probability-models-4"><i class="fa fa-check"></i><b>17.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="simulation-4.html"><a href="simulation-4.html#how-many-girls-in-400-births-4"><i class="fa fa-check"></i><b>17.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="17.1.2" data-path="simulation-4.html"><a href="simulation-4.html#accounting-for-twins-4"><i class="fa fa-check"></i><b>17.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="simulation-4.html"><a href="simulation-4.html#simulation-of-continuous-and-mixed-discretecontinuous-models-4"><i class="fa fa-check"></i><b>17.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="simulation-4.html"><a href="simulation-4.html#simulation-in-r-using-custom-made-functions-4"><i class="fa fa-check"></i><b>17.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="simulation-4.html"><a href="simulation-4.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-4"><i class="fa fa-check"></i><b>17.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="17.4" data-path="simulation-4.html"><a href="simulation-4.html#bootstrapping-to-simulate-a-sampling-distribution-4"><i class="fa fa-check"></i><b>17.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="simulation-4.html"><a href="simulation-4.html#choices-in-defining-the-bootstrap-distribution-4"><i class="fa fa-check"></i><b>17.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="17.4.2" data-path="simulation-4.html"><a href="simulation-4.html#limitations-of-bootstrapping-4"><i class="fa fa-check"></i><b>17.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="simulation-4.html"><a href="simulation-4.html#fake-data-simulation-as-a-way-of-life-4"><i class="fa fa-check"></i><b>17.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="simulation-5.html"><a href="simulation-5.html"><i class="fa fa-check"></i><b>18</b> Simulation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="simulation-5.html"><a href="simulation-5.html#simulation-of-discrete-probability-models-5"><i class="fa fa-check"></i><b>18.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="simulation-5.html"><a href="simulation-5.html#how-many-girls-in-400-births-5"><i class="fa fa-check"></i><b>18.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="18.1.2" data-path="simulation-5.html"><a href="simulation-5.html#accounting-for-twins-5"><i class="fa fa-check"></i><b>18.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="simulation-5.html"><a href="simulation-5.html#simulation-of-continuous-and-mixed-discretecontinuous-models-5"><i class="fa fa-check"></i><b>18.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="simulation-5.html"><a href="simulation-5.html#simulation-in-r-using-custom-made-functions-5"><i class="fa fa-check"></i><b>18.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="simulation-5.html"><a href="simulation-5.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-5"><i class="fa fa-check"></i><b>18.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="18.4" data-path="simulation-5.html"><a href="simulation-5.html#bootstrapping-to-simulate-a-sampling-distribution-5"><i class="fa fa-check"></i><b>18.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="simulation-5.html"><a href="simulation-5.html#choices-in-defining-the-bootstrap-distribution-5"><i class="fa fa-check"></i><b>18.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="18.4.2" data-path="simulation-5.html"><a href="simulation-5.html#limitations-of-bootstrapping-5"><i class="fa fa-check"></i><b>18.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="simulation-5.html"><a href="simulation-5.html#fake-data-simulation-as-a-way-of-life-5"><i class="fa fa-check"></i><b>18.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="simulation-6.html"><a href="simulation-6.html"><i class="fa fa-check"></i><b>19</b> Simulation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="simulation-6.html"><a href="simulation-6.html#simulation-of-discrete-probability-models-6"><i class="fa fa-check"></i><b>19.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="simulation-6.html"><a href="simulation-6.html#how-many-girls-in-400-births-6"><i class="fa fa-check"></i><b>19.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="19.1.2" data-path="simulation-6.html"><a href="simulation-6.html#accounting-for-twins-6"><i class="fa fa-check"></i><b>19.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="simulation-6.html"><a href="simulation-6.html#simulation-of-continuous-and-mixed-discretecontinuous-models-6"><i class="fa fa-check"></i><b>19.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="simulation-6.html"><a href="simulation-6.html#simulation-in-r-using-custom-made-functions-6"><i class="fa fa-check"></i><b>19.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="simulation-6.html"><a href="simulation-6.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-6"><i class="fa fa-check"></i><b>19.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="19.4" data-path="simulation-6.html"><a href="simulation-6.html#bootstrapping-to-simulate-a-sampling-distribution-6"><i class="fa fa-check"></i><b>19.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="simulation-6.html"><a href="simulation-6.html#choices-in-defining-the-bootstrap-distribution-6"><i class="fa fa-check"></i><b>19.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="19.4.2" data-path="simulation-6.html"><a href="simulation-6.html#limitations-of-bootstrapping-6"><i class="fa fa-check"></i><b>19.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="simulation-6.html"><a href="simulation-6.html#fake-data-simulation-as-a-way-of-life-6"><i class="fa fa-check"></i><b>19.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simulation-7.html"><a href="simulation-7.html"><i class="fa fa-check"></i><b>20</b> Simulation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="simulation-7.html"><a href="simulation-7.html#simulation-of-discrete-probability-models-7"><i class="fa fa-check"></i><b>20.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="simulation-7.html"><a href="simulation-7.html#how-many-girls-in-400-births-7"><i class="fa fa-check"></i><b>20.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="20.1.2" data-path="simulation-7.html"><a href="simulation-7.html#accounting-for-twins-7"><i class="fa fa-check"></i><b>20.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="simulation-7.html"><a href="simulation-7.html#simulation-of-continuous-and-mixed-discretecontinuous-models-7"><i class="fa fa-check"></i><b>20.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="simulation-7.html"><a href="simulation-7.html#simulation-in-r-using-custom-made-functions-7"><i class="fa fa-check"></i><b>20.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="simulation-7.html"><a href="simulation-7.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-7"><i class="fa fa-check"></i><b>20.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="20.4" data-path="simulation-7.html"><a href="simulation-7.html#bootstrapping-to-simulate-a-sampling-distribution-7"><i class="fa fa-check"></i><b>20.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="simulation-7.html"><a href="simulation-7.html#choices-in-defining-the-bootstrap-distribution-7"><i class="fa fa-check"></i><b>20.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="20.4.2" data-path="simulation-7.html"><a href="simulation-7.html#limitations-of-bootstrapping-7"><i class="fa fa-check"></i><b>20.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="simulation-7.html"><a href="simulation-7.html#fake-data-simulation-as-a-way-of-life-7"><i class="fa fa-check"></i><b>20.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="simulation-8.html"><a href="simulation-8.html"><i class="fa fa-check"></i><b>21</b> Simulation</a>
<ul>
<li class="chapter" data-level="21.1" data-path="simulation-8.html"><a href="simulation-8.html#simulation-of-discrete-probability-models-8"><i class="fa fa-check"></i><b>21.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="simulation-8.html"><a href="simulation-8.html#how-many-girls-in-400-births-8"><i class="fa fa-check"></i><b>21.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="21.1.2" data-path="simulation-8.html"><a href="simulation-8.html#accounting-for-twins-8"><i class="fa fa-check"></i><b>21.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="simulation-8.html"><a href="simulation-8.html#simulation-of-continuous-and-mixed-discretecontinuous-models-8"><i class="fa fa-check"></i><b>21.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="simulation-8.html"><a href="simulation-8.html#simulation-in-r-using-custom-made-functions-8"><i class="fa fa-check"></i><b>21.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="simulation-8.html"><a href="simulation-8.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-8"><i class="fa fa-check"></i><b>21.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="21.4" data-path="simulation-8.html"><a href="simulation-8.html#bootstrapping-to-simulate-a-sampling-distribution-8"><i class="fa fa-check"></i><b>21.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="simulation-8.html"><a href="simulation-8.html#choices-in-defining-the-bootstrap-distribution-8"><i class="fa fa-check"></i><b>21.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="21.4.2" data-path="simulation-8.html"><a href="simulation-8.html#limitations-of-bootstrapping-8"><i class="fa fa-check"></i><b>21.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="simulation-8.html"><a href="simulation-8.html#fake-data-simulation-as-a-way-of-life-8"><i class="fa fa-check"></i><b>21.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="simulation-9.html"><a href="simulation-9.html"><i class="fa fa-check"></i><b>22</b> Simulation</a>
<ul>
<li class="chapter" data-level="22.1" data-path="simulation-9.html"><a href="simulation-9.html#simulation-of-discrete-probability-models-9"><i class="fa fa-check"></i><b>22.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="simulation-9.html"><a href="simulation-9.html#how-many-girls-in-400-births-9"><i class="fa fa-check"></i><b>22.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="22.1.2" data-path="simulation-9.html"><a href="simulation-9.html#accounting-for-twins-9"><i class="fa fa-check"></i><b>22.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="simulation-9.html"><a href="simulation-9.html#simulation-of-continuous-and-mixed-discretecontinuous-models-9"><i class="fa fa-check"></i><b>22.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="simulation-9.html"><a href="simulation-9.html#simulation-in-r-using-custom-made-functions-9"><i class="fa fa-check"></i><b>22.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="simulation-9.html"><a href="simulation-9.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-9"><i class="fa fa-check"></i><b>22.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="22.4" data-path="simulation-9.html"><a href="simulation-9.html#bootstrapping-to-simulate-a-sampling-distribution-9"><i class="fa fa-check"></i><b>22.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="simulation-9.html"><a href="simulation-9.html#choices-in-defining-the-bootstrap-distribution-9"><i class="fa fa-check"></i><b>22.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="22.4.2" data-path="simulation-9.html"><a href="simulation-9.html#limitations-of-bootstrapping-9"><i class="fa fa-check"></i><b>22.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="simulation-9.html"><a href="simulation-9.html#fake-data-simulation-as-a-way-of-life-9"><i class="fa fa-check"></i><b>22.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html"><i class="fa fa-check"></i><b>23</b> Exercises of Regression and Other Stories</a>
<ul>
<li class="chapter" data-level="23.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#overview-1"><i class="fa fa-check"></i><b>23.1</b> Overview</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#from-design-to-decision"><i class="fa fa-check"></i><b>23.1.1</b> From design to decision</a></li>
<li class="chapter" data-level="23.1.2" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#sketching-a-regression-model-and-data"><i class="fa fa-check"></i><b>23.1.2</b> Sketching a regression model and data</a></li>
<li class="chapter" data-level="23.1.3" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#goals-of-regression"><i class="fa fa-check"></i><b>23.1.3</b> Goals of regression</a></li>
<li class="chapter" data-level="23.1.4" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#problems-of-statistics"><i class="fa fa-check"></i><b>23.1.4</b> Problems of statistics</a></li>
<li class="chapter" data-level="23.1.5" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#goals-of-regression-1"><i class="fa fa-check"></i><b>23.1.5</b> Goals of regression</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#causal-inference-1"><i class="fa fa-check"></i><b>23.2</b> Causal inference</a></li>
<li class="chapter" data-level="23.3" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#statistics-as-generalization"><i class="fa fa-check"></i><b>23.3</b> Statistics as generalization</a></li>
<li class="chapter" data-level="23.4" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#statistics-as-generalization-1"><i class="fa fa-check"></i><b>23.4</b> Statistics as generalization</a></li>
<li class="chapter" data-level="23.5" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#a-problem-with-linear-models"><i class="fa fa-check"></i><b>23.5</b> A problem with linear models</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#working-through-your-own-example"><i class="fa fa-check"></i><b>23.5.1</b> Working through your own example</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#some-basic-methods-in-mathematics-and-probability-1"><i class="fa fa-check"></i><b>23.6</b> Some basic methods in mathematics and probability</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#weighted-averages-2"><i class="fa fa-check"></i><b>23.6.1</b> Weighted averages</a></li>
<li class="chapter" data-level="23.6.2" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#weighted-averages-3"><i class="fa fa-check"></i><b>23.6.2</b> Weighted averages</a></li>
<li class="chapter" data-level="23.6.3" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#probability-distributions-1"><i class="fa fa-check"></i><b>23.6.3</b> Probability distributions</a></li>
<li class="chapter" data-level="23.6.4" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#probability-distributions-2"><i class="fa fa-check"></i><b>23.6.4</b> Probability distributions</a></li>
<li class="chapter" data-level="23.6.5" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#probability-distributions-3"><i class="fa fa-check"></i><b>23.6.5</b> Probability distributions</a></li>
<li class="chapter" data-level="23.6.6" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#linear-transformations-3"><i class="fa fa-check"></i><b>23.6.6</b> Linear transformations</a></li>
<li class="chapter" data-level="23.6.7" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#linear-transformations-4"><i class="fa fa-check"></i><b>23.6.7</b> Linear transformations</a></li>
<li class="chapter" data-level="23.6.8" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#correlated-random-variables"><i class="fa fa-check"></i><b>23.6.8</b> Correlated random variables</a></li>
<li class="chapter" data-level="23.6.9" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#comparison-of-distributions"><i class="fa fa-check"></i><b>23.6.9</b> Comparison of distributions</a></li>
<li class="chapter" data-level="23.6.10" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#working-through-your-own-example-1"><i class="fa fa-check"></i><b>23.6.10</b> Working through your own example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reading Notes for Regression and Other Stories</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1" number="13">
<h1><span class="header-section-number">Chapter 13</span> Logistic regression</h1>
<p>선형회귀모델은 가산형 모델(additive model)로 결과변수인 <span class="math inline">\(y\)</span>가 0 또는 1의 값을 취하는 이항 결과변수에는 적절하지 않다.</p>
<ul>
<li><p>이항변수로 모델을 만들기 위해서는 <span class="math inline">\(y=a+bx\)</span>라는 기본 모델에 두 가지를 더 추가해야 한다.</p>
<ol style="list-style-type: decimal">
<li><p>0과 1 사이로 결과를 한정하는 비선형 변환</p></li>
<li><p>결과를 확률로 취급하여 무작위 이항 결과로 이끌어내는 모델</p></li>
</ol></li>
</ul>
<p>모델의 비선형성은 해석과 모델 수립을 더 까다롭게 만드는 부분이 있어서 이 챕터에서는 그와 관련된 내용을 주로 다룬다.</p>
<div id="logistic-regression-with-a-single-predictor" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Logistic regression with a single predictor</h2>
<p>로지스틱(logistic) 함수는 다음과 같다:</p>
<p><span class="math display">\[
\text{logit}(x) = \log\bigg(\frac{x}{1-x}\bigg),
\]</span></p>
<p>이 함수를 통해 우리는 <span class="math inline">\((0, 1)\)</span>의 범주를 <span class="math inline">\((-\infty, \infty)\)</span>로 취급하여 확률을 모델링하는 데 유용하게 사용할 수 있다. 역함수를 취하면 단위 범위로 다시 되돌릴 수 있다:</p>
<p><span class="math display">\[
\text{logit}^{-1}(x) = \frac{e^x}{1+e^x}.
\]</span></p>
<p>R에서는 로지스틱 분포를 이용해 이와 같은 로지스틱 함수를 확인할 수 있다.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="logistic-regression.html#cb294-1" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">&lt;-</span> qlogis</span>
<span id="cb294-2"><a href="logistic-regression.html#cb294-2" aria-hidden="true" tabindex="-1"></a>invlogit <span class="ot">&lt;-</span> plogis</span></code></pre></div>
<p>이항변수를 모델링하는 데 있어 로지스틱 변환의 용법에 대해 살펴보자.</p>
<div id="example-modeling-political-preference-given-income" class="section level3" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Example: modeling political preference given income</h3>
<p>전통적으로 보수적인 정당들은 고소득 유권자들로부터 더 많은 지지를 받아왔다. 1992년 NES로부터 이 패턴을 분석해보기 위해 전통적인 로지스틱 회귀모델을 사용해보자.</p>
<ul>
<li><p>NES 설문조사에서 각 응답자 <span class="math inline">\(i\)</span>에 대해, 응답자가 조지 부시를 선호할 경우에는 <span class="math inline">\(y_i=1\)</span>, 응답자가 빌 클린턴을 선호할 경우에는 <span class="math inline">\(y_i = 0\)</span>으로 코딩하며 다른 후보자에 대한 선호나 의견은 제외하였다.</p></li>
<li><p>예측변수는 응답자의 소득 수준으로 5점 척도로 측정되었다.</p></li>
</ul>
<pre><code>## Error in select(dat, Coast, Income = Per.capita.income): unused arguments (Coast, Income = Per.capita.income)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-481"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-481-1.png" alt="(a) Inverse logit function $\text{logit}^{&lt;U+2212&gt;1}(x)$ from (13.1): the transformation from linear predictors to probabilities that is used in logistic regression. (b) An example of the predicted probabilities from a logistic regression model: $y = \text{logit}^{&lt;U+2212&gt;1}(&lt;U+2212&gt;1.40 + 0.33x)$. The shape of the curve is the same, but its location and scale have changed; compare the x-axes on the two graphs. On each graph, the vertical dotted line shows where the predicted probability is 0.5: in graph (a), this is at $\text{logit}(0.5) = 0$; in graph (b), the halfway point is where $&lt;U+2212&gt;1.40 + 0.33x = 0$, which is $x = 1.40/0.33 = 4.2$. As discussed in Section 13.2, the slope of the curve at the halfway point is the logistic regression coefficient divided by 4, thus 1/4 for $y = \text{logit}^{&lt;U+2212&gt;1}(x)$ and $0.33/4$ for $y = \text{logit}^{&lt;U+2212&gt;1}(&lt;U+2212&gt;1.40 + 0.33x)$. The slope of the logistic regression curve is steepest at this halfway point." width="864" />
<p class="caption">
Figure 13.1: (a) Inverse logit function <span class="math inline">\(\text{logit}^{&lt;U+2212&gt;1}(x)\)</span> from (13.1): the transformation from linear predictors to probabilities that is used in logistic regression. (b) An example of the predicted probabilities from a logistic regression model: <span class="math inline">\(y = \text{logit}^{&lt;U+2212&gt;1}(&lt;U+2212&gt;1.40 + 0.33x)\)</span>. The shape of the curve is the same, but its location and scale have changed; compare the x-axes on the two graphs. On each graph, the vertical dotted line shows where the predicted probability is 0.5: in graph (a), this is at <span class="math inline">\(\text{logit}(0.5) = 0\)</span>; in graph (b), the halfway point is where <span class="math inline">\(&lt;U+2212&gt;1.40 + 0.33x = 0\)</span>, which is <span class="math inline">\(x = 1.40/0.33 = 4.2\)</span>. As discussed in Section 13.2, the slope of the curve at the halfway point is the logistic regression coefficient divided by 4, thus 1/4 for <span class="math inline">\(y = \text{logit}^{&lt;U+2212&gt;1}(x)\)</span> and <span class="math inline">\(0.33/4\)</span> for <span class="math inline">\(y = \text{logit}^{&lt;U+2212&gt;1}(&lt;U+2212&gt;1.40 + 0.33x)\)</span>. The slope of the logistic regression curve is steepest at this halfway point.
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-482"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-482-1.png" alt="Logistic regression estimating the probability of supporting George Bush in the 1992 presidential election, as a function of discretized income level. Survey data are indicated by jittered dots. In this example, little is revealed by these jittered points, but we want to emphasize here that the data and fitted model can be put on a common scale. (a) Fitted logistic regression: the thick line indicates the curve in the range of the data; the thinner lines at the ends show how the logistic curve approaches 0 and 1 in the limits. (b) In the range of the data, the solid line shows the best-fit logistic regression, and the light lines show uncertainty in the fit." width="864" />
<p class="caption">
Figure 13.2: Logistic regression estimating the probability of supporting George Bush in the 1992 presidential election, as a function of discretized income level. Survey data are indicated by jittered dots. In this example, little is revealed by these jittered points, but we want to emphasize here that the data and fitted model can be put on a common scale. (a) Fitted logistic regression: the thick line indicates the curve in the range of the data; the thinner lines at the ends show how the logistic curve approaches 0 and 1 in the limits. (b) In the range of the data, the solid line shows the best-fit logistic regression, and the light lines show uncertainty in the fit.
</p>
</div>
<p>Figure 13.2는 데이터와 적합된 로지스틱 회귀선을 보여준다. 이 회귀곡선은 0과 1 사이로 그 범위가 제약되어 있다. 우리는 이 회귀선을 주어진 <span class="math inline">\(x\)</span>에서의 <span class="math inline">\(y=1\)</span>일 확률, <span class="math inline">\(\Pr(y = 1|x)\)</span>라고 해석할 수 있다.</p>
</div>
<div id="the-logistic-regression-model" class="section level3" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> The logistic regression model</h3>
<p>선형회귀모델, <span class="math inline">\(X\beta + \text{error}\)</span>에 0과 1의 값을 갖는 데이터 <span class="math inline">\(y\)</span>를 적합할 때, 문제가 있을 수 있다. 이 모델의 계수값은 확률 차이로 해석될 수 있지만, 예측을 위한 모델에 사용하기에는 어려움이 있고, 연속형인 것처럼 이산형 결과변수를 모델링할 경우 정보를 소실하게 될 수도 있다.</p>
<p>대신, 결과변수 <span class="math inline">\(y_i\)</span>가 독립적이라는 가정 하에서 우리는 <span class="math inline">\(y=1\)</span>일 확률을 다음과 같이 모델링한다:</p>
<p><span class="math display">\[
\Pr(y_i = 1) = \text{logit}^{-1}(X_i\beta)
\]</span></p>
<p>이때, <span class="math inline">\(X\beta\)</span>는 선형 예측변수를 의미한다. 위의 수식은 다음과 같이 바꾸어 쓸 수 있다:</p>
<p><span class="math display">\[
\begin{aligned}
\Pr(y_i = 1)&amp;= p_i\\
\text{logit}(p_i)&amp;= X_i\beta
\end{aligned}
\]</span>
<span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020, 219</a>)</span>는 로짓의 역함수인 <span class="math inline">\(\text{logit}^{-1}\)</span>로 분석하는 것을 선호한다고 밝히고 있다. 왜냐하면 이 경우 선형 예측변수들을 확률적 개념으로 해석하는 데 조금 더 자유로워지기 때문이다.</p>
<p>로지스틱의 역함수는 곡선의 형태를 취하기 때문에, 고정된 <span class="math inline">\(x\)</span>의 값의 차이에 따른 <span class="math inline">\(y\)</span>의 기대값 변화는 일정하지 않다. 즉, <span class="math inline">\(x\)</span>가 1에서 2로 변할 때의 <span class="math inline">\(y\)</span>의 기대값 결과와 <span class="math inline">\(x\)</span>가 2에서 3으로 변할 때의 <span class="math inline">\(y\)</span>의 기대값의 차이는 동일하지 않다는 것이다.</p>
<ul>
<li><p><span class="math inline">\(\text{logit}(0.5) = 0\)</span>이고 <span class="math inline">\(\text{logit}(0.6) = 0.4\)</span>이다. 여기서 0.4의 로짓 척도는 약 확률적으로 50%에서 60%의 변화를 의미한다.</p></li>
<li><p><span class="math inline">\(\text{logit}(0.9) = 2.2\)</span>이고 <span class="math inline">\(\text{logit}(0.93) = 2.6\)</span>이다. 여기서 0.4의 로짓 척도는 약 확률적으로 90%에서 93%의 변화를 의미한다.</p></li>
</ul>
<p>일반적으로 로짓 척도의 특정한 변화는 결과적으로는 확률 척도로 변환가능하며, 0과 1 사이에 놓이게 되지만 그 구간의 변화는 일정하지 않다.</p>
</div>
<div id="fitting-the-model-using-stan_glm-and-displaying-uncertainty-in-the-fitted-model" class="section level3" number="13.1.3">
<h3><span class="header-section-number">13.1.3</span> Fitting the model using stan_glm and displaying uncertainty in the fitted model</h3>
<p><span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020, 219</a>)</span>는 예측 불확실성을 보여주기 위해서 <code>stan_glm</code>을 이용해서 시뮬레이션을 하지만, 이 리딩노트에서는 기존의 <code>glm</code>으로 추정한 계수 결과를 <code>mvtnorm</code> 패키지의 <code>rmvnorm</code>을 이용해 시뮬레이션하는 접근법을 취하고자 한다. 결과는 <code>stan_glm</code>과 다르지 않다. 계수값의 불확실성을 모수적 시뮬레이션을 이용해 무작위 추출한 표집분포로 보여주는 것이다.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="logistic-regression.html#cb296-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(rvote <span class="sc">~</span> income, </span>
<span id="cb296-2"><a href="logistic-regression.html#cb296-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>), <span class="at">data =</span> nes_1992)</span>
<span id="cb296-3"><a href="logistic-regression.html#cb296-3" aria-hidden="true" tabindex="-1"></a>sims_1 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">20</span>, <span class="at">mu =</span> <span class="fu">coef</span>(fit_1), <span class="at">Sigma =</span> <span class="fu">vcov</span>(fit_1))</span>
<span id="cb296-4"><a href="logistic-regression.html#cb296-4" aria-hidden="true" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sims_1)</span>
<span id="cb296-5"><a href="logistic-regression.html#cb296-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">sample</span>(n_sims, <span class="dv">20</span>)){</span>
<span id="cb296-6"><a href="logistic-regression.html#cb296-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">invlogit</span>(sims_1[j,<span class="dv">1</span>] <span class="sc">+</span> sims_1[j,<span class="dv">2</span>]<span class="sc">*</span>x), <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">lwd=</span><span class="fl">0.5</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb296-7"><a href="logistic-regression.html#cb296-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error in plot.xy(xy.coords(x, y), type = type, ...): plot.new has not been called yet</code></pre>
</div>
</div>
<div id="interpreting-logistic-regression-coefficients-and-the-divide-by-4-rule" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Interpreting logistic regression coefficients and the divide-by-4 rule</h2>
<p>로지스틱 회귀모델의 계수는 비선형성으로 인해 해석이 까다로울 수 있다. 따라서 계수를 이해하기 편하도록 일반화하는 과정이 필요하다.</p>
<div id="evaluation-at-and-near-the-mean-of-the-data" class="section level3" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Evaluation at and near the mean of the data</h3>
<p>로지스틱 함수의 비선형성은 확률 척도로 해석하고자 할 때, 어느 지점의 변화를 살펴볼 것인지를 결정해야 한다. 기본적으로는 예측변수들의 평균을 이용하는 것이 유용하다.</p>
<ul>
<li><p>선형회귀모델처럼, 절편은 다른 모든 예측변수들이 0일 경우를 가정한 값으로 해석할 수 있다.</p></li>
<li><p>예를 들어, 아래의 코드는 응답자의 소득 수준이 평균이며, 다른 모든 예측변수들이 0일 경우에 부시를 지지할 확률을 보여준다고 할 수 있다.</p></li>
</ul>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="logistic-regression.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invlogit</span>(<span class="fu">coef</span>(fit_1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(fit_1)[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">mean</span>(nes_1992<span class="sc">$</span>income))</span></code></pre></div>
<pre><code>## (Intercept) 
##   0.3433863</code></pre>
<ul>
<li><p><code>invlogit = plogis</code> <span class="citation">(<a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>: 217)</span>.</p></li>
<li><p>평균 소득 수준(<span class="math inline">\(\bar x\)</span>)이 3.1이라고 할 때, 이 3.1에서 한 단위 증가에 따른 확률을 변화를 살펴볼 수 있다.</p>
<ul>
<li><p><span class="math inline">\(x = 3\)</span>일 때와 <span class="math inline">\(x = 2\)</span>일 때, <span class="math inline">\(\Pr(y = 1)\)</span>일 확률의 변화를 살펴보는 것</p></li>
<li><p><span class="math inline">\(\text{logit}^{-1}(-14.0+0.33\times 3)-\text{logit}^{-1}(-14.0+0.33\times 2) = 0.08\)</span>.</p></li>
</ul></li>
</ul>
</div>
<div id="the-divide-by-4-rule" class="section level3" number="13.2.2">
<h3><span class="header-section-number">13.2.2</span> The divide-by-4 rule</h3>
<p>로지스틱 곡선은 <span class="math inline">\(\alpha + \beta x = 0\)</span>이기 때문에 <span class="math inline">\(\text{logit}^{-1}(\alpha + \beta x) = 0.5\)</span>인 중앙을 기점으로 그 기울기가 가팔라진다. 곡선의 기울기, 로지스틱 함수에 도함수를 취한 값은 그 중앙에서 최대값을 갖는다: <span class="math inline">\(\beta e ^0/(1+e^0)62 = \beta/4\)</span>. 따라서 <span class="math inline">\(\beta/4\)</span>는 <span class="math inline">\(x\)</span>의 단위 차이에 따른 <span class="math inline">\(\Pr(y = 1)\)</span>의 차이가 가장 큰 값이라고 할 수 있다.</p>
<p>따라서, 우리는 로지스틱 회귀계수(상수항을 제외한)의 값을 4로 나누어줌으로써, <span class="math inline">\(x\)</span>의 한 단위 차이에 따른 예측 차이의 상한 경계값(upper bound)을 구할 수 있다. 상한 경계값은 로지스틱 곡선의 대략 중간에 위치한 값을 보여주며, 확률적으로는 0.5에 해당하는 지점이라고 할 수 있다.</p>
</div>
<div id="interpretation-of-coefficients-as-odds-ratios" class="section level3" number="13.2.3">
<h3><span class="header-section-number">13.2.3</span> Interpretation of coefficients as odds ratios</h3>
<p>로지스틱 회귀계수를 해석하는 또 다른 방법으로는 오즈비(odds ratio)를 통한 접근법이 있다. 만약 결과가 두 가지 확률을 갖는다면(<span class="math inline">\(p, 1-p\)</span>), <span class="math inline">\(\frac{p}{1-p}\)</span>를 우리는 승산, 오즈(odds)라고 한다. 오즈가 1이라는 얘기는 확률이 0.5라는 것, 결과가 동등하게 양분되어 나타났다는 것을 의미한다. 오즈가 0.5나 2.0일 경우는 <span class="math inline">\(\frac{1}{3}, \frac{2}{3}\)</span>을 의미한다. 이 두 오즈 간의 비율을 구하면, <span class="math inline">\(\frac{p_1}{1-p_1}/\frac{p_2}{1-p_2}\)</span> 우리는 오즈비를 얻게 된다. 즉, 오즈비가 2라는 것은 <span class="math inline">\(p=0.33\)</span>에서 <span class="math inline">\(p=0.5\)</span>의 변화, 혹은 <span class="math inline">\(p=0.5\)</span>에서 <span class="math inline">\(0.67\)</span>로의 변화를 보여주는 것이라고 할 수 있다.</p>
<ul>
<li><p>확률 대신에 오즈비로 분석할 경우의 이점은, 0와 1로 제약하지 않고 오즈비 척도로 계수를 비교할 수 있다는 것에 있다.</p></li>
<li><p>로지스틱 회귀계수의 로그값을 풀어내면 오즈비로 해석할 수 있다. 하나의 변수를 가진 모델을 대상으로 할 때, 다음과 같은 공식이 성립한다:</p></li>
</ul>
<p><span class="math display">\[
\log\Bigg(\frac{\Pr(y= 1|x)}{\Pr(y = 0|x)} \Bigg) = \alpha + \beta x.
\]</span></p>
<ul>
<li><p><span class="math inline">\(x\)</span>를 한 단위 추가할 경우, 우리는 <span class="math inline">\(\beta\)</span>만큼이 양 변에 추가되는 결과를 확인할 수 있다.</p>
<ul>
<li>만약 양 변에 로그를 푼다면, 오즈 값에 <span class="math inline">\(e^\beta\)</span>를 곱하ㄴ결과가 된다.</li>
</ul></li>
</ul>
</div>
<div id="coefficient-estimates-and-standard-errors" class="section level3" number="13.2.4">
<h3><span class="header-section-number">13.2.4</span> Coefficient estimates and standard errors</h3>
<p>전통적인 로지스틱 회귀분석의 계수는 최대가능도를 사용해 주청되며, 그 표준오차는 추정량의 불확실성을 나타낸다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-485"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-485-1.png" alt="Distribution representing uncertainty in an estimated regression coefficient (repeated from Figure 4.1). The range of this distribution corresponds to the possible values of $\beta$ that are consistent with the data. When using this as an uncertainty distribution, we assign an approximate 68% chance that $\beta$ will lie within 1 standard error of the point estimate, $\hat \beta$, and an approximate 95% chance that β will lie within 2 standard errors. Assuming the regression model is correct, it should happen only about 5% of the time that the estimate, $\hat \beta$, falls more than 2 standard errors away from the true $\beta$." width="672" />
<p class="caption">
Figure 13.3: Distribution representing uncertainty in an estimated regression coefficient (repeated from Figure 4.1). The range of this distribution corresponds to the possible values of <span class="math inline">\(\beta\)</span> that are consistent with the data. When using this as an uncertainty distribution, we assign an approximate 68% chance that <span class="math inline">\(\beta\)</span> will lie within 1 standard error of the point estimate, <span class="math inline">\(\hat \beta\)</span>, and an approximate 95% chance that β will lie within 2 standard errors. Assuming the regression model is correct, it should happen only about 5% of the time that the estimate, <span class="math inline">\(\hat \beta\)</span>, falls more than 2 standard errors away from the true <span class="math inline">\(\beta\)</span>.
</p>
</div>
</div>
<div id="statistical-significance-1" class="section level3" number="13.2.5">
<h3><span class="header-section-number">13.2.5</span> Statistical significance</h3>
<p>선형회귀모델과 마찬가지로 추정량은 통상 0으로부터 최소 2 표준오차만큼 떨어져 있을 경우에는 95% 신뢰구간이 0을 포함하지 않기 때문에 통계적으로 유의미하다고 칭해진다.</p>
<ul>
<li><p>하지만 <span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020, 222</a>)</span>는 통계적 유의성이라는 것에 집착하지 않을 것을 권한다.</p></li>
<li><p>추정량이 통계적으로 유의하지 않더라도 여전히 모집단 수준에서는 어떠한 효과 혹은 관계를 가지고 있을 수 있기 때문이다.</p></li>
</ul>
</div>
<div id="displaying-the-results-of-several-logistic-regressions" class="section level3" number="13.2.6">
<h3><span class="header-section-number">13.2.6</span> Displaying the results of several logistic regressions</h3>
<p>아래의 그래프는 1952년부터 2000년까지의 사전 설문조사로 집계한 대통령 후보자 선호에 대한 소득의 계수 추정량에 대한 <span class="math inline">\(\pm\)</span> 1 표준오차를 보여준다. 소득 수준이 높은 응답자일수록 공화당 후보를 지지할 가능성을 일관되게 높은 것을 확인할 수 있다. 그러나 그 관계는 시간이 흐를 수록 더욱 강해지는 것 또한 확인할 수 있다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-486"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-486-1.png" alt="Coefficient of income (on a 1&lt;U+2013&gt;5 scale) with $\pm 1$ standard-error bounds in logistic regressions predicting Republican preference for president, as estimated separately from surveys in the second half of the twentieth century. The pattern of richer voters supporting Republicans has increased since 1970. The data used in the estimate for 1992 appear in Figure 13.2." width="768" />
<p class="caption">
Figure 13.4: Coefficient of income (on a 1&lt;U+2013&gt;5 scale) with <span class="math inline">\(\pm 1\)</span> standard-error bounds in logistic regressions predicting Republican preference for president, as estimated separately from surveys in the second half of the twentieth century. The pattern of richer voters supporting Republicans has increased since 1970. The data used in the estimate for 1992 appear in Figure 13.2.
</p>
</div>
</div>
</div>
<div id="predictions-and-comparisons" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Predictions and comparisons</h2>
<p>로지스틱 회귀모델의 예측은 확률적이다. 따라서 관측되지 않은 미래의 데이터 관측치 <span class="math inline">\(y^{new}_i\)</span>에 대해 우리는 점예측치보다 예측확률을 구하게 된다.</p>
<p><span class="math display">\[
p^{new}_i = \Pr(y^{new}_i = 1) = \text{logit}^{-1}(X^{new}_i\beta),
\]</span></p>
<div id="point-prediction-using-predict-1" class="section level3" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> Point prediction using <code>predict</code></h3>
<p>소득 수준이 5점 척도 중에서 5점인 사람들의 투표 선호도를 예측하고자 한다고 할 때, 우리는 <code>predict</code> 함수를 이용하여 추정된 확률을 컴퓨팅할 수 있다.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="logistic-regression.html#cb300-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> <span class="dv">5</span>)</span>
<span id="cb300-2"><a href="logistic-regression.html#cb300-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">newdata =</span> new)</span>
<span id="cb300-3"><a href="logistic-regression.html#cb300-3" aria-hidden="true" tabindex="-1"></a>pred</span></code></pre></div>
<pre><code>##         1 
## 0.4703885</code></pre>
<p><code>predict</code> 함수에서 <code>type="response</code>를 설정하면 확률 척도로 예측값을 구할 수 있다. 만약 <code>type="link"</code>로 설정할 경우에는 로짓 척도로 선형확률을 구할 수 있다.</p>
<p><code>invlogit(predict(fit_1, type="link", newdata=new))=new)</code>는 <code>predict(fit_1, type="response", newdata=new)</code>와 같은 결과를 산출한다.</p>
</div>
<div id="linear-predictor-with-uncertainty-using-posterior_linpred" class="section level3" number="13.3.2">
<h3><span class="header-section-number">13.3.2</span> Linear predictor with uncertainty using <code>posterior_linpred</code></h3>
<p>선형회귀모델 결과에 <code>posterior_linpred</code> 함수를 사용하면 선형예측값, <span class="math inline">\(X^{new}\beta\)</span>의 시뮬레이션된 값을 계산할 수 있다. 하지만 여기에서는 <code>mvrnorm</code>을 사용한다.</p>
<p>이 결과는 <span class="math inline">\(a + b\times 5\)</span>에 대해 시뮬레이션된 사후분포를 보여준다. 하지만 우리는 이 값을 직접적으로 사용하기보다는 확률 척도로 변환한 예측값을 사용한다.</p>
</div>
<div id="expected-outcome-with-uncertainty-using-posterior_epred" class="section level3" number="13.3.3">
<h3><span class="header-section-number">13.3.3</span> Expected outcome with uncertainty using <code>posterior_epred</code></h3>
<p><span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020, 223</a>)</span>에서는 <code>posterior_epred</code> 함수를 사용할 것을 권하고 있지만, 이 리딩노트에서는 <code>mvrnorm</code>로 얻은 결과의 로그를 풀어주는, <code>exp()</code>로 동일한 결과를 얻고자 한다.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="logistic-regression.html#cb302-1" aria-hidden="true" tabindex="-1"></a>epred <span class="ot">&lt;-</span> <span class="fu">exp</span>(linpred_out)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(linpred_out))</span>
<span id="cb302-2"><a href="logistic-regression.html#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(epred), <span class="fu">sd</span>(epred)))</span></code></pre></div>
<pre><code>## [1] 0.46986695 0.02848966</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="logistic-regression.html#cb304-1" aria-hidden="true" tabindex="-1"></a>pred</span></code></pre></div>
<pre><code>##         1 
## 0.4703885</code></pre>
<p><code>prediction</code> 함수로 구한 <code>pred=0.470</code>과 시뮬레이션으로 구한 결과, <code>mean(epred)=0.469</code>가 거의 일치하는 것을 확인할 수 있다.</p>
</div>
<div id="predictive-distribution-for-a-new-observation-using-posterior_predict-1" class="section level3" number="13.3.4">
<h3><span class="header-section-number">13.3.4</span> Predictive distribution for a new observation using <code>posterior_predict</code></h3>
<p><code>posterior_predict</code> 함수를 이용하면 소득 수준이 5일 경우에 나타날 수 있는 개별 유권자의 투표 선택과 그 불확실성을 보여주는 사후분포를 구할 수 있다.</p>
</div>
<div id="prediction-given-a-range-of-input-values-1" class="section level3" number="13.3.5">
<h3><span class="header-section-number">13.3.5</span> Prediction given a range of input values</h3>
<p>앞서는 소득 수준이 5일 때의 예측값을 구했지만, 새로운 관측치의 벡터에 대한 예측값 역시 구하는 것이 가능하다.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="logistic-regression.html#cb306-1" aria-hidden="true" tabindex="-1"></a>new_five <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb306-2"><a href="logistic-regression.html#cb306-2" aria-hidden="true" tabindex="-1"></a>pred_five <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_1, <span class="at">type=</span><span class="st">&quot;response&quot;</span>, <span class="at">newdata=</span>new)</span>
<span id="cb306-3"><a href="logistic-regression.html#cb306-3" aria-hidden="true" tabindex="-1"></a>linpred_fiveout <span class="ot">&lt;-</span> linpred <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">cbind</span>(<span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)))</span>
<span id="cb306-4"><a href="logistic-regression.html#cb306-4" aria-hidden="true" tabindex="-1"></a>epred_five <span class="ot">&lt;-</span> <span class="fu">exp</span>(linpred_fiveout)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(linpred_fiveout))</span>
<span id="cb306-5"><a href="logistic-regression.html#cb306-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(epred_five, <span class="dv">2</span>, mean);<span class="fu">apply</span>(epred_five, <span class="dv">2</span>, sd)</span></code></pre></div>
<pre><code>## [1] 0.2352525 0.2856796 0.3425540 0.4046141 0.4698670</code></pre>
<pre><code>## [1] 0.02449276 0.01810651 0.01301085 0.01716431 0.02848966</code></pre>
<p>각 소득 수준에 따른 예측확률을 구할 수 있다.</p>
</div>
<div id="logistic-regression-with-just-an-intercept" class="section level3" number="13.3.6">
<h3><span class="header-section-number">13.3.6</span> Logistic regression with just an intercept</h3>
<p>절편만 가지고 선형회귀모델을 돌릴 경우에는 평균을오 추정하는 것과 같다. 만약 단 하나의 이항 예측변수를 가지고 선형회귀모델을 분석하면 그 결과는 각 이항 값에 따른 평균의 차이를 추정하는 것과 같다. 마찬가지로 절편만 가지고 로지스틱 회귀모델을 분석할 경우는 비율에 대한 추정과 같다.</p>
<p>50명의 피험자들에 대한 무작위 표본이 있고, 이중 10명이 특정 질병에 걸렸다고 하자. 이때, 질병에 걸릴 확률은 0.2라고 할 수 있고 표준오차는 <span class="math inline">\(\sqrt{0.2\times 0.8/50}=0.06\)</span>이 된다. 따라서 이 로지스틱 회귀모델을 다음과 같이 수립할 수 있다.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="logistic-regression.html#cb309-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">10</span>))</span>
<span id="cb309-2"><a href="logistic-regression.html#cb309-2" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y)</span>
<span id="cb309-3"><a href="logistic-regression.html#cb309-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data=</span>simple)</span>
<span id="cb309-4"><a href="logistic-regression.html#cb309-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ 1, family = binomial(link = &quot;logit&quot;), data = simple)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.6681  -0.6681  -0.6681  -0.6681   1.7941  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -1.3863     0.3536  -3.921 8.82e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 50.04  on 49  degrees of freedom
## Residual deviance: 50.04  on 49  degrees of freedom
## AIC: 52.04
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>이때, 우리는 예측값을 확률 척도로 바꿀 수 있다: <span class="math inline">\(\text{logit}^{-1}(-1.38) = 0.20\)</span>. 마찬가지로 표준오차를 이용해서 신뢰구간-불확실성도 추정할 수 있다: <span class="math inline">\(\text{logit}^{-1}(-1.38\pm 0.35) = (0.15, 0.26)\)</span>.</p>
<div id="data-on-the-boundary" class="section level4" number="13.3.6.1">
<h4><span class="header-section-number">13.3.6.1</span> Data on the boundary</h4>
<p><span class="math inline">\(y=0\)</span>이거나 <span class="math inline">\(y=n\)</span>일 경우는 어떻게 될까? <span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020, 52</a>)</span>에서 논의한 바와 같이 전통적인 표준오차 공식에 따르면 극단적인 경우 0이 산출된다. 따라서 우리는 대신 <span class="math inline">\(\hat p = (y+2)/(n+4)\)</span>일 때, 95% 신뢰구간, <span class="math inline">\(\hat p \pm \sqrt{\hat p(1-\hat p)/(n +4)}\)</span>을 구할 수 있다. 다음의 예제를 보자.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="logistic-regression.html#cb311-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">0</span>))</span>
<span id="cb311-2"><a href="logistic-regression.html#cb311-2" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y)</span>
<span id="cb311-3"><a href="logistic-regression.html#cb311-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data=</span>simple)</span>
<span id="cb311-4"><a href="logistic-regression.html#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ 1, family = binomial(link = &quot;logit&quot;), data = simple)
## 
## Deviance Residuals: 
##        Min          1Q      Median          3Q         Max  
## -2.409e-06  -2.409e-06  -2.409e-06  -2.409e-06  -2.409e-06  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)   -26.57   50363.54  -0.001        1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 0.0000e+00  on 49  degrees of freedom
## Residual deviance: 2.9008e-10  on 49  degrees of freedom
## AIC: 2
## 
## Number of Fisher Scoring iterations: 25</code></pre>
<p>전통적인 방식으로 표준오차를 계산하게 되면 터무니없는 결과가 나오게 된다. 그렇다면 시뮬레이션을 이용하면 어떻게 될까?</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="logistic-regression.html#cb313-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), </span>
<span id="cb313-2"><a href="logistic-regression.html#cb313-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>simple, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb313-3"><a href="logistic-regression.html#cb313-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       binomial [logit]
##  formula:      y ~ 1
##  observations: 50
##  predictors:   1
## ------
##             Median MAD_SD
## (Intercept) -4.6    1.2  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>이 경우 대략적인 95% 신뢰구간은 <span class="math inline">\(\text{logit}^{-1}(-4.58\pm2\times1.14)=(0,0.09)\)</span>이 된다. 기존의 공식을 이용한 표준오차로는 구할 수 없었던 극단적인 관측치에서의 결과를 구할 수 있게 되는 것이다.</p>
</div>
</div>
<div id="logistic-regression-with-a-single-binary-predictor" class="section level3" number="13.3.7">
<h3><span class="header-section-number">13.3.7</span> Logistic regression with a single binary predictor</h3>
<p>하나의 더미변수를 갖는 로지스틱 회귀모델의 경우 비율을 비교하는 것과 같다. 예를 들면 모집단 A의 50명 중에서 양성이 10명일 확률인 표본의 비율과 모집단 B의 60명 중에서 20명이 양성일 확률인 표본의 비율을 비교하는 것이다.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="logistic-regression.html#cb315-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">60</span>))</span>
<span id="cb315-2"><a href="logistic-regression.html#cb315-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">20</span>))</span>
<span id="cb315-3"><a href="logistic-regression.html#cb315-3" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span>
<span id="cb315-4"><a href="logistic-regression.html#cb315-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data=</span>simple)</span>
<span id="cb315-5"><a href="logistic-regression.html#cb315-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ x, family = binomial(link = &quot;logit&quot;), data = simple)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.9005  -0.9005  -0.6681   1.4823   1.7941  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -1.3863     0.3536  -3.921 8.82e-05 ***
## x             0.6931     0.4472   1.550    0.121    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 128.91  on 109  degrees of freedom
## Residual deviance: 126.42  on 108  degrees of freedom
## AIC: 130.42
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>비율 차이에 대한 추론을 도출하려면 더미의 값, 0과 1에 대한 확률 척도의 예측값을 비교해보면 된다.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="logistic-regression.html#cb317-1" aria-hidden="true" tabindex="-1"></a>sim_coef <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">1000</span>, <span class="at">mu =</span> <span class="fu">coef</span>(fit), <span class="at">Sigma =</span> <span class="fu">vcov</span>(fit))</span>
<span id="cb317-2"><a href="logistic-regression.html#cb317-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> sim_coef <span class="sc">%*%</span> <span class="fu">cbind</span>(<span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb317-3"><a href="logistic-regression.html#cb317-3" aria-hidden="true" tabindex="-1"></a>epred <span class="ot">&lt;-</span> <span class="fu">exp</span>(pred)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(pred))</span>
<span id="cb317-4"><a href="logistic-regression.html#cb317-4" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">&lt;-</span> epred[,<span class="dv">2</span>] <span class="sc">-</span> epred[,<span class="dv">1</span>]</span>
<span id="cb317-5"><a href="logistic-regression.html#cb317-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(diff);<span class="fu">sd</span>(diff)</span></code></pre></div>
<pre><code>## [1] 0.3234994</code></pre>
<pre><code>## [1] 0.07591516</code></pre>
</div>
</div>
<div id="latent-data-formulation" class="section level2" number="13.4">
<h2><span class="header-section-number">13.4</span> Latent-data formulation</h2>
<p>로지스틱 회귀모델 결과는 관측되지 않은, 또는 잠재적(<em>latent</em>) 변수를 사용해서 직/간접적으로 해석할 수 있다.</p>
<p><span class="math display">\[
y_{i} =
  \begin{cases}
    1 &amp; \text{if }z_i&gt;0\\
    0 &amp; \text{if }z_i&lt;0
  \end{cases}
z_i= X_i\beta + \epsilon_i
\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-496"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-496-1.png" alt="The probability density function of the logistic distribution, which is used for the error term in the latent-data formulation (13.5) of logistic regression. The logistic curve in Figure 13.1a is the cumulative distribution function of this density. The maximum of the density is 0.25, which corresponds to the maximum slope of 0.25 in the inverse logit function of Figure 13.1a." width="768" />
<p class="caption">
Figure 13.5: The probability density function of the logistic distribution, which is used for the error term in the latent-data formulation (13.5) of logistic regression. The logistic curve in Figure 13.1a is the cumulative distribution function of this density. The maximum of the density is 0.25, which corresponds to the maximum slope of 0.25 in the inverse logit function of Figure 13.1a.
</p>
</div>
<p>독립적인 오차 <span class="math inline">\(\epsilon_i\)</span>이 로지스틱 확률분포를 가진다고 할 때, 위의 그래프는 다음과 같이 정의될 수 있다:</p>
<p><span class="math display">\[
\Pr(\epsilon_i&lt;x)=\text{logit}^{-1}(x)\text{ for all }x.
\]</span></p>
<p>따라서 <span class="math inline">\(\Pr(y_i = 1) = \Pr(z_i &gt; 0) = \Pr(\epsilon_i &gt; -X_i\beta) = \text{logit}^{-1}(X_i\beta)\)</span>라고 할 수 있다.</p>
<p>다음의 그래프는 소득 수준, <span class="math inline">\(x_i = 1\)</span>인 관측치 <span class="math inline">\(i\)</span>의 선형예측값, <span class="math inline">\(X_i\beta\)</span>를 설명하고 있다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-497"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-497-1.png" alt="The probability density function of the latent variable $z_i$ in model (13.5) if the linear predictor, $X_i\beta$, has the value &lt;U+2212&gt;1.07. The shaded area indicates the probability that $z_i &gt; 0$, so that $y_i = 1$ in the logistic regression." width="768" />
<p class="caption">
Figure 13.6: The probability density function of the latent variable <span class="math inline">\(z_i\)</span> in model (13.5) if the linear predictor, <span class="math inline">\(X_i\beta\)</span>, has the value &lt;U+2212&gt;1.07. The shaded area indicates the probability that <span class="math inline">\(z_i &gt; 0\)</span>, so that <span class="math inline">\(y_i = 1\)</span> in the logistic regression.
</p>
</div>
<p>그래프의 곡선은 잠재적 변수 <span class="math inline">\(z_i\)</span>의 분포를 보여주며, 음영은 <span class="math inline">\(y_i = 1\)</span>일 때, <span class="math inline">\(z_i &gt; 0\)</span>인 확률을 나타낸다.</p>
<div id="interpretation-of-the-latent-variables" class="section level3" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Interpretation of the latent variables</h3>
<p>잠재변수는 일종의 컴퓨팅된 트릭에 가깝지만 실질적으로 해석될 수 있다. 예를 들어, 사전선거 설문조사에서 부시 지지자들을 <span class="math inline">\(y_i= 1\)</span>이라고 하고 클린턴 지지자들을 <span class="math inline">\(y_i = 0\)</span>이라고 하자. 관측되지 않은 연속형 변수 <span class="math inline">\(z_i\)</span>는 클린턴에 비해 부시에 대한 응답자의 “효용”이나 선호로 해석될 수 있다.: 부호는 어떤 후보를 선호하는지에 대한 효용, 그리고 계수값의 크기는 그 선호의 강도를 보여준다는 것이다.</p>
</div>
<div id="nonidentifiability-of-the-latent-scale-parameter" class="section level3" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Nonidentifiability of the latent scale parameter</h3>
<p>로지스틱 확률 밀도함수는 종 형태로 나타나며, 잠재변수 <span class="math inline">\(z\)</span>에 대한 로지스틱 모델은 정규회귀모델에 거의 근사한다:</p>
<p><span class="math display">\[
z_i = X_i\beta + \epsilon_i,\: \epsilon_i\sim \text{N}(0, \sigma^2)
\]</span></p>
<p>이 부분의 내용은 후에 프로빗 모델에 관련한 부분에서 자세하게 다룰 것이다.</p>
</div>
</div>
<div id="maximum-likelihood-and-bayesian-inference-for-logistic-regression" class="section level2" number="13.5">
<h2><span class="header-section-number">13.5</span> Maximum likelihood and Bayesian inference for logistic regression</h2>
<p>로지스틱 회귀모델에서는 대개 최대가능도, 베이지언 추론, 그리고 다른 정규화 기법의 순으로 추정 방법을 살펴보고는 한다.</p>
<div id="maximum-likelihood-using-iteratively-weighted-least-squares" class="section level3" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> Maximum likelihood using iteratively weighted least squares</h3>
<p><span class="math inline">\(y_i = 0\)</span> 또는 <span class="math inline">\(y_i = 1\)</span>인 이항로지스틱 회귀모델의 경우 가능도는 다음과 같이 나타난다.</p>
<p><span class="math display">\[
p(y|\beta, X) = \prod^n_{i=1}
 \begin{cases}
    \text{logit}^{-1}(X_i\beta) &amp; \text{if }y_i = 1\\
    1-\text{logit}^{-1}(X_i\beta) &amp; \text{if }y_i = 0
  \end{cases}
\]</span></p>
<p>위의 가능도는 다음과 같이 바꾸어 쓸 수 있다.</p>
<p><span class="math display">\[
p(y|\beta, X) = \prod^n_{i=1}\Big(\text{logit}^{-1}(X_i\beta)\Big)^{y_i}\Big(1-\text{logit}^{-1}(X_i\beta)\Big)^{1-y_i}
\]</span></p>
<p>가능도를 최대화하는 <span class="math inline">\(\beta\)</span>를 찾기 위해서 가능도에 대한 도함수 <span class="math inline">\(dp(y|\beta,X)/d\beta\)</span>를 컴퓨팅해, 이 도함수가 0이 되는 지점의 해(solution)가 <span class="math inline">\(\beta\)</span>라는 것을 알 수 있다. 최대가능도 추정량(MLE)은 반복되는 최적화 알고리즘을 통해서 도함수의 결과가 0이되는 지점에서 찾을 수 있다.</p>
</div>
<div id="bayesian-inference-with-a-uniform-prior-distribution" class="section level3" number="13.5.2">
<h3><span class="header-section-number">13.5.2</span> Bayesian inference with a uniform prior distribution</h3>
<p>모집단 모수(parameters)에 대한 사전분포가 단일한 형태(uniform)를 이룬다면, 사후밀도는 가능도 함수에 비례하며, 사후분포의 최빈값(사후밀도를 최대화하는 <span class="math inline">\(\beta\)</span> 계수의 벡터)은 MLE가 된다.</p>
<p>선형회귀모델에서 비정보 사전분포(noninformative prior)를 가지고 베이지언 추론을 할 경우의 이점은 전체 사후분포로부터 시뮬레이션을 이용하여 불확실성을 요약하여 보여줄 수 있고, 확률적 예측을 할 수 있다는 것에 있다.</p>
</div>
<div id="default-prior-in-stan_glm" class="section level3" number="13.5.3">
<h3><span class="header-section-number">13.5.3</span> Default prior in <code>stan_glm</code></h3>
<p><code>stan_glm</code>은 디폴트 값으로 약한 정보를 가진 사전분포를 사용한다. 이 리딩노트에서는 <code>stan_glm</code>을 사용하지는 않기 때문에 간단하게 각 섹션의 내용을 요약하는 선에서 정리하도록 한다.</p>
</div>
<div id="bayesian-inference-with-some-prior-information" class="section level3" number="13.5.4">
<h3><span class="header-section-number">13.5.4</span> Bayesian inference with some prior information</h3>
<p>사전분포에 대한 정보를 사용가능할 때, 우리는 추정량과 예측값의 정확성을 높일 수 있다. <span class="math inline">\(\Pr(y_i=1) = \text{logit}^{-1}(a + bx)\)</span>인 로지스틱 회귀함수에서 제약이 약한 경우를 가정할 때, <span class="math inline">\(b\)</span>의 값이 0부터 1 사이에 위치한다고 한다고 볼 수 있으며, 우리는 <span class="math inline">\(b\)</span>에 대한 정규 사전분포를 평균 0.5, 표준편차 0.5, 즉 <span class="math inline">\(b\)</span>가 0과 1 사이에 위치할 확률이 68%라고 할 수 볼 수 있다. 그리고 95%에 해당하는 <span class="math inline">\(b\)</span>가 -0.5와 1.5 사이에 위치할 것이라고 기대할 수 있다.</p>
</div>
<div id="comparing-maximum-likelihood-and-bayesian-inference-using-a-simulation-study" class="section level3" number="13.5.5">
<h3><span class="header-section-number">13.5.5</span> Comparing maximum likelihood and Bayesian inference using a simulation study</h3>
<p>사전분포의 역할을 이해하기 위해서 몇 가지 시나리오를 생각해보자. 진짜 모수의 값이 <span class="math inline">\(a = -2\)</span>이고 <span class="math inline">\(b=0.8\)</span>이라고 가정하고 데이터가 -1과 1 사이의 단일분포로부터 추출된 <span class="math inline">\(x\)</span>의 값으로 이루어진 실험으로부터 얻어진 데이터라고 하자.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="logistic-regression.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;arm&quot;</span>, <span class="st">&quot;rstanarm&quot;</span>)</span>
<span id="cb320-2"><a href="logistic-regression.html#cb320-2" aria-hidden="true" tabindex="-1"></a>bayes_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">a=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">b=</span><span class="fl">0.8</span>){</span>
<span id="cb320-3"><a href="logistic-regression.html#cb320-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb320-4"><a href="logistic-regression.html#cb320-4" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rlogis</span>(n, a <span class="sc">+</span> b<span class="sc">*</span>x, <span class="dv">1</span>)</span>
<span id="cb320-5"><a href="logistic-regression.html#cb320-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(z<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb320-6"><a href="logistic-regression.html#cb320-6" aria-hidden="true" tabindex="-1"></a>  fake <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y, z)</span>
<span id="cb320-7"><a href="logistic-regression.html#cb320-7" aria-hidden="true" tabindex="-1"></a>  glm_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data=</span>fake)</span>
<span id="cb320-8"><a href="logistic-regression.html#cb320-8" aria-hidden="true" tabindex="-1"></a>  stan_glm_fit <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(y <span class="sc">~</span> x, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data=</span>fake,</span>
<span id="cb320-9"><a href="logistic-regression.html#cb320-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prior=</span><span class="fu">normal</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb320-10"><a href="logistic-regression.html#cb320-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>(glm_fit, <span class="at">digits=</span><span class="dv">1</span>)</span>
<span id="cb320-11"><a href="logistic-regression.html#cb320-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(stan_glm_fit, <span class="at">digits=</span><span class="dv">1</span>)</span>
<span id="cb320-12"><a href="logistic-regression.html#cb320-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>표본규모를 이용해 시뮬레이션을 하고 <span class="math inline">\(b\)</span>에 대한 추론에 집중해보자:</p>
<ul>
<li><p><span class="math inline">\(n=0\)</span>. 전혀 새로운 데이터가 없을 때, 위의 함수는 돌아가지 않는다. 이때 사후분포는 사전분포와 똑같이 평균 0.5, 표준편차 0.5가 된다.</p></li>
<li><p><span class="math inline">\(n=10\)</span>. 10개의 관측치만 가지고 있을 때, MLE에는 잡음이 많고 우리는 베이지언 사후분포가 사전분포에 근접할 것이라고 기대하게 된다. 이때 베이즈 추정량은 0.7로 사전 분포의 평균인 0.5와 가깝게 나타난다. MLE는 2.1로 사전분포와 비교할 때, 꽤 잡음이 많이 포함된 것을 확인할 수 있다.</p></li>
</ul>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="logistic-regression.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_sim</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## glm(formula = y ~ x, family = binomial(link = &quot;logit&quot;), data = fake)
##             coef.est coef.se
## (Intercept) -2.7      1.6   
## x           -1.9      2.5   
## ---
##   n = 10, k = 2
##   residual deviance = 5.8, null deviance = 6.5 (difference = 0.7)
## stan_glm
##  family:       binomial [logit]
##  formula:      y ~ x
##  observations: 10
##  predictors:   2
## ------
##             Median MAD_SD
## (Intercept) -2.1    0.9  
## x            0.4    0.5  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<ul>
<li><span class="math inline">\(n=100\)</span>. <code>bayes_sim(100)</code>이라고 하자. 이 경우 MLE 추정량은 다시 1.2로 꽤 극단적인 값을 보여준다. 하지만 베이즈 추정량은 사전분포의 평균 0.5에 근접한 것을 확인할 수 있다.</li>
</ul>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="logistic-regression.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_sim</span>(<span class="dv">100</span>)</span></code></pre></div>
<pre><code>## glm(formula = y ~ x, family = binomial(link = &quot;logit&quot;), data = fake)
##             coef.est coef.se
## (Intercept) -2.4      0.4   
## x            1.0      0.7   
## ---
##   n = 100, k = 2
##   residual deviance = 58.2, null deviance = 60.5 (difference = 2.3)
## stan_glm
##  family:       binomial [logit]
##  formula:      y ~ x
##  observations: 100
##  predictors:   2
## ------
##             Median MAD_SD
## (Intercept) -2.4    0.4  
## x            0.7    0.4  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<ul>
<li><span class="math inline">\(n=1000\)</span>. 마지막으로 1,000개의 관측치를 가진 실험을 시뮬레이션한다고 하자. 이 정도면 가능도 추정량도 꽤 믿을만하다고 볼 수 있을 것이다. 아래의 코드 결과는 베이즈 추정량과 MLE가 거의 차이가 없다는 것을 보여준다.</li>
</ul>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="logistic-regression.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_sim</span>(<span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## glm(formula = y ~ x, family = binomial(link = &quot;logit&quot;), data = fake)
##             coef.est coef.se
## (Intercept) -1.9      0.1   
## x            0.8      0.2   
## ---
##   n = 1000, k = 2
##   residual deviance = 774.7, null deviance = 799.0 (difference = 24.3)
## stan_glm
##  family:       binomial [logit]
##  formula:      y ~ x
##  observations: 1000
##  predictors:   2
## ------
##             Median MAD_SD
## (Intercept) -1.9    0.1  
## x            0.8    0.2  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
</div>
<div id="cross-validation-and-log-score-for-logistic-regression" class="section level2" number="13.6">
<h2><span class="header-section-number">13.6</span> Cross validation and log score for logistic regression</h2>
<p>예측과 일반화에 대한 모델의 성과를 평가하고자 할 때, 우리는 이항 관측치와 이항 예측치 간을 비교해서 맞게 예측한 비율을 계산할 수 있다. 단, 이 경우 예측확률에 있어서의 추가적인 정보는 완벽하게 무시하게 된다. 그리고 우리는 비선형 회귀모델의 경우 일탈도(deviance)를 이용해 일반화 선형모형에서 모형이 자료를 얼마나 잘 설명하지 못하는가를 보여주는데, 이 일탈도는 대개 로그값을 취한 가능도(log-likelihood)로 정의된다. <span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020, 230–31</a>)</span>은 LOO (leave-one-out) 절차를 통해 각 모델의 로그 예측확률을 컴퓨팅해서 살펴볼 것을 제안하고 있다.</p>
<div id="understanding-the-log-score-for-discrete-predictions" class="section level3" number="13.6.1">
<h3><span class="header-section-number">13.6.1</span> Understanding the log score for discrete predictions</h3>
<p>다음의 시나리오를 생각해보자: 추정된 모수, <span class="math inline">\(\hat \beta\)</span>를 가지고 로지스틱 회귀모델을 적합하고 그 모델 결과를 <span class="math inline">\(n^{new}\)</span>라는 새로운 데이터 관측치를 가지는 예측변수 행렬, <span class="math inline">\(X^{new}\)</span>에 적용해 예측확률 <span class="math inline">\(p^{new}_i = \text{logit}^{-1}(X^{new}_i\hat \beta)\)</span> 벡터를 산출하는 것이다. 그리고 나서 결과인 <span class="math inline">\(y^{new}\)</span>를 확인하고 모델의 적합도를 다음과 같은 통계량을 이용해 평가해보자.</p>
<p><span class="math display">\[
\text{out-of-sample log score} = \sum^{n^{new}}_{i=1}
  \begin{cases}
    \log p^{new}_i &amp; \text{if }y^{new}_i = 1\\
    \log (1-p^{new}_i) &amp; \text{if }y^{new}_i = 0\\
  \end{cases}
\]</span></p>
<p>예측 로그값은 각 데이터 관측치의 예측 확률에 로그를 씌워 총합을 구한 것이다.</p>
<ul>
<li><p><span class="math inline">\(p^{new}_i = 0.8\)</span>일 경우, 새로운 관측치 <span class="math inline">\(y^{new}_i\)</span>가 1일 확률이 80%라는 것을 의미한다.</p></li>
<li><p><span class="math inline">\(p^{new}_i = 0.6\)</span>일 경우, 새로운 관측치 <span class="math inline">\(y^{new}_i\)</span>가 1일 확률이 60%라는 것을 의미한다.</p></li>
<li><p>확률이 0.8인 모델에서 0.6인 모델이 될 때, 그 로그값은 <span class="math inline">\(0.693n^{new}-0.587n^{new}=0.106n^{new}\)</span>으로 약 10 데이터 관측치에 따라 로그값이 1 정도 개선되었다는 것을 보여준다.</p></li>
</ul>
</div>
<div id="log-score-for-logistic-regression" class="section level3" number="13.6.2">
<h3><span class="header-section-number">13.6.2</span> Log score for logistic regression</h3>
<p>섹션 13.1의 1992년 미 대선 캠페인과 관련된 설문조사 예제를 떠올려보자. 그 설문조사는 중 빌 클린턴에 대한 지지를 표현한 702명의 응답자들과 조지 부쉬에 대한 선호를 나타낸 477명의 응답자들로 이루어졌다.</p>
<ul>
<li><p>어떠한 예측에 추가적인 정보도 주어지지 않은 모델, 즉 각 후보에 대한 지지 확률이 0.5일 경우, 1179명의 응답자들에 대한 로그값은 <span class="math inline">\(1179\log(0.5) = -817\)</span>이 된다.</p></li>
<li><p>만약 59.5%의 응답자가 클린턴을, 40.5%가 부시를 지지한다고 할 때, 우리는 각각의 값을 통해 로그값을 산출할 수 있다: <span class="math inline">\(477 \log(0.405) + 702 \log(−.595) = −796\)</span>.</p></li>
<li><p>이 두 모델의 로그값 차이를 표본크기로 나누어줄 때, <span class="math inline">\((817-796)/1179 =0.018\)</span>, 우리는 추가된 정보가 얼마나 종속변수를 더 설명하는 데 도움을 주는지(개선하였는지)를 알 수 있다.</p></li>
</ul>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ghv2020" class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="transformations-and-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulation-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
