<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Linear regression with multiple predictors | Reading Notes for Regression and Other Stories</title>
  <meta name="description" content="Chapter 10 Linear regression with multiple predictors | Reading Notes for Regression and Other Stories" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Linear regression with multiple predictors | Reading Notes for Regression and Other Stories" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="pherephobia/regression_hgv" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Linear regression with multiple predictors | Reading Notes for Regression and Other Stories" />
  
  
  

<meta name="author" content="Sanghoon Park" />


<meta name="date" content="2021-07-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="prediction-and-bayesian-inference.html"/>
<link rel="next" href="assumptions-diagnostics-and-model-evaluation.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-88838732-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GHV</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-three-challenges-of-statistics"><i class="fa fa-check"></i><b>1.1</b> The three challenges of statistics</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-learn-regression"><i class="fa fa-check"></i><b>1.2</b> Why learn regression?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#some-examples-of-regression"><i class="fa fa-check"></i><b>1.3</b> Some examples of regression</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#a-randomized-experiment-on-the-effect-of-an-educational-television-program"><i class="fa fa-check"></i><b>1.3.1</b> A randomized experiment on the effect of an educational television program</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#comparing-the-peacekeeping-and-gun-control-studies"><i class="fa fa-check"></i><b>1.3.2</b> Comparing the peacekeeping and gun-control studies</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#challenges-in-building-understanding-and-interpreting-regressions"><i class="fa fa-check"></i><b>1.4</b> Challenges in building, understanding, and interpreting regressions</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#regression-to-estimate-a-relationship-of-interest"><i class="fa fa-check"></i><b>1.4.1</b> Regression to estimate a relationship of interest</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#regression-to-adjust-for-differences-between-treatment-and-control-groups"><i class="fa fa-check"></i><b>1.4.2</b> Regression to adjust for differences between treatment and control groups</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#interpreting-coefficients-in-a-predictive-model"><i class="fa fa-check"></i><b>1.4.3</b> Interpreting coefficients in a predictive model</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#building-interpreting-and-checking-regression-models"><i class="fa fa-check"></i><b>1.4.4</b> Building, interpreting, and checking regression models</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#classical-and-bayesian-inference"><i class="fa fa-check"></i><b>1.5</b> Classical and Bayesian inference</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#information"><i class="fa fa-check"></i><b>1.5.1</b> Information</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#assumptions"><i class="fa fa-check"></i><b>1.5.2</b> Assumptions</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#classical-inference"><i class="fa fa-check"></i><b>1.5.3</b> Classical inference</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#bayesian-inference"><i class="fa fa-check"></i><b>1.5.4</b> Bayesian inference</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#computing-least-squares-and-bayesian-regression"><i class="fa fa-check"></i><b>1.6</b> Computing least squares and Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-and-measurement.html"><a href="data-and-measurement.html"><i class="fa fa-check"></i><b>2</b> Data and Measurement</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#examining-where-data-come-from"><i class="fa fa-check"></i><b>2.1</b> Examining where data come from</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#details-of-measurement-can-be-important"><i class="fa fa-check"></i><b>2.1.1</b> Details of measurement can be important</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-and-measurement.html"><a href="data-and-measurement.html#validity-and-reliability"><i class="fa fa-check"></i><b>2.2</b> Validity and reliability</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#validity"><i class="fa fa-check"></i><b>2.2.1</b> Validity</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-and-measurement.html"><a href="data-and-measurement.html#reliability"><i class="fa fa-check"></i><b>2.2.2</b> Reliability</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-and-measurement.html"><a href="data-and-measurement.html#sample-selection"><i class="fa fa-check"></i><b>2.2.3</b> Sample selection</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-and-measurement.html"><a href="data-and-measurement.html#all-graphs-are-comparisons"><i class="fa fa-check"></i><b>2.3</b> All graphs are comparisons</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#simple-scatterplots"><i class="fa fa-check"></i><b>2.3.1</b> Simple scatterplots</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-and-measurement.html"><a href="data-and-measurement.html#displaying-more-information-on-a-graph"><i class="fa fa-check"></i><b>2.3.2</b> Displaying more information on a graph</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-and-measurement.html"><a href="data-and-measurement.html#multiple-plots"><i class="fa fa-check"></i><b>2.3.3</b> Multiple plots</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-and-measurement.html"><a href="data-and-measurement.html#grids-of-plots"><i class="fa fa-check"></i><b>2.3.4</b> Grids of plots</a></li>
<li class="chapter" data-level="2.3.5" data-path="data-and-measurement.html"><a href="data-and-measurement.html#applying-graphical-principles-to-numerical-displays-and-communication-more-generally"><i class="fa fa-check"></i><b>2.3.5</b> Applying graphical principles to numerical displays and communication more generally</a></li>
<li class="chapter" data-level="2.3.6" data-path="data-and-measurement.html"><a href="data-and-measurement.html#graphics-for-understanding-statistical-models"><i class="fa fa-check"></i><b>2.3.6</b> Graphics for understanding statistical models</a></li>
<li class="chapter" data-level="2.3.7" data-path="data-and-measurement.html"><a href="data-and-measurement.html#graphs-as-comparisons"><i class="fa fa-check"></i><b>2.3.7</b> Graphs as comparisons</a></li>
<li class="chapter" data-level="2.3.8" data-path="data-and-measurement.html"><a href="data-and-measurement.html#graphs-of-fitted-models"><i class="fa fa-check"></i><b>2.3.8</b> Graphs of fitted models</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-and-measurement.html"><a href="data-and-measurement.html#data-and-adjustment-trends-in-mortality-rates"><i class="fa fa-check"></i><b>2.4</b> Data and adjustment: trends in mortality rates</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html"><i class="fa fa-check"></i><b>3</b> Some Basic Methods in Mathematics and Probability</a>
<ul>
<li class="chapter" data-level="3.1" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#weighted-averages"><i class="fa fa-check"></i><b>3.1</b> Weighted averages</a></li>
<li class="chapter" data-level="3.2" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#vectors-and-matrices"><i class="fa fa-check"></i><b>3.2</b> Vectors and matrices</a></li>
<li class="chapter" data-level="3.3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#graphing-a-line"><i class="fa fa-check"></i><b>3.3</b> Graphing a line</a></li>
<li class="chapter" data-level="3.4" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#exponential-and-power-law-growth-and-decline-logarithmic-and-log-log-relationships"><i class="fa fa-check"></i><b>3.4</b> Exponential and power-law growth and decline; logarithmic and log-log relationships</a></li>
<li class="chapter" data-level="3.5" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#probability-distributions"><i class="fa fa-check"></i><b>3.5</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#mean-and-standard-deviation-of-a-probability-distribution"><i class="fa fa-check"></i><b>3.5.1</b> Mean and standard deviation of a probability distribution</a></li>
<li class="chapter" data-level="3.5.2" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#normal-distribution-mean-and-standard-deviation"><i class="fa fa-check"></i><b>3.5.2</b> Normal distribution; mean and standard deviation</a></li>
<li class="chapter" data-level="3.5.3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#linear-transformations"><i class="fa fa-check"></i><b>3.5.3</b> Linear transformations</a></li>
<li class="chapter" data-level="3.5.4" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#mean-and-standard-deviation-of-the-sum-of-correlated-random-variables"><i class="fa fa-check"></i><b>3.5.4</b> Mean and standard deviation of the sum of correlated random variables</a></li>
<li class="chapter" data-level="3.5.5" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#lognormal-distribution"><i class="fa fa-check"></i><b>3.5.5</b> Lognormal distribution</a></li>
<li class="chapter" data-level="3.5.6" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#binomial-distribution"><i class="fa fa-check"></i><b>3.5.6</b> Binomial distribution</a></li>
<li class="chapter" data-level="3.5.7" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#poisson-distribution"><i class="fa fa-check"></i><b>3.5.7</b> Poisson distribution</a></li>
<li class="chapter" data-level="3.5.8" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#unclassified-probability-distribution"><i class="fa fa-check"></i><b>3.5.8</b> Unclassified probability distribution</a></li>
<li class="chapter" data-level="3.5.9" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#probability-distributions-for-error"><i class="fa fa-check"></i><b>3.5.9</b> Probability distributions for error</a></li>
<li class="chapter" data-level="3.5.10" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#comparing-distributions"><i class="fa fa-check"></i><b>3.5.10</b> Comparing distributions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#probability-modeling"><i class="fa fa-check"></i><b>3.6</b> Probability modeling</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#using-an-empirical-forecast"><i class="fa fa-check"></i><b>3.6.1</b> Using an empirical forecast</a></li>
<li class="chapter" data-level="3.6.2" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#using-an-reasonable-seeming-but-inappropriate-probability-model"><i class="fa fa-check"></i><b>3.6.2</b> Using an reasonable-seeming but inappropriate probability model</a></li>
<li class="chapter" data-level="3.6.3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#general-lessons-for-probability-modeling"><i class="fa fa-check"></i><b>3.6.3</b> General lessons for probability modeling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-distributions-and-generative-models"><i class="fa fa-check"></i><b>4.1</b> Sampling distributions and generative models</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-measurement-error-and-model-error"><i class="fa fa-check"></i><b>4.1.1</b> Sampling, measurement error, and model error</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistical-inference.html"><a href="statistical-inference.html#the-sampling-distribution"><i class="fa fa-check"></i><b>4.1.2</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#estimates-standard-errors-and-confidence-intervals"><i class="fa fa-check"></i><b>4.2</b> Estimates, standard errors, and confidence intervals</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="statistical-inference.html"><a href="statistical-inference.html#parameters-estimands-and-estimates"><i class="fa fa-check"></i><b>4.2.1</b> Parameters, estimands, and estimates</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-errors-inferential-uncertainty-and-confidence-intervals"><i class="fa fa-check"></i><b>4.2.2</b> Standard errors, inferential uncertainty, and confidence intervals</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-errors-and-confidence-intervals-for-average-and-proportions"><i class="fa fa-check"></i><b>4.2.3</b> Standard errors and confidence intervals for average and proportions</a></li>
<li class="chapter" data-level="4.2.4" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-error-and-confidence-interval-for-a-proportion-when-y-0-or-y-n"><i class="fa fa-check"></i><b>4.2.4</b> Standard error and confidence interval for a proportion when <span class="math inline">\(y = 0\)</span> or <span class="math inline">\(y = n\)</span></a></li>
<li class="chapter" data-level="4.2.5" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-error-for-a-comparison"><i class="fa fa-check"></i><b>4.2.5</b> Standard error for a comparison</a></li>
<li class="chapter" data-level="4.2.6" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-distribution-of-the-sample-mean-and-standard-deviation-normal-and-chi2-distributions"><i class="fa fa-check"></i><b>4.2.6</b> Sampling distribution of the sample mean and standard deviation; normal and <span class="math inline">\(\chi^2\)</span> distributions</a></li>
<li class="chapter" data-level="4.2.7" data-path="statistical-inference.html"><a href="statistical-inference.html#degrees-of-freedom"><i class="fa fa-check"></i><b>4.2.7</b> Degrees of freedom</a></li>
<li class="chapter" data-level="4.2.8" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals-from-the-t-distribution"><i class="fa fa-check"></i><b>4.2.8</b> Confidence intervals from the <span class="math inline">\(t\)</span> distribution</a></li>
<li class="chapter" data-level="4.2.9" data-path="statistical-inference.html"><a href="statistical-inference.html#inference-for-discrete-data"><i class="fa fa-check"></i><b>4.2.9</b> Inference for discrete data</a></li>
<li class="chapter" data-level="4.2.10" data-path="statistical-inference.html"><a href="statistical-inference.html#linear-transformations-1"><i class="fa fa-check"></i><b>4.2.10</b> Linear transformations</a></li>
<li class="chapter" data-level="4.2.11" data-path="statistical-inference.html"><a href="statistical-inference.html#comparisons-visual-and-numerical"><i class="fa fa-check"></i><b>4.2.11</b> Comparisons, visual and numerical</a></li>
<li class="chapter" data-level="4.2.12" data-path="statistical-inference.html"><a href="statistical-inference.html#weighted-averages-1"><i class="fa fa-check"></i><b>4.2.12</b> Weighted averages</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#bias-and-unmodeled-uncertainty"><i class="fa fa-check"></i><b>4.3</b> Bias and unmodeled uncertainty</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="statistical-inference.html"><a href="statistical-inference.html#bias-in-estimation"><i class="fa fa-check"></i><b>4.3.1</b> Bias in estimation</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistical-inference.html"><a href="statistical-inference.html#adjusting-inferences-to-account-for-bias-and-unmodeled-uncertainty"><i class="fa fa-check"></i><b>4.3.2</b> Adjusting inferences to account for bias and unmodeled uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#statistical-significance-hypothesis-testing-and-statistical-errors"><i class="fa fa-check"></i><b>4.4</b> Statistical significance, hypothesis testing, and statistical errors</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#statistical-significance"><i class="fa fa-check"></i><b>4.4.1</b> Statistical significance</a></li>
<li class="chapter" data-level="4.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#hypothesis-testing-for-simple-comparisons."><i class="fa fa-check"></i><b>4.4.2</b> Hypothesis testing for simple comparisons.</a></li>
<li class="chapter" data-level="4.4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#hypothesis-testing-general-formulation."><i class="fa fa-check"></i><b>4.4.3</b> Hypothesis testing: general formulation.</a></li>
<li class="chapter" data-level="4.4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#comparisons-of-parameters-to-fixed-values-and-each-other-interpreting-confidence-intervals-as-hypothesis-tests."><i class="fa fa-check"></i><b>4.4.4</b> Comparisons of parameters to fixed values and each other: interpreting confidence intervals as hypothesis tests.</a></li>
<li class="chapter" data-level="4.4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#type-1-and-type-2-errors-and-why-we-dont-like-talking-about-them."><i class="fa fa-check"></i><b>4.4.5</b> Type 1 and type 2 errors and why we don’t like talking about them.</a></li>
<li class="chapter" data-level="4.4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#type-m-magnitude-and-type-s-sign-errors."><i class="fa fa-check"></i><b>4.4.6</b> 4.4.6 Type M (magnitude) and type S (sign) errors.</a></li>
<li class="chapter" data-level="4.4.7" data-path="statistical-inference.html"><a href="statistical-inference.html#hypothesis-testing-and-statistical-practice."><i class="fa fa-check"></i><b>4.4.7</b> Hypothesis testing and statistical practice.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#problems-with-the-concept-of-statistical-significance"><i class="fa fa-check"></i><b>4.5</b> Problems with the concept of statistical significance</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="statistical-inference.html"><a href="statistical-inference.html#statistical-significance-is-not-the-same-as-practical-importance."><i class="fa fa-check"></i><b>4.5.1</b> Statistical significance is not the same as practical importance.</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistical-inference.html"><a href="statistical-inference.html#non-significance-is-not-the-same-as-zero."><i class="fa fa-check"></i><b>4.5.2</b> Non-significance is not the same as zero.</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistical-inference.html"><a href="statistical-inference.html#the-difference-between-significant-and-not-significant-is-not-itself-statistically-significant."><i class="fa fa-check"></i><b>4.5.3</b> The difference between “significant” and “not significant” is not itself statistically significant.</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistical-inference.html"><a href="statistical-inference.html#researcher-degrees-of-freedom-p-hacking-and-forking-paths."><i class="fa fa-check"></i><b>4.5.4</b> Researcher degrees of freedom, <span class="math inline">\(p\)</span>-hacking, and forking paths.</a></li>
<li class="chapter" data-level="4.5.5" data-path="statistical-inference.html"><a href="statistical-inference.html#the-statistical-significance-filter."><i class="fa fa-check"></i><b>4.5.5</b> The statistical significance filter.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#moving-beyond-hypothesis-testing"><i class="fa fa-check"></i><b>4.6</b> Moving beyond hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>5</b> Simulation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulation.html"><a href="simulation.html#simulation-of-discrete-probability-models"><i class="fa fa-check"></i><b>5.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="simulation.html"><a href="simulation.html#how-many-girls-in-400-births"><i class="fa fa-check"></i><b>5.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="5.1.2" data-path="simulation.html"><a href="simulation.html#accounting-for-twins"><i class="fa fa-check"></i><b>5.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="simulation.html"><a href="simulation.html#simulation-of-continuous-and-mixed-discretecontinuous-models"><i class="fa fa-check"></i><b>5.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="simulation.html"><a href="simulation.html#simulation-in-r-using-custom-made-functions"><i class="fa fa-check"></i><b>5.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulation.html"><a href="simulation.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation"><i class="fa fa-check"></i><b>5.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="5.4" data-path="simulation.html"><a href="simulation.html#bootstrapping-to-simulate-a-sampling-distribution"><i class="fa fa-check"></i><b>5.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="simulation.html"><a href="simulation.html#choices-in-defining-the-bootstrap-distribution"><i class="fa fa-check"></i><b>5.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="5.4.2" data-path="simulation.html"><a href="simulation.html#limitations-of-bootstrapping"><i class="fa fa-check"></i><b>5.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="simulation.html"><a href="simulation.html#fake-data-simulation-as-a-way-of-life"><i class="fa fa-check"></i><b>5.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html"><i class="fa fa-check"></i><b>6</b> Background on regression modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#regression-models"><i class="fa fa-check"></i><b>6.1</b> Regression models</a></li>
<li class="chapter" data-level="6.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#fitting-a-simple-regression-to-fake-data"><i class="fa fa-check"></i><b>6.2</b> Fitting a simple regression to fake data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#fitting-a-regression-and-displaying-the-results"><i class="fa fa-check"></i><b>6.2.1</b> Fitting a regression and displaying the results</a></li>
<li class="chapter" data-level="6.2.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#comparing-estimates-to-assumed-parameter-values"><i class="fa fa-check"></i><b>6.2.2</b> Comparing estimates to assumed parameter values</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#interpret-coefficients-as-comparisons-not-effects"><i class="fa fa-check"></i><b>6.3</b> Interpret coefficients as comparisons, not effects</a></li>
<li class="chapter" data-level="6.4" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#historical-origins-of-regression"><i class="fa fa-check"></i><b>6.4</b> Historical origins of regression</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#daughters-heights-regressing-to-the-mean"><i class="fa fa-check"></i><b>6.4.1</b> Daughters’ heights “regressing” to the mean</a></li>
<li class="chapter" data-level="6.4.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#fitting-the-model-in-r"><i class="fa fa-check"></i><b>6.4.2</b> Fitting the model in R</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#the-paradox-of-regression-to-the-mean"><i class="fa fa-check"></i><b>6.5</b> The paradox of regression to the mean</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#how-regression-to-the-mean-can-confuse-people-about-causal-inference-demonstration-using-fake-data"><i class="fa fa-check"></i><b>6.5.1</b> How regression to the mean can confuse people about causal inference; demonstration using fake data</a></li>
<li class="chapter" data-level="6.5.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#relation-of-regression-to-the-mean-to-the-larger-themes-of-the-book"><i class="fa fa-check"></i><b>6.5.2</b> Relation of “regression to the mean” to the larger themes of the book</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html"><i class="fa fa-check"></i><b>7</b> Linear regression with a single predictor</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#example-predicting-presidential-vote-share-from-the-economy"><i class="fa fa-check"></i><b>7.1</b> Example: predicting presidential vote share from the economy</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#fitting-a-linear-model-to-data"><i class="fa fa-check"></i><b>7.1.1</b> Fitting a linear model to data</a></li>
<li class="chapter" data-level="7.1.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#understanding-the-fitted-model"><i class="fa fa-check"></i><b>7.1.2</b> Understanding the fitted model</a></li>
<li class="chapter" data-level="7.1.3" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#graphing-the-fitted-regression-line"><i class="fa fa-check"></i><b>7.1.3</b> Graphing the fitted regression line</a></li>
<li class="chapter" data-level="7.1.4" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#using-the-model-to-predict"><i class="fa fa-check"></i><b>7.1.4</b> Using the model to predict</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#checking-the-model-fitting-procedure-using-fake-data-simulation"><i class="fa fa-check"></i><b>7.2</b> Checking the model-fitting procedure using fake-data simulation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-1-creating-the-pretend-world"><i class="fa fa-check"></i><b>7.2.1</b> Step 1: Creating the pretend world</a></li>
<li class="chapter" data-level="7.2.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-2-simulating-fake-data"><i class="fa fa-check"></i><b>7.2.2</b> Step 2: Simulating fake data</a></li>
<li class="chapter" data-level="7.2.3" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-3-fitting-the-model-and-comparing-fitted-to-assumed-values"><i class="fa fa-check"></i><b>7.2.3</b> Step 3: Fitting the model and comparing fitted to assumed values</a></li>
<li class="chapter" data-level="7.2.4" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-4-embedding-the-simulation-in-a-loop"><i class="fa fa-check"></i><b>7.2.4</b> Step 4: Embedding the simulation in a loop</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#formulating-comparisons-as-regression-models"><i class="fa fa-check"></i><b>7.3</b> Formulating comparisons as regression models</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#estimating-the-mean-is-the-same-as-regressing-on-a-constant-term"><i class="fa fa-check"></i><b>7.3.1</b> Estimating the mean is the same as regressing on a constant term</a></li>
<li class="chapter" data-level="7.3.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#estimating-a-difference-is-the-same-as-regressing-on-an-indicator-variable"><i class="fa fa-check"></i><b>7.3.2</b> Estimating a difference is the same as regressing on an indicator variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html"><i class="fa fa-check"></i><b>8</b> Fitting regression models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#least-squares-maximum-likelihood-and-bayesian-inference"><i class="fa fa-check"></i><b>8.1</b> Least squares, maximum likelihood, and Bayesian inference</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#least-squares"><i class="fa fa-check"></i><b>8.1.1</b> Least squares</a></li>
<li class="chapter" data-level="8.1.2" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#estimation-of-residual-standard-deviation-sigma"><i class="fa fa-check"></i><b>8.1.2</b> Estimation of residual standard deviation <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="8.1.3" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#computing-the-sum-of-squares-directly"><i class="fa fa-check"></i><b>8.1.3</b> Computing the sum of squares directly</a></li>
<li class="chapter" data-level="8.1.4" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#maximum-likelihood"><i class="fa fa-check"></i><b>8.1.4</b> Maximum likelihood</a></li>
<li class="chapter" data-level="8.1.5" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#where-do-the-standard-errors-come-from-using-the-likelihood-surface-to-assess-uncertainty-in-the-parameter-estimates"><i class="fa fa-check"></i><b>8.1.5</b> Where do the standard errors come from? Using the likelihood surface to assess uncertainty in the parameter estimates</a></li>
<li class="chapter" data-level="8.1.6" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#bayesian-inference-1"><i class="fa fa-check"></i><b>8.1.6</b> Bayesian inference</a></li>
<li class="chapter" data-level="8.1.7" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#point-estimate-mode-based-approximation-and-posterior-simulations"><i class="fa fa-check"></i><b>8.1.7</b> Point estimate, mode-based approximation, and posterior simulations</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#influence-of-individual-points-in-a-fitted-regression"><i class="fa fa-check"></i><b>8.2</b> Influence of individual points in a fitted regression</a></li>
<li class="chapter" data-level="8.3" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#least-squares-slope-as-a-weighted-average-of-slopes-of-pairs"><i class="fa fa-check"></i><b>8.3</b> Least squares slope as a weighted average of slopes of pairs</a></li>
<li class="chapter" data-level="8.4" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#comparing-two-fitting-functions-lm-and-stan_glm"><i class="fa fa-check"></i><b>8.4</b> Comparing two fitting functions: <code>lm</code> and <code>stan_glm</code></a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#reproducing-maximum-likelihood-using-stan_glm-with-flat-priors-and-optimization"><i class="fa fa-check"></i><b>8.4.1</b> Reproducing maximum likelihood using <code>stan_glm</code> with flat priors and optimization</a></li>
<li class="chapter" data-level="8.4.2" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#running-lm"><i class="fa fa-check"></i><b>8.4.2</b> Running <code>lm</code></a></li>
<li class="chapter" data-level="8.4.3" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#confidence-intervals-uncertainty-intervals-compatibility-intervals"><i class="fa fa-check"></i><b>8.4.3</b> Confidence intervals, uncertainty intervals, compatibility intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html"><i class="fa fa-check"></i><b>9</b> Prediction and Bayesian inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#propagating-uncertainty-in-inference-using-posterior-simulations"><i class="fa fa-check"></i><b>9.1</b> Propagating uncertainty in inference using posterior simulations</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#uncertainty-in-the-regression-coefficients-and-implied-uncertainty-in-the-regression-line"><i class="fa fa-check"></i><b>9.1.1</b> Uncertainty in the regression coefficients and implied uncertainty in the regression line</a></li>
<li class="chapter" data-level="9.1.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#using-the-matrix-of-posterior-simulations-to-express-uncertainty-about-a-parameter-estimate-or-function-of-parameter-estimates"><i class="fa fa-check"></i><b>9.1.2</b> Using the matrix of posterior simulations to express uncertainty about a parameter estimate or function of parameter estimates</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prediction-and-uncertainty-predict-posterior_linpred-and-posterior_predict"><i class="fa fa-check"></i><b>9.2</b> Prediction and uncertainty: predict, posterior_linpred, and posterior_predict</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#point-prediction-using-predict"><i class="fa fa-check"></i><b>9.2.1</b> Point prediction using predict</a></li>
<li class="chapter" data-level="9.2.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#linear-predictor-with-uncertainty-using-posterior_linpred-or-posterior_epred"><i class="fa fa-check"></i><b>9.2.2</b> Linear predictor with uncertainty using posterior_linpred or posterior_epred</a></li>
<li class="chapter" data-level="9.2.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#predictive-distribution-for-a-new-observation-using-posterior_predict"><i class="fa fa-check"></i><b>9.2.3</b> Predictive distribution for a new observation using posterior_predict</a></li>
<li class="chapter" data-level="9.2.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prediction-given-a-range-of-input-values"><i class="fa fa-check"></i><b>9.2.4</b> Prediction given a range of input values</a></li>
<li class="chapter" data-level="9.2.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#propagating-uncertainty"><i class="fa fa-check"></i><b>9.2.5</b> Propagating uncertainty</a></li>
<li class="chapter" data-level="9.2.6" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#simulating-uncertainty-for-the-linear-predictor-and-new-observations"><i class="fa fa-check"></i><b>9.2.6</b> Simulating uncertainty for the linear predictor and new observations</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prior-information-and-bayesian-synthesis"><i class="fa fa-check"></i><b>9.3</b> Prior information and Bayesian synthesis</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#expressing-data-and-prior-information-on-the-same-scale"><i class="fa fa-check"></i><b>9.3.1</b> Expressing data and prior information on the same scale</a></li>
<li class="chapter" data-level="9.3.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#bayesian-information-aggregation"><i class="fa fa-check"></i><b>9.3.2</b> Bayesian information aggregation</a></li>
<li class="chapter" data-level="9.3.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#different-ways-of-assigning-prior-distributions-and-performing-bayesian-calculations"><i class="fa fa-check"></i><b>9.3.3</b> Different ways of assigning prior distributions and performing Bayesian calculations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#example-of-bayesian-inference-beauty-and-sex-ratio"><i class="fa fa-check"></i><b>9.4</b> Example of Bayesian inference: beauty and sex ratio</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prior-information"><i class="fa fa-check"></i><b>9.4.1</b> Prior information</a></li>
<li class="chapter" data-level="9.4.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prior-estimate-and-standard-error"><i class="fa fa-check"></i><b>9.4.2</b> Prior estimate and standard error</a></li>
<li class="chapter" data-level="9.4.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#data-estimate-and-standard-error"><i class="fa fa-check"></i><b>9.4.3</b> Data estimate and standard error</a></li>
<li class="chapter" data-level="9.4.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#bayes-estimate"><i class="fa fa-check"></i><b>9.4.4</b> Bayes estimate</a></li>
<li class="chapter" data-level="9.4.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#understanding-the-bayes-estimate"><i class="fa fa-check"></i><b>9.4.5</b> Understanding the Bayes estimate</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#uniform-weakly-informative-and-informative-priors-in-regression"><i class="fa fa-check"></i><b>9.5</b> Uniform, weakly informative, and informative priors in regression</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#uniform-prior-distribution"><i class="fa fa-check"></i><b>9.5.1</b> Uniform prior distribution</a></li>
<li class="chapter" data-level="9.5.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#default-prior-distribution"><i class="fa fa-check"></i><b>9.5.2</b> Default prior distribution</a></li>
<li class="chapter" data-level="9.5.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#weakly-informative-prior-distribution-based-on-subject-matter-knowledge"><i class="fa fa-check"></i><b>9.5.3</b> Weakly informative prior distribution based on subject-matter knowledge</a></li>
<li class="chapter" data-level="9.5.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#example-where-an-informative-prior-makes-a-difference-beauty-and-sex-ratio"><i class="fa fa-check"></i><b>9.5.4</b> Example where an informative prior makes a difference: Beauty and sex ratio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html"><i class="fa fa-check"></i><b>10</b> Linear regression with multiple predictors</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#adding-predictors-to-a-model"><i class="fa fa-check"></i><b>10.1</b> Adding predictors to a model</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#starting-with-a-binary-predictor"><i class="fa fa-check"></i><b>10.1.1</b> Starting with a binary predictor</a></li>
<li class="chapter" data-level="10.1.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#a-single-continuous-predictor"><i class="fa fa-check"></i><b>10.1.2</b> A single continuous predictor</a></li>
<li class="chapter" data-level="10.1.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#including-both-predictors"><i class="fa fa-check"></i><b>10.1.3</b> Including both predictors</a></li>
<li class="chapter" data-level="10.1.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#understanding-the-fitted-model-1"><i class="fa fa-check"></i><b>10.1.4</b> Understanding the fitted model</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#interpreting-regression-coefficients"><i class="fa fa-check"></i><b>10.2</b> Interpreting regression coefficients</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#its-not-always-possible-to-change-one-predictor-while-holding-all-others-constant"><i class="fa fa-check"></i><b>10.2.1</b> It’s not always possible to change one predictor while holding all others constant</a></li>
<li class="chapter" data-level="10.2.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#counterfactual-and-predictive-interpretations"><i class="fa fa-check"></i><b>10.2.2</b> Counterfactual and predictive interpretations</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#interactions"><i class="fa fa-check"></i><b>10.3</b> Interactions</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#when-should-we-look-for-interactions"><i class="fa fa-check"></i><b>10.3.1</b> When should we look for interactions?</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#interpreting-regression-coefficients-in-the-presence-of-interactions"><i class="fa fa-check"></i><b>10.3.2</b> Interpreting regression coefficients in the presence of interactions</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#indicator-variables"><i class="fa fa-check"></i><b>10.4</b> Indicator variables</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#centering-a-predictor"><i class="fa fa-check"></i><b>10.4.1</b> Centering a predictor</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#including-a-binary-variable-in-a-regression"><i class="fa fa-check"></i><b>10.4.2</b> Including a binary variable in a regression</a></li>
<li class="chapter" data-level="10.4.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#using-indicator-variables-for-multiple-levels-of-a-categorical-predictor"><i class="fa fa-check"></i><b>10.4.3</b> Using indicator variables for multiple levels of a categorical predictor</a></li>
<li class="chapter" data-level="10.4.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#changing-the-baseline-factor-level"><i class="fa fa-check"></i><b>10.4.4</b> Changing the baseline factor level</a></li>
<li class="chapter" data-level="10.4.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#using-an-index-variable-to-access-a-group-level-predictor"><i class="fa fa-check"></i><b>10.4.5</b> Using an index variable to access a group-level predictor</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#formulating-paired-or-blocked-designs-as-a-regression-problem"><i class="fa fa-check"></i><b>10.5</b> Formulating paired or blocked designs as a regression problem</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#completely-randomized-experiment"><i class="fa fa-check"></i><b>10.5.1</b> Completely randomized experiment</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#paired-design"><i class="fa fa-check"></i><b>10.5.2</b> Paired design</a></li>
<li class="chapter" data-level="10.5.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#block-design"><i class="fa fa-check"></i><b>10.5.3</b> Block design</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#example-uncertainty-in-predicting-congressional-elections"><i class="fa fa-check"></i><b>10.6</b> Example: uncertainty in predicting congressional elections</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#background"><i class="fa fa-check"></i><b>10.6.1</b> Background</a></li>
<li class="chapter" data-level="10.6.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#data-issues"><i class="fa fa-check"></i><b>10.6.2</b> Data issues</a></li>
<li class="chapter" data-level="10.6.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#fitting-the-model"><i class="fa fa-check"></i><b>10.6.3</b> Fitting the model</a></li>
<li class="chapter" data-level="10.6.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#simulation-for-inferences-and-predictions-of-new-data-points"><i class="fa fa-check"></i><b>10.6.4</b> Simulation for inferences and predictions of new data points</a></li>
<li class="chapter" data-level="10.6.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#predictive-simulation-for-a-nonlinear-function-of-new-data"><i class="fa fa-check"></i><b>10.6.5</b> Predictive simulation for a nonlinear function of new data</a></li>
<li class="chapter" data-level="10.6.6" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#combining-simulation-and-analytic-calculations"><i class="fa fa-check"></i><b>10.6.6</b> Combining simulation and analytic calculations</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#mathematical-notation-and-statistical-inference"><i class="fa fa-check"></i><b>10.7</b> Mathematical notation and statistical inference</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#predictors"><i class="fa fa-check"></i><b>10.7.1</b> Predictors</a></li>
<li class="chapter" data-level="10.7.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#regression-in-vector-matrix-notation"><i class="fa fa-check"></i><b>10.7.2</b> Regression in vector-matrix notation</a></li>
<li class="chapter" data-level="10.7.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#two-ways-of-writing-the-model"><i class="fa fa-check"></i><b>10.7.3</b> Two ways of writing the model</a></li>
<li class="chapter" data-level="10.7.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#nonidentified-parameters-collinearity-and-the-likelihood-function"><i class="fa fa-check"></i><b>10.7.4</b> Nonidentified parameters, collinearity, and the likelihood function</a></li>
<li class="chapter" data-level="10.7.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#hypothesis-testing-why-we-do-not-like-t-tests-and-f-tests"><i class="fa fa-check"></i><b>10.7.5</b> Hypothesis testing: why we do not like <span class="math inline">\(t\)</span> tests and <span class="math inline">\(F\)</span> tests</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#weighted-regression"><i class="fa fa-check"></i><b>10.8</b> Weighted regression</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#three-models-leading-to-weighted-regression"><i class="fa fa-check"></i><b>10.8.1</b> Three models leading to weighted regression</a></li>
<li class="chapter" data-level="10.8.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#using-a-matrix-of-weights-to-account-for-correlated-errors"><i class="fa fa-check"></i><b>10.8.2</b> Using a matrix of weights to account for correlated errors</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#fitting-the-same-model-to-many-datasets"><i class="fa fa-check"></i><b>10.9</b> Fitting the same model to many datasets</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#predicting-party-identification"><i class="fa fa-check"></i><b>10.9.1</b> Predicting party identification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html"><i class="fa fa-check"></i><b>11</b> Assumptions, diagnostics, and model evaluation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#assumptions-of-regression-analysis"><i class="fa fa-check"></i><b>11.1</b> Assumptions of regression analysis</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#failures-of-the-assumptions"><i class="fa fa-check"></i><b>11.1.1</b> Failures of the assumptions</a></li>
<li class="chapter" data-level="11.1.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#causal-inference"><i class="fa fa-check"></i><b>11.1.2</b> Causal inference</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#plotting-the-data-and-fitted-model"><i class="fa fa-check"></i><b>11.2</b> Plotting the data and fitted model</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-a-regression-line-as-a-function-of-one-input-variable"><i class="fa fa-check"></i><b>11.2.1</b> Displaying a regression line as a function of one input variable</a></li>
<li class="chapter" data-level="11.2.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-two-fitted-regression-lines"><i class="fa fa-check"></i><b>11.2.2</b> Displaying two fitted regression lines</a></li>
<li class="chapter" data-level="11.2.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-uncertainty-in-the-fitted-regression"><i class="fa fa-check"></i><b>11.2.3</b> Displaying uncertainty in the fitted regression</a></li>
<li class="chapter" data-level="11.2.4" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-using-one-plot-for-each-input-variable"><i class="fa fa-check"></i><b>11.2.4</b> Displaying using one plot for each input variable</a></li>
<li class="chapter" data-level="11.2.5" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#plotting-the-outcome-vs.-a-continuous-predictor"><i class="fa fa-check"></i><b>11.2.5</b> Plotting the outcome vs. a continuous predictor</a></li>
<li class="chapter" data-level="11.2.6" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#forming-a-linear-predictor-from-a-multiple-regression"><i class="fa fa-check"></i><b>11.2.6</b> Forming a linear predictor from a multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#residual-plots"><i class="fa fa-check"></i><b>11.3</b> Residual plots</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#using-fake-data-simulation-to-understand-residual-plots"><i class="fa fa-check"></i><b>11.3.1</b> Using fake-data simulation to understand residual plots</a></li>
<li class="chapter" data-level="11.3.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#a-confusing-choice-plot-residuals-vs.-predicted-values-or-residuals-vs.-observed-values"><i class="fa fa-check"></i><b>11.3.2</b> A confusing choice: plot residuals vs. predicted values, or residuals vs. observed values?</a></li>
<li class="chapter" data-level="11.3.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#understanding-the-choice-using-fake-data-simulation"><i class="fa fa-check"></i><b>11.3.3</b> Understanding the choice using fake-data simulation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#comparing-data-to-replications-from-a-fitted-model"><i class="fa fa-check"></i><b>11.4</b> Comparing data to replications from a fitted model</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#example-simulation-based-checking-of-a-fitted-normal-distribution"><i class="fa fa-check"></i><b>11.4.1</b> Example: simulation-based checking of a fitted normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#example-predictive-simulation-to-check-the-fit-of-a-time-series-model"><i class="fa fa-check"></i><b>11.5</b> Example: predictive simulation to check the fit of a time-series model</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#fitting-a-first-order-autoregression-to-the-unemployment-series"><i class="fa fa-check"></i><b>11.5.1</b> Fitting a first-order autoregression to the unemployment series</a></li>
<li class="chapter" data-level="11.5.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#simulating-replicated-datasets"><i class="fa fa-check"></i><b>11.5.2</b> Simulating replicated datasets</a></li>
<li class="chapter" data-level="11.5.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#visual-and-numerical-comparisons-of-replicated-to-actual-data"><i class="fa fa-check"></i><b>11.5.3</b> Visual and numerical comparisons of replicated to actual data</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#residual-standard-deviation-sigma-and-explained-variance-r2"><i class="fa fa-check"></i><b>11.6</b> Residual standard deviation <span class="math inline">\(\sigma\)</span> and explained variance <span class="math inline">\(R^2\)</span></a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#difficulties-in-interpreting-residual-standard-deviation-and-explained-variance"><i class="fa fa-check"></i><b>11.6.1</b> Difficulties in interpreting residual standard deviation and explained variance</a></li>
<li class="chapter" data-level="11.6.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#bayesian-r2"><i class="fa fa-check"></i><b>11.6.2</b> Bayesian <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#external-validation-checking-fitted-model-on-new-data"><i class="fa fa-check"></i><b>11.7</b> External validation: checking fitted model on new data</a></li>
<li class="chapter" data-level="11.8" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#cross-validation"><i class="fa fa-check"></i><b>11.8</b> Cross validation</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>11.8.1</b> Leave-one-out cross validation</a></li>
<li class="chapter" data-level="11.8.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#fast-leave-one-out-cross-validation"><i class="fa fa-check"></i><b>11.8.2</b> Fast leave-one-out cross validation</a></li>
<li class="chapter" data-level="11.8.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#summarizing-prediction-error-using-the-log-score-and-deviance"><i class="fa fa-check"></i><b>11.8.3</b> Summarizing prediction error using the log score and deviance</a></li>
<li class="chapter" data-level="11.8.4" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#overfitting-and-aic"><i class="fa fa-check"></i><b>11.8.4</b> Overfitting and AIC</a></li>
<li class="chapter" data-level="11.8.5" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#interpreting-differences-in-log-scores"><i class="fa fa-check"></i><b>11.8.5</b> Interpreting differences in log scores</a></li>
<li class="chapter" data-level="11.8.6" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#demonstration-of-adding-pure-noise-predictors-to-a-model"><i class="fa fa-check"></i><b>11.8.6</b> Demonstration of adding pure noise predictors to a model</a></li>
<li class="chapter" data-level="11.8.7" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>11.8.7</b> <span class="math inline">\(K\)</span>-fold cross validation</a></li>
<li class="chapter" data-level="11.8.8" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#demonstration-of-k-fold-cross-validation-using-simulated-data"><i class="fa fa-check"></i><b>11.8.8</b> Demonstration of <span class="math inline">\(K\)</span>-fold cross validation using simulated data</a></li>
<li class="chapter" data-level="11.8.9" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#concerns-about-model-selection"><i class="fa fa-check"></i><b>11.8.9</b> Concerns about model selection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html"><i class="fa fa-check"></i><b>12</b> Transformations and regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#linear-transformations-2"><i class="fa fa-check"></i><b>12.1</b> Linear transformations</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#scaling-of-predictors-and-regression-coefficients"><i class="fa fa-check"></i><b>12.1.1</b> Scaling of predictors and regression coefficients</a></li>
<li class="chapter" data-level="12.1.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardization-using-z-scores"><i class="fa fa-check"></i><b>12.1.2</b> Standardization using z-scores</a></li>
<li class="chapter" data-level="12.1.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardization-using-an-externally-specified-population-distribution"><i class="fa fa-check"></i><b>12.1.3</b> Standardization using an externally specified population distribution</a></li>
<li class="chapter" data-level="12.1.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardization-using-reasonable-scales"><i class="fa fa-check"></i><b>12.1.4</b> Standardization using reasonable scales</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#centering-and-standardizing-for-models-with-interactions"><i class="fa fa-check"></i><b>12.2</b> Centering and standardizing for models with interactions</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#centering-by-subtracting-the-mean-of-the-data"><i class="fa fa-check"></i><b>12.2.1</b> Centering by subtracting the mean of the data</a></li>
<li class="chapter" data-level="12.2.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-a-conventional-centering-point"><i class="fa fa-check"></i><b>12.2.2</b> Using a conventional centering point</a></li>
<li class="chapter" data-level="12.2.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardizing-by-subtracting-the-mean-and-dividing-by-2-standard-deviations"><i class="fa fa-check"></i><b>12.2.3</b> Standardizing by subtracting the mean and dividing by 2 standard deviations</a></li>
<li class="chapter" data-level="12.2.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#why-scale-by-2-standard-deviations"><i class="fa fa-check"></i><b>12.2.4</b> Why scale by 2 standard deviations?</a></li>
<li class="chapter" data-level="12.2.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#multiplying-each-regression-coefficient-by-2-standard-deviations-of-its-predictor"><i class="fa fa-check"></i><b>12.2.5</b> Multiplying each regression coefficient by 2 standard deviations of its predictor</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#correlation-and-regression-to-the-mean"><i class="fa fa-check"></i><b>12.3</b> Correlation and “regression to the mean”</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#the-principal-component-line-and-the-regression-line"><i class="fa fa-check"></i><b>12.3.1</b> The principal component line and the regression line</a></li>
<li class="chapter" data-level="12.3.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#regression-to-the-mean"><i class="fa fa-check"></i><b>12.3.2</b> Regression to the mean</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#logarithmic-transformations"><i class="fa fa-check"></i><b>12.4</b> Logarithmic transformations</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#earnings-and-height-example"><i class="fa fa-check"></i><b>12.4.1</b> Earnings and height example</a></li>
<li class="chapter" data-level="12.4.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#why-we-use-natural-log-rather-than-log-base-10"><i class="fa fa-check"></i><b>12.4.2</b> Why we use natural log rather than log base 10</a></li>
<li class="chapter" data-level="12.4.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#building-a-regression-model-on-the-log-scale"><i class="fa fa-check"></i><b>12.4.3</b> Building a regression model on the log scale</a></li>
<li class="chapter" data-level="12.4.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#further-difficulties-in-interpretation"><i class="fa fa-check"></i><b>12.4.4</b> Further difficulties in interpretation</a></li>
<li class="chapter" data-level="12.4.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#log-log-model-transforming-the-input-and-outcome-variables"><i class="fa fa-check"></i><b>12.4.5</b> Log-log model: transforming the input and outcome variables</a></li>
<li class="chapter" data-level="12.4.6" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#taking-logarithms-even-when-not-necessary"><i class="fa fa-check"></i><b>12.4.6</b> Taking logarithms even when not necessary</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#other-transformations"><i class="fa fa-check"></i><b>12.5</b> Other transformations</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#square-root-transformations"><i class="fa fa-check"></i><b>12.5.1</b> Square root transformations</a></li>
<li class="chapter" data-level="12.5.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#idiosyncratic-transformations"><i class="fa fa-check"></i><b>12.5.2</b> Idiosyncratic transformations</a></li>
<li class="chapter" data-level="12.5.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-continuous-rather-than-discrete-predictors"><i class="fa fa-check"></i><b>12.5.3</b> Using continuous rather than discrete predictors</a></li>
<li class="chapter" data-level="12.5.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-discrete-rather-than-continuous-predictors"><i class="fa fa-check"></i><b>12.5.4</b> Using discrete rather than continuous predictors</a></li>
<li class="chapter" data-level="12.5.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#index-and-indicator-variables"><i class="fa fa-check"></i><b>12.5.5</b> Index and indicator variables</a></li>
<li class="chapter" data-level="12.5.6" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#indicator-variables-identifiability-and-the-baseline-condition"><i class="fa fa-check"></i><b>12.5.6</b> Indicator variables, identifiability, and the baseline condition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#building-and-comparing-regression-models-for-prediction"><i class="fa fa-check"></i><b>12.6</b> Building and comparing regression models for prediction</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#general-principles"><i class="fa fa-check"></i><b>12.6.1</b> General principles</a></li>
<li class="chapter" data-level="12.6.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#example-predicting-the-yields-of-mesquite-bushes"><i class="fa fa-check"></i><b>12.6.2</b> Example: predicting the yields of mesquite bushes</a></li>
<li class="chapter" data-level="12.6.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-the-jacobian-to-adjust-the-predictive-comparison-after-a-transformation"><i class="fa fa-check"></i><b>12.6.3</b> Using the Jacobian to adjust the predictive comparison after a transformation</a></li>
<li class="chapter" data-level="12.6.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#constructing-a-simpler-model"><i class="fa fa-check"></i><b>12.6.4</b> Constructing a simpler model</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#models-for-regression-coefficients"><i class="fa fa-check"></i><b>12.7</b> Models for regression coefficients</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#other-models-for-regression-coefficients"><i class="fa fa-check"></i><b>12.7.1</b> Other models for regression coefficients</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>13</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="13.1" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-a-single-predictor"><i class="fa fa-check"></i><b>13.1</b> Logistic regression with a single predictor</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#example-modeling-political-preference-given-income"><i class="fa fa-check"></i><b>13.1.1</b> Example: modeling political preference given income</a></li>
<li class="chapter" data-level="13.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#the-logistic-regression-model"><i class="fa fa-check"></i><b>13.1.2</b> The logistic regression model</a></li>
<li class="chapter" data-level="13.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#fitting-the-model-using-stan_glm-and-displaying-uncertainty-in-the-fitted-model"><i class="fa fa-check"></i><b>13.1.3</b> Fitting the model using stan_glm and displaying uncertainty in the fitted model</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="logistic-regression.html"><a href="logistic-regression.html#interpreting-logistic-regression-coefficients-and-the-divide-by-4-rule"><i class="fa fa-check"></i><b>13.2</b> Interpreting logistic regression coefficients and the divide-by-4 rule</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#evaluation-at-and-near-the-mean-of-the-data"><i class="fa fa-check"></i><b>13.2.1</b> Evaluation at and near the mean of the data</a></li>
<li class="chapter" data-level="13.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#the-divide-by-4-rule"><i class="fa fa-check"></i><b>13.2.2</b> The divide-by-4 rule</a></li>
<li class="chapter" data-level="13.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#interpretation-of-coefficients-as-odds-ratios"><i class="fa fa-check"></i><b>13.2.3</b> Interpretation of coefficients as odds ratios</a></li>
<li class="chapter" data-level="13.2.4" data-path="logistic-regression.html"><a href="logistic-regression.html#coefficient-estimates-and-standard-errors"><i class="fa fa-check"></i><b>13.2.4</b> Coefficient estimates and standard errors</a></li>
<li class="chapter" data-level="13.2.5" data-path="logistic-regression.html"><a href="logistic-regression.html#statistical-significance-1"><i class="fa fa-check"></i><b>13.2.5</b> Statistical significance</a></li>
<li class="chapter" data-level="13.2.6" data-path="logistic-regression.html"><a href="logistic-regression.html#displaying-the-results-of-several-logistic-regressions"><i class="fa fa-check"></i><b>13.2.6</b> Displaying the results of several logistic regressions</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="logistic-regression.html"><a href="logistic-regression.html#predictions-and-comparisons"><i class="fa fa-check"></i><b>13.3</b> Predictions and comparisons</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#point-prediction-using-predict-1"><i class="fa fa-check"></i><b>13.3.1</b> Point prediction using <code>predict</code></a></li>
<li class="chapter" data-level="13.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#linear-predictor-with-uncertainty-using-posterior_linpred"><i class="fa fa-check"></i><b>13.3.2</b> Linear predictor with uncertainty using <code>posterior_linpred</code></a></li>
<li class="chapter" data-level="13.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#expected-outcome-with-uncertainty-using-posterior_epred"><i class="fa fa-check"></i><b>13.3.3</b> Expected outcome with uncertainty using <code>posterior_epred</code></a></li>
<li class="chapter" data-level="13.3.4" data-path="logistic-regression.html"><a href="logistic-regression.html#predictive-distribution-for-a-new-observation-using-posterior_predict-1"><i class="fa fa-check"></i><b>13.3.4</b> Predictive distribution for a new observation using <code>posterior_predict</code></a></li>
<li class="chapter" data-level="13.3.5" data-path="logistic-regression.html"><a href="logistic-regression.html#prediction-given-a-range-of-input-values-1"><i class="fa fa-check"></i><b>13.3.5</b> Prediction given a range of input values</a></li>
<li class="chapter" data-level="13.3.6" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-just-an-intercept"><i class="fa fa-check"></i><b>13.3.6</b> Logistic regression with just an intercept</a></li>
<li class="chapter" data-level="13.3.7" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-a-single-binary-predictor"><i class="fa fa-check"></i><b>13.3.7</b> Logistic regression with a single binary predictor</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="logistic-regression.html"><a href="logistic-regression.html#latent-data-formulation"><i class="fa fa-check"></i><b>13.4</b> Latent-data formulation</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#interpretation-of-the-latent-variables"><i class="fa fa-check"></i><b>13.4.1</b> Interpretation of the latent variables</a></li>
<li class="chapter" data-level="13.4.2" data-path="logistic-regression.html"><a href="logistic-regression.html#nonidentifiability-of-the-latent-scale-parameter"><i class="fa fa-check"></i><b>13.4.2</b> Nonidentifiability of the latent scale parameter</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="logistic-regression.html"><a href="logistic-regression.html#maximum-likelihood-and-bayesian-inference-for-logistic-regression"><i class="fa fa-check"></i><b>13.5</b> Maximum likelihood and Bayesian inference for logistic regression</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="logistic-regression.html"><a href="logistic-regression.html#maximum-likelihood-using-iteratively-weighted-least-squares"><i class="fa fa-check"></i><b>13.5.1</b> Maximum likelihood using iteratively weighted least squares</a></li>
<li class="chapter" data-level="13.5.2" data-path="logistic-regression.html"><a href="logistic-regression.html#bayesian-inference-with-a-uniform-prior-distribution"><i class="fa fa-check"></i><b>13.5.2</b> Bayesian inference with a uniform prior distribution</a></li>
<li class="chapter" data-level="13.5.3" data-path="logistic-regression.html"><a href="logistic-regression.html#default-prior-in-stan_glm"><i class="fa fa-check"></i><b>13.5.3</b> Default prior in <code>stan_glm</code></a></li>
<li class="chapter" data-level="13.5.4" data-path="logistic-regression.html"><a href="logistic-regression.html#bayesian-inference-with-some-prior-information"><i class="fa fa-check"></i><b>13.5.4</b> Bayesian inference with some prior information</a></li>
<li class="chapter" data-level="13.5.5" data-path="logistic-regression.html"><a href="logistic-regression.html#comparing-maximum-likelihood-and-bayesian-inference-using-a-simulation-study"><i class="fa fa-check"></i><b>13.5.5</b> Comparing maximum likelihood and Bayesian inference using a simulation study</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="logistic-regression.html"><a href="logistic-regression.html#cross-validation-and-log-score-for-logistic-regression"><i class="fa fa-check"></i><b>13.6</b> Cross validation and log score for logistic regression</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#understanding-the-log-score-for-discrete-predictions"><i class="fa fa-check"></i><b>13.6.1</b> Understanding the log score for discrete predictions</a></li>
<li class="chapter" data-level="13.6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#log-score-for-logistic-regression"><i class="fa fa-check"></i><b>13.6.2</b> Log score for logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>14</b> Simulation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="simulation-1.html"><a href="simulation-1.html#simulation-of-discrete-probability-models-1"><i class="fa fa-check"></i><b>14.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="simulation-1.html"><a href="simulation-1.html#how-many-girls-in-400-births-1"><i class="fa fa-check"></i><b>14.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="14.1.2" data-path="simulation-1.html"><a href="simulation-1.html#accounting-for-twins-1"><i class="fa fa-check"></i><b>14.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="simulation-1.html"><a href="simulation-1.html#simulation-of-continuous-and-mixed-discretecontinuous-models-1"><i class="fa fa-check"></i><b>14.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="simulation-1.html"><a href="simulation-1.html#simulation-in-r-using-custom-made-functions-1"><i class="fa fa-check"></i><b>14.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="simulation-1.html"><a href="simulation-1.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-1"><i class="fa fa-check"></i><b>14.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="14.4" data-path="simulation-1.html"><a href="simulation-1.html#bootstrapping-to-simulate-a-sampling-distribution-1"><i class="fa fa-check"></i><b>14.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="simulation-1.html"><a href="simulation-1.html#choices-in-defining-the-bootstrap-distribution-1"><i class="fa fa-check"></i><b>14.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="14.4.2" data-path="simulation-1.html"><a href="simulation-1.html#limitations-of-bootstrapping-1"><i class="fa fa-check"></i><b>14.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="simulation-1.html"><a href="simulation-1.html#fake-data-simulation-as-a-way-of-life-1"><i class="fa fa-check"></i><b>14.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>15</b> Simulation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="simulation-2.html"><a href="simulation-2.html#simulation-of-discrete-probability-models-2"><i class="fa fa-check"></i><b>15.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="simulation-2.html"><a href="simulation-2.html#how-many-girls-in-400-births-2"><i class="fa fa-check"></i><b>15.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="15.1.2" data-path="simulation-2.html"><a href="simulation-2.html#accounting-for-twins-2"><i class="fa fa-check"></i><b>15.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="simulation-2.html"><a href="simulation-2.html#simulation-of-continuous-and-mixed-discretecontinuous-models-2"><i class="fa fa-check"></i><b>15.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="simulation-2.html"><a href="simulation-2.html#simulation-in-r-using-custom-made-functions-2"><i class="fa fa-check"></i><b>15.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="simulation-2.html"><a href="simulation-2.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-2"><i class="fa fa-check"></i><b>15.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="15.4" data-path="simulation-2.html"><a href="simulation-2.html#bootstrapping-to-simulate-a-sampling-distribution-2"><i class="fa fa-check"></i><b>15.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="simulation-2.html"><a href="simulation-2.html#choices-in-defining-the-bootstrap-distribution-2"><i class="fa fa-check"></i><b>15.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="15.4.2" data-path="simulation-2.html"><a href="simulation-2.html#limitations-of-bootstrapping-2"><i class="fa fa-check"></i><b>15.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="simulation-2.html"><a href="simulation-2.html#fake-data-simulation-as-a-way-of-life-2"><i class="fa fa-check"></i><b>15.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="simulation-3.html"><a href="simulation-3.html"><i class="fa fa-check"></i><b>16</b> Simulation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="simulation-3.html"><a href="simulation-3.html#simulation-of-discrete-probability-models-3"><i class="fa fa-check"></i><b>16.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="simulation-3.html"><a href="simulation-3.html#how-many-girls-in-400-births-3"><i class="fa fa-check"></i><b>16.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="16.1.2" data-path="simulation-3.html"><a href="simulation-3.html#accounting-for-twins-3"><i class="fa fa-check"></i><b>16.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="simulation-3.html"><a href="simulation-3.html#simulation-of-continuous-and-mixed-discretecontinuous-models-3"><i class="fa fa-check"></i><b>16.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="simulation-3.html"><a href="simulation-3.html#simulation-in-r-using-custom-made-functions-3"><i class="fa fa-check"></i><b>16.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="simulation-3.html"><a href="simulation-3.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-3"><i class="fa fa-check"></i><b>16.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="16.4" data-path="simulation-3.html"><a href="simulation-3.html#bootstrapping-to-simulate-a-sampling-distribution-3"><i class="fa fa-check"></i><b>16.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="simulation-3.html"><a href="simulation-3.html#choices-in-defining-the-bootstrap-distribution-3"><i class="fa fa-check"></i><b>16.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="16.4.2" data-path="simulation-3.html"><a href="simulation-3.html#limitations-of-bootstrapping-3"><i class="fa fa-check"></i><b>16.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="simulation-3.html"><a href="simulation-3.html#fake-data-simulation-as-a-way-of-life-3"><i class="fa fa-check"></i><b>16.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="simulation-4.html"><a href="simulation-4.html"><i class="fa fa-check"></i><b>17</b> Simulation</a>
<ul>
<li class="chapter" data-level="17.1" data-path="simulation-4.html"><a href="simulation-4.html#simulation-of-discrete-probability-models-4"><i class="fa fa-check"></i><b>17.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="simulation-4.html"><a href="simulation-4.html#how-many-girls-in-400-births-4"><i class="fa fa-check"></i><b>17.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="17.1.2" data-path="simulation-4.html"><a href="simulation-4.html#accounting-for-twins-4"><i class="fa fa-check"></i><b>17.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="simulation-4.html"><a href="simulation-4.html#simulation-of-continuous-and-mixed-discretecontinuous-models-4"><i class="fa fa-check"></i><b>17.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="simulation-4.html"><a href="simulation-4.html#simulation-in-r-using-custom-made-functions-4"><i class="fa fa-check"></i><b>17.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="simulation-4.html"><a href="simulation-4.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-4"><i class="fa fa-check"></i><b>17.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="17.4" data-path="simulation-4.html"><a href="simulation-4.html#bootstrapping-to-simulate-a-sampling-distribution-4"><i class="fa fa-check"></i><b>17.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="simulation-4.html"><a href="simulation-4.html#choices-in-defining-the-bootstrap-distribution-4"><i class="fa fa-check"></i><b>17.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="17.4.2" data-path="simulation-4.html"><a href="simulation-4.html#limitations-of-bootstrapping-4"><i class="fa fa-check"></i><b>17.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="simulation-4.html"><a href="simulation-4.html#fake-data-simulation-as-a-way-of-life-4"><i class="fa fa-check"></i><b>17.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="simulation-5.html"><a href="simulation-5.html"><i class="fa fa-check"></i><b>18</b> Simulation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="simulation-5.html"><a href="simulation-5.html#simulation-of-discrete-probability-models-5"><i class="fa fa-check"></i><b>18.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="simulation-5.html"><a href="simulation-5.html#how-many-girls-in-400-births-5"><i class="fa fa-check"></i><b>18.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="18.1.2" data-path="simulation-5.html"><a href="simulation-5.html#accounting-for-twins-5"><i class="fa fa-check"></i><b>18.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="simulation-5.html"><a href="simulation-5.html#simulation-of-continuous-and-mixed-discretecontinuous-models-5"><i class="fa fa-check"></i><b>18.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="simulation-5.html"><a href="simulation-5.html#simulation-in-r-using-custom-made-functions-5"><i class="fa fa-check"></i><b>18.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="simulation-5.html"><a href="simulation-5.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-5"><i class="fa fa-check"></i><b>18.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="18.4" data-path="simulation-5.html"><a href="simulation-5.html#bootstrapping-to-simulate-a-sampling-distribution-5"><i class="fa fa-check"></i><b>18.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="simulation-5.html"><a href="simulation-5.html#choices-in-defining-the-bootstrap-distribution-5"><i class="fa fa-check"></i><b>18.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="18.4.2" data-path="simulation-5.html"><a href="simulation-5.html#limitations-of-bootstrapping-5"><i class="fa fa-check"></i><b>18.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="simulation-5.html"><a href="simulation-5.html#fake-data-simulation-as-a-way-of-life-5"><i class="fa fa-check"></i><b>18.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="simulation-6.html"><a href="simulation-6.html"><i class="fa fa-check"></i><b>19</b> Simulation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="simulation-6.html"><a href="simulation-6.html#simulation-of-discrete-probability-models-6"><i class="fa fa-check"></i><b>19.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="simulation-6.html"><a href="simulation-6.html#how-many-girls-in-400-births-6"><i class="fa fa-check"></i><b>19.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="19.1.2" data-path="simulation-6.html"><a href="simulation-6.html#accounting-for-twins-6"><i class="fa fa-check"></i><b>19.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="simulation-6.html"><a href="simulation-6.html#simulation-of-continuous-and-mixed-discretecontinuous-models-6"><i class="fa fa-check"></i><b>19.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="simulation-6.html"><a href="simulation-6.html#simulation-in-r-using-custom-made-functions-6"><i class="fa fa-check"></i><b>19.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="simulation-6.html"><a href="simulation-6.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-6"><i class="fa fa-check"></i><b>19.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="19.4" data-path="simulation-6.html"><a href="simulation-6.html#bootstrapping-to-simulate-a-sampling-distribution-6"><i class="fa fa-check"></i><b>19.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="simulation-6.html"><a href="simulation-6.html#choices-in-defining-the-bootstrap-distribution-6"><i class="fa fa-check"></i><b>19.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="19.4.2" data-path="simulation-6.html"><a href="simulation-6.html#limitations-of-bootstrapping-6"><i class="fa fa-check"></i><b>19.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="simulation-6.html"><a href="simulation-6.html#fake-data-simulation-as-a-way-of-life-6"><i class="fa fa-check"></i><b>19.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simulation-7.html"><a href="simulation-7.html"><i class="fa fa-check"></i><b>20</b> Simulation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="simulation-7.html"><a href="simulation-7.html#simulation-of-discrete-probability-models-7"><i class="fa fa-check"></i><b>20.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="simulation-7.html"><a href="simulation-7.html#how-many-girls-in-400-births-7"><i class="fa fa-check"></i><b>20.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="20.1.2" data-path="simulation-7.html"><a href="simulation-7.html#accounting-for-twins-7"><i class="fa fa-check"></i><b>20.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="simulation-7.html"><a href="simulation-7.html#simulation-of-continuous-and-mixed-discretecontinuous-models-7"><i class="fa fa-check"></i><b>20.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="simulation-7.html"><a href="simulation-7.html#simulation-in-r-using-custom-made-functions-7"><i class="fa fa-check"></i><b>20.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="simulation-7.html"><a href="simulation-7.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-7"><i class="fa fa-check"></i><b>20.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="20.4" data-path="simulation-7.html"><a href="simulation-7.html#bootstrapping-to-simulate-a-sampling-distribution-7"><i class="fa fa-check"></i><b>20.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="simulation-7.html"><a href="simulation-7.html#choices-in-defining-the-bootstrap-distribution-7"><i class="fa fa-check"></i><b>20.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="20.4.2" data-path="simulation-7.html"><a href="simulation-7.html#limitations-of-bootstrapping-7"><i class="fa fa-check"></i><b>20.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="simulation-7.html"><a href="simulation-7.html#fake-data-simulation-as-a-way-of-life-7"><i class="fa fa-check"></i><b>20.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="simulation-8.html"><a href="simulation-8.html"><i class="fa fa-check"></i><b>21</b> Simulation</a>
<ul>
<li class="chapter" data-level="21.1" data-path="simulation-8.html"><a href="simulation-8.html#simulation-of-discrete-probability-models-8"><i class="fa fa-check"></i><b>21.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="simulation-8.html"><a href="simulation-8.html#how-many-girls-in-400-births-8"><i class="fa fa-check"></i><b>21.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="21.1.2" data-path="simulation-8.html"><a href="simulation-8.html#accounting-for-twins-8"><i class="fa fa-check"></i><b>21.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="simulation-8.html"><a href="simulation-8.html#simulation-of-continuous-and-mixed-discretecontinuous-models-8"><i class="fa fa-check"></i><b>21.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="simulation-8.html"><a href="simulation-8.html#simulation-in-r-using-custom-made-functions-8"><i class="fa fa-check"></i><b>21.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="simulation-8.html"><a href="simulation-8.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-8"><i class="fa fa-check"></i><b>21.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="21.4" data-path="simulation-8.html"><a href="simulation-8.html#bootstrapping-to-simulate-a-sampling-distribution-8"><i class="fa fa-check"></i><b>21.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="simulation-8.html"><a href="simulation-8.html#choices-in-defining-the-bootstrap-distribution-8"><i class="fa fa-check"></i><b>21.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="21.4.2" data-path="simulation-8.html"><a href="simulation-8.html#limitations-of-bootstrapping-8"><i class="fa fa-check"></i><b>21.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="simulation-8.html"><a href="simulation-8.html#fake-data-simulation-as-a-way-of-life-8"><i class="fa fa-check"></i><b>21.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="simulation-9.html"><a href="simulation-9.html"><i class="fa fa-check"></i><b>22</b> Simulation</a>
<ul>
<li class="chapter" data-level="22.1" data-path="simulation-9.html"><a href="simulation-9.html#simulation-of-discrete-probability-models-9"><i class="fa fa-check"></i><b>22.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="simulation-9.html"><a href="simulation-9.html#how-many-girls-in-400-births-9"><i class="fa fa-check"></i><b>22.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="22.1.2" data-path="simulation-9.html"><a href="simulation-9.html#accounting-for-twins-9"><i class="fa fa-check"></i><b>22.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="simulation-9.html"><a href="simulation-9.html#simulation-of-continuous-and-mixed-discretecontinuous-models-9"><i class="fa fa-check"></i><b>22.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="simulation-9.html"><a href="simulation-9.html#simulation-in-r-using-custom-made-functions-9"><i class="fa fa-check"></i><b>22.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="simulation-9.html"><a href="simulation-9.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-9"><i class="fa fa-check"></i><b>22.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="22.4" data-path="simulation-9.html"><a href="simulation-9.html#bootstrapping-to-simulate-a-sampling-distribution-9"><i class="fa fa-check"></i><b>22.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="simulation-9.html"><a href="simulation-9.html#choices-in-defining-the-bootstrap-distribution-9"><i class="fa fa-check"></i><b>22.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="22.4.2" data-path="simulation-9.html"><a href="simulation-9.html#limitations-of-bootstrapping-9"><i class="fa fa-check"></i><b>22.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="simulation-9.html"><a href="simulation-9.html#fake-data-simulation-as-a-way-of-life-9"><i class="fa fa-check"></i><b>22.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html"><i class="fa fa-check"></i><b>23</b> Exercises of Regression and Other Stories</a>
<ul>
<li class="chapter" data-level="23.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#overview-1"><i class="fa fa-check"></i><b>23.1</b> Overview</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#from-design-to-decision"><i class="fa fa-check"></i><b>23.1.1</b> From design to decision</a></li>
<li class="chapter" data-level="23.1.2" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#sketching-a-regression-model-and-data"><i class="fa fa-check"></i><b>23.1.2</b> Sketching a regression model and data</a></li>
<li class="chapter" data-level="23.1.3" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#goals-of-regression"><i class="fa fa-check"></i><b>23.1.3</b> Goals of regression</a></li>
<li class="chapter" data-level="23.1.4" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#problems-of-statistics"><i class="fa fa-check"></i><b>23.1.4</b> Problems of statistics</a></li>
<li class="chapter" data-level="23.1.5" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#goals-of-regression-1"><i class="fa fa-check"></i><b>23.1.5</b> Goals of regression</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#causal-inference-1"><i class="fa fa-check"></i><b>23.2</b> Causal inference</a></li>
<li class="chapter" data-level="23.3" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#statistics-as-generalization"><i class="fa fa-check"></i><b>23.3</b> Statistics as generalization</a></li>
<li class="chapter" data-level="23.4" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#statistics-as-generalization-1"><i class="fa fa-check"></i><b>23.4</b> Statistics as generalization</a></li>
<li class="chapter" data-level="23.5" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#a-problem-with-linear-models"><i class="fa fa-check"></i><b>23.5</b> A problem with linear models</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#working-through-your-own-example"><i class="fa fa-check"></i><b>23.5.1</b> Working through your own example</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#some-basic-methods-in-mathematics-and-probability-1"><i class="fa fa-check"></i><b>23.6</b> Some basic methods in mathematics and probability</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#weighted-averages-2"><i class="fa fa-check"></i><b>23.6.1</b> Weighted averages</a></li>
<li class="chapter" data-level="23.6.2" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#weighted-averages-3"><i class="fa fa-check"></i><b>23.6.2</b> Weighted averages</a></li>
<li class="chapter" data-level="23.6.3" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#probability-distributions-1"><i class="fa fa-check"></i><b>23.6.3</b> Probability distributions</a></li>
<li class="chapter" data-level="23.6.4" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#probability-distributions-2"><i class="fa fa-check"></i><b>23.6.4</b> Probability distributions</a></li>
<li class="chapter" data-level="23.6.5" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#probability-distributions-3"><i class="fa fa-check"></i><b>23.6.5</b> Probability distributions</a></li>
<li class="chapter" data-level="23.6.6" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#linear-transformations-3"><i class="fa fa-check"></i><b>23.6.6</b> Linear transformations</a></li>
<li class="chapter" data-level="23.6.7" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#linear-transformations-4"><i class="fa fa-check"></i><b>23.6.7</b> Linear transformations</a></li>
<li class="chapter" data-level="23.6.8" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#correlated-random-variables"><i class="fa fa-check"></i><b>23.6.8</b> Correlated random variables</a></li>
<li class="chapter" data-level="23.6.9" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#comparison-of-distributions"><i class="fa fa-check"></i><b>23.6.9</b> Comparison of distributions</a></li>
<li class="chapter" data-level="23.6.10" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#working-through-your-own-example-1"><i class="fa fa-check"></i><b>23.6.10</b> Working through your own example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reading Notes for Regression and Other Stories</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression-with-multiple-predictors" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Linear regression with multiple predictors</h1>
<p>단순한 모델, <span class="math inline">\(y = a + bx + \text{error}\)</span>로부터 좀 더 일반적인 모델, <span class="math inline">\(y = \beta_0 + \beta_1x_1 + \beta_2x_2 + \cdots + \text{error}\)</span>로 넘어가게 되면, 모델에 어떤 예측변수, <span class="math inline">\(x\)</span>를 포함할 것인가, 계수값에 대한 해석을 어떻게 할 것인가, 그 결과들이 어떻게 상호작용하며 이산성(discreteness)와 비선형성(nonlinearity)을 보여주는 기존 변수로부터 새로운 예측변수를 어떻게 구성할 것인지 등을 고려해야 한다.</p>
<div id="adding-predictors-to-a-model" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Adding predictors to a model</h2>
<p>회귀계수는 통상적으로 여러 개의 예측변수를 해석하는 것이 더 까다롭다. 왜냐하면 주어진 계수값은 어디까지나 모델 내 다른 변수들의 영향력을 고려한 부분적인 결과물이기 때문이다.</p>
<ul>
<li><p>계수 <span class="math inline">\(\beta_k\)</span>는 다른 모든 예측변수들이 동일할 때, 예측변수 <span class="math inline">\(x_k\)</span>의 한 단위 변화가 나타난 두 사람을 비교했을 때의 결과 <span class="math inline">\(y_k\)</span>의 평균 혹은 기대값의 차이라고 할 수 있다.</p></li>
<li><p>성인 미국 여성과 아이들에 대한 설문조사로부터 얻은 데이터를 통해 어머니의 특성들이 조건주어졌을 때, 미취학 아동들의 인지시험성적을 예측하기 위한 일련의 회귀모델들을 적합해본다고 하자.</p></li>
</ul>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="linear-regression-with-multiple-predictors.html#cb164-1" aria-hidden="true" tabindex="-1"></a>file_kids <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/ros-master/KidIQ/data/kidiq.csv&quot;</span>) </span>
<span id="cb164-2"><a href="linear-regression-with-multiple-predictors.html#cb164-2" aria-hidden="true" tabindex="-1"></a>kidiq <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(file_kids)</span></code></pre></div>
<div id="starting-with-a-binary-predictor" class="section level3" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Starting with a binary predictor</h3>
<p>엄마가 고등학교를 졸업했냐 하지 못했냐를 보여주는 더미변수가 주어졌을 때, 아이들의 시험 성적을 모델링해보자.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="linear-regression-with-multiple-predictors.html#cb165-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_hs, </span>
<span id="cb165-2"><a href="linear-regression-with-multiple-predictors.html#cb165-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data=</span>kidiq, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb165-3"><a href="linear-regression-with-multiple-predictors.html#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_1)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      kid_score ~ mom_hs
##  observations: 434
##  predictors:   2
## ------
##             Median MAD_SD
## (Intercept) 77.5    2.1  
## mom_hs      11.8    2.4  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 19.9    0.7  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>위의 코드는 다음과 같이 쓸 수 있다.</p>
<p><span class="math display">\[
\text{kid_score} = 78 + 12 \times \text{mom_hs} + \text{error}.
\]</span></p>
<p>이 모델은 엄마가 고등학교를 졸업한 아이들과 그렇지 않은 아이들 간의 평균 시험 성적의 차이를 보여준다. Figure 10.1은 그 회귀선이 두 집단의 평균을 지나가는지를 보여준다.</p>
<pre><code>## Error in ggplot(., aes(mom_hs, kid_score)): object &#39;kids&#39; not found</code></pre>
</div>
<div id="a-single-continuous-predictor" class="section level3" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> A single continuous predictor</h3>
<p>만약 더미변수가 아니라 연속형 변수, 엄마의 IQ 점수를 예측변수로 모델에 포함하였다면, 이는 다음과 같이 다시 쓸 수 있다.</p>
<p><span class="math display">\[
\text{kid_score} = 26 + 0.6\times \text{mom_iq} + \text{error}.
\]</span></p>
<p>이 모델을 시각화하면 Figure 10.2처럼 나타낼 수 있다. Figure 10.2의 선은 엄마의 IQ 수준의 각 관측치에 따른 아이들의 예측된 인지성적을 보여준다고 이해할 수 있다.</p>
<ul>
<li><p>만약 우리가 엄마의 IQ가 1점 다른 두 집단에서의 아이들의 인지성적 점수의 평균을 비교한다면, 엄마의 IQ가 더 높은 집단의 아이들이 평균적으로 0.6 높은 인지성적 수준을 보여줄 것이다.</p></li>
<li><p>그리고 여기에서 절편-상수항을 이해하려면, 모든 예측변수들이 0인 상황을 가정해야 한다.</p></li>
</ul>
<pre><code>## Error in validate_data(data, if_missing = environment(formula)): object &#39;kids&#39; not found</code></pre>
<pre><code>## Error in coef(fit_2)[[&quot;mom_iq&quot;]]: subscript out of bounds</code></pre>
<pre><code>## Error in ggplot(., aes(mom_iq, kid_score)): object &#39;kids&#39; not found</code></pre>
</div>
<div id="including-both-predictors" class="section level3" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Including both predictors</h3>
<p>이번에는 두 개의 예측변수로 아이의 시험 성적을 예측하는 선형회귀모델을 고려해보자. 이 모델은 다음과 같이 나타낼 수 있다.</p>
<p><span class="math display">\[
\text{kid_score} = 26 + 6.0 \times \text{mom_hs} +  0.6\times \text{mom_iq} +  \text{error}.
\]</span></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="linear-regression-with-multiple-predictors.html#cb171-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_hs <span class="sc">+</span> mom_iq, </span>
<span id="cb171-2"><a href="linear-regression-with-multiple-predictors.html#cb171-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>kidiq, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb171-3"><a href="linear-regression-with-multiple-predictors.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_3)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      kid_score ~ mom_hs + mom_iq
##  observations: 434
##  predictors:   3
## ------
##             Median MAD_SD
## (Intercept) 25.8    5.9  
## mom_hs       5.9    2.3  
## mom_iq       0.6    0.1  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 18.2    0.6  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
<div id="understanding-the-fitted-model-1" class="section level3" number="10.1.4">
<h3><span class="header-section-number">10.1.4</span> Understanding the fitted model</h3>
<pre><code>## Error in ggplot(., aes(mom_iq, kid_score, color = factor(mom_hs))): object &#39;kids&#39; not found</code></pre>
<p>엄마의 IQ 성적이 아이들의 인지시험 성적에 미치는 효과-회귀모델의 기울기는 엄마의 교육 수준에 따라 나뉜 두 집단에 따라 동일하다. 뒤에 이어지는 Section 10.3에서는 두 선의 기울기가 달라질 수 있는 상호작용 모델을 고려해볼 것이다. 일단 여기서 모델을 해석하자면 다음과 같다.</p>
<ul>
<li><p>절편: 만약 아이가 IQ가 0인 엄마를 가지고 있고 또한 그 엄마가 고등학교를 졸업하지 않았다면, 아이의 인지시험 성적은 26점일 것이라고 예측된다.</p>
<ul>
<li>하지만 이 예측은 유용하지 않다. 왜냐하면 현실적으로 쉽게 찾아보기 힘든 경우이기 때문이다.</li>
</ul></li>
<li><p>엄마의 고등학교 졸업에 대한 계수: 동일한 IQ의 엄마를 가졌지만 한 쪽은 고등학교를 졸업, 다른 한 쪽은 졸업하지 않은 두 아이가 있다고 할 때, 모델은 이 두 아이의 인지성적 차이가 6점일 것으로 예측한다.</p></li>
<li><p>엄마의 IQ에 대한 계수: 엄마의 고등학교 졸업 여부가 같을 때, 엄마의 IQ 수준이 1점 차이가 날 때, 아이의 시험 성적은 평균적으로 0.6점 차이가 난다고 예측한다.</p></li>
</ul>
</div>
</div>
<div id="interpreting-regression-coefficients" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Interpreting regression coefficients</h2>
<div id="its-not-always-possible-to-change-one-predictor-while-holding-all-others-constant" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> It’s not always possible to change one predictor while holding all others constant</h3>
<p>우리는 다른 예측변수가 동일한 수준으로 고정되어 있을 때, 한 예측변수의 변화에 따른 개인들의 결과변수를 비교하는 것으로 회귀계수를 해석한다.</p>
</div>
<div id="counterfactual-and-predictive-interpretations" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Counterfactual and predictive interpretations</h3>
<p>다중선형회귀모델에서 어떻게 계수값을 해석할 것인지를 생각해볼 때, 우리는 회귀계수에 대한 해석 방식을 두 가지로 구분한다.</p>
<ul>
<li><p>예측적 해석(predictive interpretation)</p>
<ul>
<li><p>다른 모든 예측변수들이 동일할 때, 특정 예측변수의 한 단위 변화가 서로 다른 두 집단의 결과변수에 있어서 평균적으로 어떠한 차이를 가져오는지에 초점을 맞추어 해석한다.</p></li>
<li><p>선형모델에서 계수값은 두 관측치에 있어서 <span class="math inline">\(y\)</span>의 기대값의 차이라고 이해할 수 있다.</p></li>
</ul></li>
<li><p>반사실적 해석(counterfactual interpretation)</p>
<ul>
<li><p>개인들 간의 비교라기보다는 개인들 내의 변화로 이해할 수 있다.</p></li>
<li><p>모델에서 다른 예측변수들이 변화하지 않을 때, 한 예측변수의 한 단위 변화가 <span class="math inline">\(y\)</span>에 가져오는 기대값의 변화로 이해하는 것이다.</p></li>
</ul></li>
<li><p>하지만 명확하게 말하면 데이터만 가지고는 회귀모델은 오직 단위 간의 비교만을 말할 수 있을 뿐, 단위 내의 변화에 대해서는 구분할 수 없다.</p>
<ul>
<li>따라서 비교의 맥락에서 회귀계수를 해석하는 것이 더 안전한 방법이라고 할 수 있다.</li>
</ul></li>
</ul>
</div>
</div>
<div id="interactions" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Interactions</h2>
<p>앞서서는 엄마의 IQ 점수와 고등학교 졸업 유무가 서로 독립적으로 아이의 시험성적에 영향을 미치는 것으로 모델링되었다면, 이번에는 그 둘이 서로 상호작용하는, 그래서 기울기가 실질적으로 다르게 나타나는 경우를 살펴본다: <code>mom_hs</code>와 <code>mom_iq</code> 간의 상호작용항을 포함하는 것이다.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="linear-regression-with-multiple-predictors.html#cb174-1" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_hs <span class="sc">+</span> mom_iq <span class="sc">+</span> </span>
<span id="cb174-2"><a href="linear-regression-with-multiple-predictors.html#cb174-2" aria-hidden="true" tabindex="-1"></a>                    mom_hs<span class="sc">:</span>mom_iq, <span class="at">data=</span>kidiq,</span>
<span id="cb174-3"><a href="linear-regression-with-multiple-predictors.html#cb174-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb174-4"><a href="linear-regression-with-multiple-predictors.html#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_4)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      kid_score ~ mom_hs + mom_iq + mom_hs:mom_iq
##  observations: 434
##  predictors:   4
## ------
##               Median MAD_SD
## (Intercept)   -10.3   13.8 
## mom_hs         49.5   15.5 
## mom_iq          1.0    0.2 
## mom_hs:mom_iq  -0.5    0.2 
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 18.0    0.6  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>이러한 상호작용을 포함한 모델은 주효과(main effects)와 그 상호작용 효과, <code>mom_hs:mom_iq</code>을 포함하고, 다음과 같이 나타낼 수 있다.</p>
<p><span class="math display">\[
\text{kid_score} = −11 + 51 \times \text{mom_hs} + 1.1 \times \text{mom_iq} − 0.5 \times \text{mom_hs}\times \text{mom_iq} + \text{error},
\]</span></p>
<p>Figure 10.4a와 같이 엄마의 교육 수준에 따라 정의되는 하위 집단으로 회귀선을 각기 추정할 수 있다. 한편 Figure 10.4b는 절편을 보여주는 <span class="math inline">\(x\)</span> 축이 0까지 확장된 그래프이다.</p>
<pre><code>## Error in ggplot(., aes(mom_iq, kid_score, color = factor(mom_hs))): object &#39;kids&#39; not found</code></pre>
<pre><code>## Error in ggplot(., aes(mom_iq, kid_score, color = factor(mom_hs))): object &#39;kids&#39; not found</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;fig10.4a&#39; not found</code></pre>
<p>상호작용 모델의 경우에는 계수값 해석에 주의를 기울여야 한다. 특정한 하부집단 내/간(within/across) 평균 또는 예측된 시험 성적을 분석함으로써 우리는 적합한 모델로부터 함의를 이끌어낼 수 있다.</p>
<ul>
<li><p>절편: 엄마가 고등학교를 마치지 못했거나 IQ가 0인, 현실적으로 의미없는 시나리오의 경우에 아이들의 예측된 시험 성적을 보여준다.</p></li>
<li><p><code>mom_hs</code>에 대한 계수: 엄마가 고등학교를 마치지 못했고 IQ가 0인 엄마를 가진 아이들과 고등학교는 마쳤지만 IQ 수준이 0인 엄마를 가진 아이들 간 인지시험 성적의 예측값의 차이라고 할 수 있다.</p>
<ul>
<li>보통 IQ 수준이 0인 경우를 상정할 수 없기 때문에 쉽게 해석하기는 어렵다.</li>
</ul></li>
<li><p><code>mom_iq</code>에 대한 계수: 엄마가 고등학교를 마치지 못했던 아이와 고등학교를 마친 엄마를 가진 아이 간에 IQ 성적 1점 차이가 아이의 인지시험 성적 평균의 차이에 있어서 얼마만큼의 변화를 가지고 오는지를 보여준다.</p></li>
<li><p>상호작용항에 대한 계수: 엄마가 고등학교를 마치거나 마치지 못한 아이들 간의 <code>mon_iq</code>에 대한 기울기의 차이를 보여준다.</p>
<ul>
<li>즉, Figure 10.4에서 두 기울기의 차이를 의미한다.</li>
</ul></li>
</ul>
<p>고등학교를 마친 엄마와 그렇지 못한 엄마를 가진 아이들 각각에 대해 별도의 회귀선을 수식으로 살펴보면 다음과 같다.</p>
<p><span class="math display">\[
\begin{aligned}
\text{mom_has = 0}:\:\text{kid_score}&amp;=-11+51\times0+1.1\times\text{mom_iq}-0.5\times0\times\text{mom_iq}\\
&amp;=-11+1.1\times\text{mom_iq}\\
\text{mom_has = 1}:\:\text{kid_score}&amp;=-11+51\times1+1.1\times\text{mom_iq}-0.5\times1\times\text{mom_iq}\\
&amp;=40+0.6\times\text{mom_iq}\\
\end{aligned}
\]</span></p>
<p>고등학교를 마치지 못한 엄마를 가진 아이들에 대한 추정된 기울기 1.1과 고등학교를 마친 엄마를 가진 아이들에 대한 추정된 기울기 0.6은 직접적으로 해석이 가능하다.</p>
<div id="when-should-we-look-for-interactions" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> When should we look for interactions?</h3>
<p>상호작용은 중요할 수 있다. 우리는 대개 상호작용을 포함하지 않았을 때, 예측변수들의 계수갑싱 매우 크게 나타날 경우에 상호작용이 존재할지 탐색한다.</p>
<p>상호작용을 포함하는 것은 모델을 또 다른 데이터의 서브셋을 이용해 적합하는 것과 같다. 여기서 두 가지 접근법이 이따: 서로 구별되는 집단에 대해 별도로 모델을 적합하거나 혹은 전체 표본을 대상으로 상호작용을 고려한 모델을 적합하는 것이다.</p>
</div>
<div id="interpreting-regression-coefficients-in-the-presence-of-interactions" class="section level3" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Interpreting regression coefficients in the presence of interactions</h3>
<p>우리는 각 예측변수들을 평균 혹은 용이한 기준점을 가지고 중심화(centering)함으로써 상호작용항을 가진 모델을 보다 쉽게 해석할 수 있게 된다.</p>
</div>
</div>
<div id="indicator-variables" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Indicator variables</h2>
<p>더미변수가 회귀모델에 포함되어 있을 때의 비교를 한 번 살펴보자. 설문 자료에 바탕을 두고 있을 때, 몸무게와 다른 변수들을 가지고 그 사람의 키를 예측하고자 하는 모델이 있다고 하자. 일단 데이터를 살펴보자.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="linear-regression-with-multiple-predictors.html#cb179-1" aria-hidden="true" tabindex="-1"></a>earnings <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 17
##    height weight  male  earn earnk ethnicity education mother_education
##     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;            &lt;dbl&gt;
##  1     74    210     1 50000    50 White            16               16
##  2     66    125     0 60000    60 White            16               16
##  3     64    126     0 30000    30 White            16               16
##  4     65    200     0 25000    25 White            17               17
##  5     63    110     0 50000    50 Other            16               16
##  6     68    165     0 62000    62 Black            18               18
##  7     63    190     0 51000    51 White            17               17
##  8     64    125     0  9000     9 White            15               15
##  9     62    200     0 29000    29 White            12               12
## 10     73    230     1 32000    32 White            17               17
## # ... with 9 more variables: father_education &lt;dbl&gt;, walk &lt;dbl&gt;, exercise &lt;dbl&gt;,
## #   smokenow &lt;dbl&gt;, tense &lt;dbl&gt;, angry &lt;dbl&gt;, age &lt;dbl&gt;, sex &lt;chr&gt;, c_height &lt;dbl&gt;</code></pre>
<p>일단 몸무게(파운드)로 키(인치)를 예측해보자.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="linear-regression-with-multiple-predictors.html#cb181-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(weight <span class="sc">~</span> height, </span>
<span id="cb181-2"><a href="linear-regression-with-multiple-predictors.html#cb181-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> earnings, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb181-3"><a href="linear-regression-with-multiple-predictors.html#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_1)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      weight ~ height
##  observations: 1789
##  predictors:   2
## ------
##             Median MAD_SD
## (Intercept) -173.4   11.9
## height         5.0    0.2
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 29.0    0.5  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>적합된 회귀선은 다음과 같이 나타낼 수 있다: <span class="math inline">\(\text{weight} = -172.9 + 4.9 \times \text{hegiht}\)</span>.</p>
<ul>
<li><p>키가 1인치 다른 두 사람을 비교했을 때, 그들의 몸무게의 기대된 차이(expected difference)는 4.9 파운드이다.</p></li>
<li><p>키가 0인치 인 사람의 몸무게 예측값은 -172.9 파운드이다. 하지만 큰 의미는 없는 값이다. 왜냐하면 실제로 키가 0인 사람은 없기 때문이다. 따라서 미국 성인의 평균 키가 66인치라고 할 때의 몸무게의 예측값을 구해보자: <span class="math inline">\(-172.9 + 4.9 \times 66\)</span>.</p></li>
</ul>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="linear-regression-with-multiple-predictors.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># one-way</span></span>
<span id="cb183-2"><a href="linear-regression-with-multiple-predictors.html#cb183-2" aria-hidden="true" tabindex="-1"></a>coefs_1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_1)</span>
<span id="cb183-3"><a href="linear-regression-with-multiple-predictors.html#cb183-3" aria-hidden="true" tabindex="-1"></a>predicted_1 <span class="ot">&lt;-</span> coefs_1[<span class="dv">1</span>] <span class="sc">+</span> coefs_1[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">66</span></span>
<span id="cb183-4"><a href="linear-regression-with-multiple-predictors.html#cb183-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-5"><a href="linear-regression-with-multiple-predictors.html#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="co"># another way</span></span>
<span id="cb183-6"><a href="linear-regression-with-multiple-predictors.html#cb183-6" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">height=</span><span class="dv">66</span>)</span>
<span id="cb183-7"><a href="linear-regression-with-multiple-predictors.html#cb183-7" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit_1, <span class="at">newdata=</span>new)</span></code></pre></div>
<p>다음과 같은 결과를 얻을 수 있다.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="linear-regression-with-multiple-predictors.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Predicted weight for a 66-inch-tall person is&quot;</span>,</span>
<span id="cb184-2"><a href="linear-regression-with-multiple-predictors.html#cb184-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(pred)),</span>
<span id="cb184-3"><a href="linear-regression-with-multiple-predictors.html#cb184-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;pounds with a sd of&quot;</span>, <span class="fu">round</span>(<span class="fu">sd</span>(pred)), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Predicted weight for a 66-inch-tall person is 153 pounds with a sd of 29</code></pre>
<div id="centering-a-predictor" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Centering a predictor</h3>
<p>적합된 모델의 더 나은 해석을 위해서 키를 중심화한 변수를 예측변수로 사용해보았다.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="linear-regression-with-multiple-predictors.html#cb186-1" aria-hidden="true" tabindex="-1"></a>earnings<span class="sc">$</span>c_height <span class="ot">&lt;-</span> earnings<span class="sc">$</span>height <span class="sc">-</span> <span class="dv">66</span></span>
<span id="cb186-2"><a href="linear-regression-with-multiple-predictors.html#cb186-2" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(weight <span class="sc">~</span> c_height, </span>
<span id="cb186-3"><a href="linear-regression-with-multiple-predictors.html#cb186-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>earnings, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb186-4"><a href="linear-regression-with-multiple-predictors.html#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_2)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      weight ~ c_height
##  observations: 1789
##  predictors:   2
## ------
##             Median MAD_SD
## (Intercept) 153.3    0.7 
## c_height      5.0    0.2 
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 29.0    0.5  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
<div id="including-a-binary-variable-in-a-regression" class="section level3" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Including a binary variable in a regression</h3>
<p>이번에는 성별에 관한 더미변수를 포함해보자.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="linear-regression-with-multiple-predictors.html#cb188-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(weight <span class="sc">~</span> c_height <span class="sc">+</span> male,</span>
<span id="cb188-2"><a href="linear-regression-with-multiple-predictors.html#cb188-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>earnings, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb188-3"><a href="linear-regression-with-multiple-predictors.html#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_3)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      weight ~ c_height + male
##  observations: 1789
##  predictors:   3
## ------
##             Median MAD_SD
## (Intercept) 149.6    0.9 
## c_height      3.9    0.3 
## male         11.8    2.0 
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 28.7    0.5  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>남성일 경우의 계수값 12.0은 이 데이터에서 동일한 키를 가진 여성에 비교했을 때 남성이 12파운드 더 무거울 것이라고 예측된다는 것과 같은 의미를 가진다. 70인치의 키를 가진 여성의 예측된 몸무게를 컴퓨팅하는 것도 같은 방식으로 할 수 있다.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="linear-regression-with-multiple-predictors.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># one-way</span></span>
<span id="cb190-2"><a href="linear-regression-with-multiple-predictors.html#cb190-2" aria-hidden="true" tabindex="-1"></a>coefs_3 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_3)</span>
<span id="cb190-3"><a href="linear-regression-with-multiple-predictors.html#cb190-3" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> coefs_3[<span class="dv">1</span>] <span class="sc">+</span> coefs_3[<span class="dv">2</span>]<span class="sc">*</span><span class="fl">4.0</span> <span class="sc">+</span> coefs_3[<span class="dv">3</span>]<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb190-4"><a href="linear-regression-with-multiple-predictors.html#cb190-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-5"><a href="linear-regression-with-multiple-predictors.html#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="co"># another way</span></span>
<span id="cb190-6"><a href="linear-regression-with-multiple-predictors.html#cb190-6" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">c_height=</span><span class="fl">4.0</span>, <span class="at">male=</span><span class="dv">0</span>)</span>
<span id="cb190-7"><a href="linear-regression-with-multiple-predictors.html#cb190-7" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit_3, <span class="at">newdata=</span>new)</span></code></pre></div>
<p>그 결과는 다음과 같다:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="linear-regression-with-multiple-predictors.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Predicted weight for a 70-inch-tall woman is&quot;</span>,</span>
<span id="cb191-2"><a href="linear-regression-with-multiple-predictors.html#cb191-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(pred)),</span>
<span id="cb191-3"><a href="linear-regression-with-multiple-predictors.html#cb191-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;pounds with a sd of&quot;</span>, <span class="fu">round</span>(<span class="fu">sd</span>(pred)), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Predicted weight for a 70-inch-tall woman is 166 pounds with a sd of 28</code></pre>
<p>70인치의 남성의 몸무게에 대한 예측값은 <code>mean(posterior_predict(fit_3, newdata = data.frame(c_height = 4.0, male = 1)))</code>로, 177파운드라는 결과이며 같은 키를 가진 여성에 비해 12 파운드 더 무거운 결과이다.</p>
</div>
<div id="using-indicator-variables-for-multiple-levels-of-a-categorical-predictor" class="section level3" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> Using indicator variables for multiple levels of a categorical predictor</h3>
<p>회귀모델에 인종을 포함해보자. 인종은 네 가지 그룹으로 이루어져 있다.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="linear-regression-with-multiple-predictors.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(earnings<span class="sc">$</span>ethnicity) <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Var1
</th>
<th style="text-align:right;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Black
</td>
<td style="text-align:right;">
180
</td>
</tr>
<tr>
<td style="text-align:left;">
Hispanic
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:left;">
Other
</td>
<td style="text-align:right;">
38
</td>
</tr>
<tr>
<td style="text-align:left;">
White
</td>
<td style="text-align:right;">
1494
</td>
</tr>
</tbody>
</table>
<p>우리는 회귀모델에서 인종을 일종의 요인(factor)으로 포함한다.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="linear-regression-with-multiple-predictors.html#cb194-1" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(weight <span class="sc">~</span> c_height <span class="sc">+</span> male <span class="sc">+</span> </span>
<span id="cb194-2"><a href="linear-regression-with-multiple-predictors.html#cb194-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">factor</span>(ethnicity), </span>
<span id="cb194-3"><a href="linear-regression-with-multiple-predictors.html#cb194-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>earnings, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb194-4"><a href="linear-regression-with-multiple-predictors.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_4)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      weight ~ c_height + male + factor(ethnicity)
##  observations: 1789
##  predictors:   6
## ------
##                           Median MAD_SD
## (Intercept)               154.2    2.3 
## c_height                    3.9    0.3 
## male                       12.1    2.0 
## factor(ethnicity)Hispanic  -6.0    3.7 
## factor(ethnicity)Other    -12.1    5.2 
## factor(ethnicity)White     -5.0    2.3 
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 28.6    0.5  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>인종은 모두 네 가지 수준으로 측정되어 있다. 그런데 분석 결과를 보면 3개의 계수값만이 나타난다. 추정되지 않은 집단은 흑인(Blacks)이다. <code>Black</code>은 기준카테고리로 취급되어 다른 변수들의 비교 대상일 뿐이기에 계수가 추정되지 않은 것이다.</p>
<p>따라서 히스패닉에 대한 계수값, -5.9는 동일한 키와 성별을 가진 흑인에 비교할 때, 히스패닉이 몸무게가 평균적으로 5.9파운드 덜 나간다는 것을 의미한다.</p>
</div>
<div id="changing-the-baseline-factor-level" class="section level3" number="10.4.4">
<h3><span class="header-section-number">10.4.4</span> Changing the baseline factor level</h3>
<p>회귀모델의 요인변수는 카테고리 중 어떤 것이든 원하는 것을 기준변수로 삼을 수 있다. R은 알파벳 순서에 따라 기준변수를 삼는다.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="linear-regression-with-multiple-predictors.html#cb196-1" aria-hidden="true" tabindex="-1"></a>earnings<span class="sc">$</span>eth <span class="ot">&lt;-</span> <span class="fu">factor</span>(earnings<span class="sc">$</span>ethnicity,</span>
<span id="cb196-2"><a href="linear-regression-with-multiple-predictors.html#cb196-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;White&quot;</span>, <span class="st">&quot;Black&quot;</span>, </span>
<span id="cb196-3"><a href="linear-regression-with-multiple-predictors.html#cb196-3" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;Hispanic&quot;</span>, <span class="st">&quot;Other&quot;</span>))</span>
<span id="cb196-4"><a href="linear-regression-with-multiple-predictors.html#cb196-4" aria-hidden="true" tabindex="-1"></a>fit_5 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(weight <span class="sc">~</span> c_height <span class="sc">+</span> male <span class="sc">+</span> eth, </span>
<span id="cb196-5"><a href="linear-regression-with-multiple-predictors.html#cb196-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>earnings, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb196-6"><a href="linear-regression-with-multiple-predictors.html#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_5)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      weight ~ c_height + male + eth
##  observations: 1789
##  predictors:   6
## ------
##             Median MAD_SD
## (Intercept) 149.1    1.0 
## c_height      3.8    0.3 
## male         12.1    2.0 
## ethBlack      5.2    2.2 
## ethHispanic  -0.9    2.9 
## ethOther     -7.1    4.7 
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 28.6    0.5  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>변수의 순서를 조정하면 <code>White</code>가 기준 카테고리가 된다.</p>
<ul>
<li><p>절편값 154.1은 <code>c_height = 0, male = 0, ethnicity = Black</code>인 사람에 대한 예측된 몸무게라고 할 수 있다. 기준변수를 바꾸었을 경우의 절편 149.1은 <code>c_height = 0, male = 0, ethnicity = White</code>인 사람의 예측된 몸무게이다.</p></li>
<li><p><code>height</code>와 <code>male</code>에 대한 계수는 변하지 않는다.</p></li>
<li><p>요인변수에서의 각 카테고리의 계수값은 기준카테고리가 어떻게 되느냐에 따라 달라진다.</p></li>
</ul>
<p>한편, 인종 집단을 직접적으로 개별 더미변수로 만들어서 분석에 투입할 수도 있다.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="linear-regression-with-multiple-predictors.html#cb198-1" aria-hidden="true" tabindex="-1"></a>earnings<span class="sc">$</span>eth_White <span class="ot">&lt;-</span> </span>
<span id="cb198-2"><a href="linear-regression-with-multiple-predictors.html#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(earnings<span class="sc">$</span>ethnicity<span class="sc">==</span><span class="st">&quot;White&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb198-3"><a href="linear-regression-with-multiple-predictors.html#cb198-3" aria-hidden="true" tabindex="-1"></a>earnings<span class="sc">$</span>eth_Black <span class="ot">&lt;-</span> </span>
<span id="cb198-4"><a href="linear-regression-with-multiple-predictors.html#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(earnings<span class="sc">$</span>ethnicity<span class="sc">==</span><span class="st">&quot;Black&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb198-5"><a href="linear-regression-with-multiple-predictors.html#cb198-5" aria-hidden="true" tabindex="-1"></a>earnings<span class="sc">$</span>eth_Hispanic <span class="ot">&lt;-</span> </span>
<span id="cb198-6"><a href="linear-regression-with-multiple-predictors.html#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(earnings<span class="sc">$</span>ethnicity<span class="sc">==</span><span class="st">&quot;Hispanic&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb198-7"><a href="linear-regression-with-multiple-predictors.html#cb198-7" aria-hidden="true" tabindex="-1"></a>earnings<span class="sc">$</span>eth_Other <span class="ot">&lt;-</span> </span>
<span id="cb198-8"><a href="linear-regression-with-multiple-predictors.html#cb198-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(earnings<span class="sc">$</span>ethnicity<span class="sc">==</span><span class="st">&quot;Other&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code></pre></div>
<p>이 경우, 기준카테고리로 삼을 변수 하나를 제외하고 회귀모델에 포함, 적합하면 된다.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="linear-regression-with-multiple-predictors.html#cb199-1" aria-hidden="true" tabindex="-1"></a>fit_6 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> male <span class="sc">+</span> </span>
<span id="cb199-2"><a href="linear-regression-with-multiple-predictors.html#cb199-2" aria-hidden="true" tabindex="-1"></a>                    eth_Black <span class="sc">+</span> eth_Hispanic <span class="sc">+</span></span>
<span id="cb199-3"><a href="linear-regression-with-multiple-predictors.html#cb199-3" aria-hidden="true" tabindex="-1"></a>                    eth_Other, <span class="at">data=</span>earnings,</span>
<span id="cb199-4"><a href="linear-regression-with-multiple-predictors.html#cb199-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb199-5"><a href="linear-regression-with-multiple-predictors.html#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_6)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      weight ~ height + male + eth_Black + eth_Hispanic + eth_Other
##  observations: 1789
##  predictors:   6
## ------
##              Median MAD_SD
## (Intercept)  -105.2   16.8
## height          3.9    0.3
## male           12.1    2.0
## eth_Black       5.2    2.3
## eth_Hispanic   -0.9    2.9
## eth_Other      -7.1    5.1
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 28.6    0.5  
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
<div id="using-an-index-variable-to-access-a-group-level-predictor" class="section level3" number="10.4.5">
<h3><span class="header-section-number">10.4.5</span> Using an index variable to access a group-level predictor</h3>
<p>때로 우리는 집단 수준에서의 예측변수를 가지고 개인 수준에서 회귀모델을 적합하기도 한다.</p>
<ul>
<li>예를 들면, 학생들의 시험 성적을 개별 학생들의 개인적 배경에 해당하는 변수들, 그리고 그 학생들이 속한 학교의 학부모 평균 소득 수준 등으로 예측하고자 하는 것과 비슷하다.</li>
</ul>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="linear-regression-with-multiple-predictors.html#cb201-1" aria-hidden="true" tabindex="-1"></a>school_income <span class="ot">&lt;-</span> income[school]</span>
<span id="cb201-2"><a href="linear-regression-with-multiple-predictors.html#cb201-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-3"><a href="linear-regression-with-multiple-predictors.html#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stan_glm</span>(score <span class="sc">~</span> pretest <span class="sc">+</span> age <span class="sc">+</span> male <span class="sc">+</span> school_income,</span>
<span id="cb201-4"><a href="linear-regression-with-multiple-predictors.html#cb201-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">data=</span>students)</span></code></pre></div>
</div>
</div>
<div id="formulating-paired-or-blocked-designs-as-a-regression-problem" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Formulating paired or blocked designs as a regression problem</h2>
<p>이제까지 계속해서 회귀계수를 비교로 해석할 수도 있다고 설명해왔다. 이 말은 즉, 회귀분석을 비교로 표현하는 것이 유용하다는 것이다.</p>
<div id="completely-randomized-experiment" class="section level3" number="10.5.1">
<h3><span class="header-section-number">10.5.1</span> Completely randomized experiment</h3>
<p><span class="math inline">\(n\)</span> 명의 사람들이 무작위로 처치집단과 통제집단에 배정되었다는 단순한 실험을 생각해보자. 그리고 각 집단에는 <span class="math inline">\(n/2\)</span>명 씩 속해 있다. 처치효과에 대한 추정량은 <span class="math inline">\(\bar y_T-\bar y_C\)</span>이며, 이때의 표준오차는 <span class="math inline">\(\sqrt{\text{sd}^2_T/(n/2) + \text{sd}^2_C/(n/2)}\)</span>이다.</p>
<p>집단 더미변수를 예측변수로 사용해서 회귀분석의 틀로 추론을 표현할 수 있다: 계수에 대한 최소자승법을 통한 추정량은 단순하게 차이, <span class="math inline">\(\bar y_T-\bar y_C\)</span>라고 할 수 있고, 표준오차는 평균차(difference-in-means)로부터 얻을 수 있는 값에 가깝다. 이때, 표준오차는 분산 추정량이 전체 집단을 대상으로 하느냐에 따라서 약간 차이가 있을 수 있다.</p>
<p>매우 단순한 처치-전 예측변수들의 사례에서는 회귀모델을 통한 추론이나 실험설계를 바탕으로 한 평균차에서 도출한 추론이나 크게 다르지 않다. 하지만 회귀분석은 보다 복잡한 조건들을 일반화하는 데 장점이 있다.</p>
</div>
<div id="paired-design" class="section level3" number="10.5.2">
<h3><span class="header-section-number">10.5.2</span> Paired design</h3>
<p><span class="math inline">\(n\)</span>명의 사람들이 짝지어져 있고, 각 짝마다 두 명의 사람들이 무작위로 처치와 통제집단에 배속된다고 생각해보자. 각 짝에서의 차이를 컴퓨팅하고 이를 <span class="math inline">\(z_i,\:i = 1,\dots,n/2\)</span>라고 할 때, 처치효과는 <span class="math inline">\(\bar z\)</span>로, 표준오차는 <span class="math inline">\(\text{sd}(z)/\sqrt{n/2}\)</span>이다.</p>
<p>짝을 설계한 데이터는 회귀모델을 통해 분석될 수 있다. 모든 <span class="math inline">\(n\)</span> 개의 데이터에 대해 처치집단 여부를 나타내는 더미변수와 짝을 나타내는 더미변수를 포함하는 모델을 적합함으로써 우리는 보다 복잡한 모델을 추정할 수 있다.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="linear-regression-with-multiple-predictors.html#cb202-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(y <span class="sc">~</span> treatment <span class="sc">+</span> </span>
<span id="cb202-2"><a href="linear-regression-with-multiple-predictors.html#cb202-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">factor</span>(pairs), </span>
<span id="cb202-3"><a href="linear-regression-with-multiple-predictors.html#cb202-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>expt, <span class="at">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<p>이때, <code>factor()</code> 함수를 사용해서 회귀모델에서 <span class="math inline">\(n/2\)</span>개의 더미변수를 만들어낸다. 따라서 회귀모델은 <span class="math inline">\((n/2) + 1\)</span>개의 예측변수를 갖는다: 상수항, 처치더미(treatment indicator), 그리고 <span class="math inline">\((n/2)-1\)</span>의 짝 집단을 보여주는 카테고리 변수.</p>
</div>
<div id="block-design" class="section level3" number="10.5.3">
<h3><span class="header-section-number">10.5.3</span> Block design</h3>
<p>일반적인 원칙은 결과변수를 예측하는 데 적절할 수 있는 사전 처치 정보는 가능한한 다 포함하는 것이다.</p>
<ul>
<li><p><span class="math inline">\(n\)</span>명의 사람들이 <span class="math inline">\(J\)</span>개의 집단에 속해있고, 각 집단마다 있는 처치집단과 통제집단에 무작위 배정하는 블록 설계를 생각해보자.</p></li>
<li><p>우리는 기준카테고리가 되는 집단을 제외한 <span class="math inline">\(J-1\)</span>개 집단에 대한 카테고리 변수에 처치더미에 바탕을 두고 결과변수를 예측하는 회귀모델을 적합할 수 있다.</p></li>
<li><p>처치효과를 추정하기 위해서는 어떠한 집단을 기준집단으로 삼느냐는 중요하지 않다. 만약 다른 사전 처치 변수들이 가용하다면, 회귀모델에 가능한 추가적인 예측변수들을 포함하여 추정하는 것이 바람직하다.</p></li>
</ul>
</div>
</div>
<div id="example-uncertainty-in-predicting-congressional-elections" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> Example: uncertainty in predicting congressional elections</h2>
<p>미 의회에 대한 선거 모델의 맥락에서 시뮬레이션에 기초한 예측값들을 설명해보자. 먼저 1986 선거로부터 1988 선거 결과를 예측하는 모델을 구축하고 1988년 선거로부터 1990년 선거를 예측하는 것에 적용해보자. 그리고 실제 1990년 선거 결과와 예측값을 확인해보자.</p>
<div id="background" class="section level3" number="10.6.1">
<h3><span class="header-section-number">10.6.1</span> Background</h3>
<p>미국은 435개 지역구로 나뉘어 있고, 결과변수 <span class="math inline">\(y_i, \: i = 1, \dots, n = 435\)</span>는 1988년 지역구 <span class="math inline">\(i\)</span>에서의 두 정당의 득표 대비 민주당의 정당득표율을 보여준다. Figure 10.5는 데이터 <span class="math inline">\(y\)</span>에 대한 히스토그램을 보여준다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-399"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-399-1.png" alt="Histogram of congressional election data from 1988. The spikes at the left and right ends represent uncontested Republicans and Democrats, respectively." width="480" />
<p class="caption">
Figure 10.1: Histogram of congressional election data from 1988. The spikes at the left and right ends represent uncontested Republicans and Democrats, respectively.
</p>
</div>
<p>데이터의 변동성은 어떻게 이해할 수 있을까? 하원 선거 결과를 예측하는 데 적절한 정보로는 무엇이 있을까? 다음의 예측변수를 포함한 회귀모델을 수립해보자:</p>
<ul>
<li><p>상수항(constant term)</p></li>
<li><p>이전 선거에서 지역구 <span class="math inline">\(i\)</span>의 두 정당 득표에 대한 민주당의 득표율</p></li>
<li><p>현직-재선(incumbency): 지역구 <span class="math inline">\(i\)</span>가 1988년에 민주당 의원의 것이었고, 그가 재선거에 출마한 것이라면 +1로 코딩, 재선거에 공화당 의원이 출마했다면 -1로 코딩, 만약 누가 출마할 지 모르는 상황이라면 0으로 코딩한다. 즉, 1988년 당시에 해당 의석이 재선거 의석이 아닌 경우를 의미한다.</p></li>
</ul>
<p>현직-재선 예측변수는 카테고리칼이다. 따라서 우리는 하나의 산포도에 민주당 현직자와 공화당 현직자, 둘 모두가 다 아닌 경를 각각 다르게 마킹해서 산포도로 그릴 수 있다. Figure 10.6a가 바로 그것이다.</p>
<p>선형회귀모델을 적합한다고 할 때, 이 변수는 이산형 변수이지만 각 지역구에서의 득표율은 연속형 변수이다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-400"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-400-1.png" alt="(a) Congressional election data from 1986 and 1988. Crosses correspond to elections with Republican incumbents running in 1988, dots correspond to Democratic incumbents, and open circles correspond to open seats. The “incumbency” predictor in the regression model equals 0 for the circles, +1 for the dots, and &lt;U+2212&gt;1 for the crosses. Uncontested election outcomes (at 0 and 1) have been jittered slightly. (b) Data for the regression analysis, with uncontested 1988 elections removed and uncontested 1986 election values replaced by 0.25 and 0.75. The $y = x$ line is included as a comparison on both plots." width="960" />
<p class="caption">
Figure 10.2: (a) Congressional election data from 1986 and 1988. Crosses correspond to elections with Republican incumbents running in 1988, dots correspond to Democratic incumbents, and open circles correspond to open seats. The “incumbency” predictor in the regression model equals 0 for the circles, +1 for the dots, and &lt;U+2212&gt;1 for the crosses. Uncontested election outcomes (at 0 and 1) have been jittered slightly. (b) Data for the regression analysis, with uncontested 1988 elections removed and uncontested 1986 election values replaced by 0.25 and 0.75. The <span class="math inline">\(y = x\)</span> line is included as a comparison on both plots.
</p>
</div>
</div>
<div id="data-issues" class="section level3" number="10.6.2">
<h3><span class="header-section-number">10.6.2</span> Data issues</h3>
<p>이전 선거 결과와 재선거에 출마한 현직의원인지 여부를 조건으로 지역구 단위로 결과를 예측해보았다. 이때, 많은 선거들이 비교하고자 하는 두 해 각각에 있어서 경합지역이 아닌 경우가 있다. 즉, 득표율이 0 또는 1로 나타나게 되는 것이다. 하지만 0과 1이 아니라 공화당이 비경합적인 지역에 0.25, 민주당의 비경합적 지역에 0.75라는 값으로 대체한다면, 우리는 약 선거에에서 마치 실제로 경합한 것과 같이 민주당 후보가 받은 표의 비율을 근사하게 되는 것이다. 보다 일반적으로 우리는 비경합지에 앞서 경합지 선거 결과의 분포로부터 무작위 값들을 대체할 수 있다. 이렇게 조정한 결과가 바로 Figure 10.6b이다.</p>
</div>
<div id="fitting-the-model" class="section level3" number="10.6.3">
<h3><span class="header-section-number">10.6.3</span> Fitting the model</h3>
<p>주어진 <code>past_vote</code>와 <code>incumbency</code>에서 <code>vote</code>를 예측하기 위한 회귀모델을 수립했을 때, 1986년 선거로 1988년 선거를 예측할 때 데이터셋에서 적절한 변수들을 골라보자.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="linear-regression-with-multiple-predictors.html#cb203-1" aria-hidden="true" tabindex="-1"></a>data88 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">vote=</span>congress<span class="sc">$</span>v88_adj,</span>
<span id="cb203-2"><a href="linear-regression-with-multiple-predictors.html#cb203-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">past_vote=</span>congress<span class="sc">$</span>v86_adj,</span>
<span id="cb203-3"><a href="linear-regression-with-multiple-predictors.html#cb203-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">inc=</span>congress<span class="sc">$</span>inc88)</span>
<span id="cb203-4"><a href="linear-regression-with-multiple-predictors.html#cb203-4" aria-hidden="true" tabindex="-1"></a>fit88 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(vote <span class="sc">~</span> past_vote <span class="sc">+</span> inc, </span>
<span id="cb203-5"><a href="linear-regression-with-multiple-predictors.html#cb203-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>data88, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb203-6"><a href="linear-regression-with-multiple-predictors.html#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit88)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      vote ~ past_vote + inc
##  observations: 435
##  predictors:   4
## ------
##               Median MAD_SD
## (Intercept)    0.3    0.0  
## past_vote      0.5    0.0  
## incOpen       -0.1    0.0  
## incRepublican -0.2    0.0  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 0.1    0.0   
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>이 모델에는 약간 문제가 있다. Figure 10.6b의 전후 그래프를 비교해보면, 현직 재선 출마자가 공석인 선거의 경우 대부분이 회귀선에서 빠져나와 있다: 즉, 가능하다면 상호작용항을 포함할 것이 요구된다.</p>
<ul>
<li><p>이는 현직 재선 출마자가 나온 선거구와 공석인 선거구 간의 기울기가 다를 것이라는 것을 의미한다.</p></li>
<li><p>그리고 현직 재선 출마자가 없는 선거구의 비경합적 선거의 투표율의 불확실성을 고려하지 않았다는 문제가 있다.</p></li>
</ul>
<p>그럼에도 불구하고 이 예제는 시뮬레이션에 기초한 예측적 추론의 원칙들을 입증하는 데에는 충분하다.</p>
</div>
<div id="simulation-for-inferences-and-predictions-of-new-data-points" class="section level3" number="10.6.4">
<h3><span class="header-section-number">10.6.4</span> Simulation for inferences and predictions of new data points</h3>
<pre><code>## Error in validate_data(data, if_missing = environment(formula)): object &#39;data_88&#39; not found</code></pre>
<table>
<caption>
<span id="tab:unnamed-chunk-402">Table 10.1: </span>Simulation results for the congressional election forecasting model. The predicted values <span class="math inline">\(\tilde y_i\)</span> correspond to the 1990 election.
</caption>
<thead>
<tr>
<th style="text-align:right;">
<span class="math inline">\(\beta_0\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_1\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_2\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\beta_3\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\sigma\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.22
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
</tbody>
</table>
<p>위의 표는 시뮬레이션된 파라미터를 보여준다. 시뮬레이션을 이용해서 1988년의 데이터와 1990년 현직-재선 출마자에 대한 정보에 따라 1990년 지역구별 선거결과를 예측할 수 있다. 새로운 예측변수, <span class="math inline">\(\tilde X\)</span>를 만들어보자.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="linear-regression-with-multiple-predictors.html#cb206-1" aria-hidden="true" tabindex="-1"></a>data90 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">past_vote=</span>congress<span class="sc">$</span>v88_adj, </span>
<span id="cb206-2"><a href="linear-regression-with-multiple-predictors.html#cb206-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">inc=</span>congress<span class="sc">$</span>inc90)</span></code></pre></div>
<p>새로운 결과의 벡터에 대한 예측 시뮬레이션을 해보자.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="linear-regression-with-multiple-predictors.html#cb207-1" aria-hidden="true" tabindex="-1"></a>pred90 <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit88, <span class="at">newdata=</span>data90)</span></code></pre></div>
</div>
<div id="predictive-simulation-for-a-nonlinear-function-of-new-data" class="section level3" number="10.6.5">
<h3><span class="header-section-number">10.6.5</span> Predictive simulation for a nonlinear function of new data</h3>
<p>1990년에 민주당에 의해 승리한 선거의 수는 <span class="math inline">\(\sum^{\tilde n}_{i=1}I(\tilde y_i &gt; 0.5\)</span>로 나타낼 수 있다.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="linear-regression-with-multiple-predictors.html#cb208-1" aria-hidden="true" tabindex="-1"></a>dems_pred <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(pred90 <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p>각 행은 서로 다른 무작위 시뮬레이션의 결과이다:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="linear-regression-with-multiple-predictors.html#cb209-1" aria-hidden="true" tabindex="-1"></a>dems_pred <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_sims)</span>
<span id="cb209-2"><a href="linear-regression-with-multiple-predictors.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sims) {</span>
<span id="cb209-3"><a href="linear-regression-with-multiple-predictors.html#cb209-3" aria-hidden="true" tabindex="-1"></a>  dems_pred[s] <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred90[s,] <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb209-4"><a href="linear-regression-with-multiple-predictors.html#cb209-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb209-5"><a href="linear-regression-with-multiple-predictors.html#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dems_pred)</span></code></pre></div>
<pre><code>## [1] 260 259 263 258 261 262</code></pre>
</div>
<div id="combining-simulation-and-analytic-calculations" class="section level3" number="10.6.6">
<h3><span class="header-section-number">10.6.6</span> Combining simulation and analytic calculations</h3>
<p>몇몇 조건에 있어서는 수학적 분석을 바탕으로 시뮬레이션에 기초한 추론이 큰 도움이 된다<span class="citation">(<a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>: 144)</span>.</p>
</div>
</div>
<div id="mathematical-notation-and-statistical-inference" class="section level2" number="10.7">
<h2><span class="header-section-number">10.7</span> Mathematical notation and statistical inference</h2>
<p>특정한 예제를 설명할 때, 기술변수 이름을 사용하는 것이 도움이 된다. 하지만 보다 일반적인 이론과 데이터 관리에 대해 논의하기 위해 여기서는 수학적 용어들을 사용하고자 한다<span class="citation">(<a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>: 144)</span>.</p>
<div id="predictors" class="section level3" number="10.7.1">
<h3><span class="header-section-number">10.7.1</span> Predictors</h3>
<p><span class="math inline">\(X\)</span> 행렬에서 열에 대해 예측변수라는 표현을 사용한다. 예를 들어, 엄마의 교육수준과 IQ 수준의 상호작용을 포함한 모델을 생각해보자.</p>
<p><span class="math display">\[
\text{kid_score} = 58 + 16 \times \text{mom_hs} + 0.5 \times \text{mom_iq} − 0.2 \times \text{mom_hs} \times \text{mom_iq} + error.
\]</span></p>
<p>여기서 예측변수는 세 개이다: <span class="math inline">\(\text{mom_hs}\)</span>, <span class="math inline">\(\text{mom_iq}\)</span>, 그리고 <span class="math inline">\(\text{mom_hs} \times \text{mom_iq}\)</span>.</p>
</div>
<div id="regression-in-vector-matrix-notation" class="section level3" number="10.7.2">
<h3><span class="header-section-number">10.7.2</span> Regression in vector-matrix notation</h3>
<p>회귀분석은 벡터-행렬로도 나타낼 수 있다.<span class="math inline">\(y_i\)</span>의 <span class="math inline">\(i^{\text{th}}\)</span> 관측치는 결정주의적 예측으로는 <span class="math inline">\(X_i\beta = \beta_1X_{i1}+\cdots+\beta_kX_{ik}\)</span>로 나타낼 수 있다. 일단 <span class="math inline">\(X_{i1}\)</span>은 상수항으로 절편값을 의미한다.</p>
<p><span class="math inline">\(\epsilon_i\)</span>은 평균 0에 표준편차 <span class="math inline">\(\sigma\)</span>인 정규분포를 따르며, 오차를 의미한다. 즉, <span class="math inline">\(\mathrm{N}(0, \sigma^2)\)</span>로 나타낼 수 있다. 잔차는 실제 관측치와 추정된 예측값 간의 차이를 보여준다: <span class="math inline">\(y - X \hat \beta\)</span>. 주어진 예측변수의 데이터 <span class="math inline">\(\tilde X\)</span>일 때, 모델로부터 얻은 예측값 <span class="math inline">\(\tilde y\)</span>는 Figure 10.7로 확인할 수 있다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-407"></span>
<img src="fig/fig10.png" alt="Notation for regression modeling. The model is fit to the observed outcomes $y$ given predictors $X$. As described in the text, the model can then be applied to predict unobserved outcomes $\tilde y$ (indicated by small question marks), given predictors on new data $\tilde X$." width="410" />
<p class="caption">
Figure 10.3: Notation for regression modeling. The model is fit to the observed outcomes <span class="math inline">\(y\)</span> given predictors <span class="math inline">\(X\)</span>. As described in the text, the model can then be applied to predict unobserved outcomes <span class="math inline">\(\tilde y\)</span> (indicated by small question marks), given predictors on new data <span class="math inline">\(\tilde X\)</span>.
</p>
</div>
</div>
<div id="two-ways-of-writing-the-model" class="section level3" number="10.7.3">
<h3><span class="header-section-number">10.7.3</span> Two ways of writing the model</h3>
<p>전통적인 선형회귀모델은 수학적으로 다음과 같이 쓸 수 있다:</p>
<p><span class="math display">\[
y_i = \beta_1 X_{i1} + \cdots + \beta_k X_{ik} + \epsilon_i
\]</span></p>
<p>이때, 오차는 평균이 0이고 표준편차가 <span class="math inline">\(\sigma\)</span>이며 독립적인 정규분포를 따른다.</p>
<p>행렬을 이용하면,</p>
<p><span class="math display">\[
y_i = X_i\beta + \epsilon_i
\]</span>
로 나타낼 수 있고, 이때 <span class="math inline">\(X\)</span>는 <span class="math inline">\(n\times k\)</span>의 행렬이라고 할 수 있다. 이는 다음과도 동일하다.</p>
<p><span class="math display">\[
y_i \sim \mathrm{N}(X_i\beta, \sigma^2)
\]</span></p>
<p>마지막으로 더 축약하면 다음과 같이 쓸 수 있다.</p>
<p><span class="math display">\[
y \sim \mathrm{N}(X\beta,\sigma^2I).
\]</span>
### Least squares, maximum likelihood, and Bayesian inference</p>
<p>최소자승법을 통한 추정량은 잔차의 제곱합, <span class="math inline">\(\mathrm{RSS}= \sum^n_{i=1}(y_i-X\hat\beta)^2\)</span>를 최소화하는 <span class="math inline">\(\hat \beta\)</span>의 벡터를 구하는 것에서부터 시작한다.</p>
<p>여러 개의 예측변수를 가진 표준 선형회귀모델에서는 오차는 독립적이고 등분산(equal variance)을 가지며 정규적으로 분포되어 있다. 그리고 최소자승의 해(solution)은 이때 최대가능도로 구한 추정량과 같다. OLS와 MLE 결과의 차이는 잔차의 표준편차에 대한 추정일 뿐이다.</p>
<p><span class="math display">\[
\hat \sigma = \sqrt{\mathrm{RSS}/(n-k)}
\]</span></p>
<p>이때, <span class="math inline">\(k\)</span>는 회귀계수의 숫자이다.</p>
</div>
<div id="nonidentified-parameters-collinearity-and-the-likelihood-function" class="section level3" number="10.7.4">
<h3><span class="header-section-number">10.7.4</span> Nonidentified parameters, collinearity, and the likelihood function</h3>
<p>최대가능도에서 가능도를 바꾸지 않으면 파라미터는 바뀔 수 있기 때문에 파라미터는 식별되지 않는다. 즉, 만약 단 하나로만 추정될 수 있는 파라미터를 포함하지 않는다면, 모델은 “식별불가능하다(nonidentifiable).” 이후 챕터에서 본격적으로 다룰 내용이다.</p>
</div>
<div id="hypothesis-testing-why-we-do-not-like-t-tests-and-f-tests" class="section level3" number="10.7.5">
<h3><span class="header-section-number">10.7.5</span> Hypothesis testing: why we do not like <span class="math inline">\(t\)</span> tests and <span class="math inline">\(F\)</span> tests</h3>
<p>간단하게 얘기하면 <span class="math inline">\(t\)</span> 검정은 회귀계수가 0과 유의미하게 통계적으로 다른지를 입증하는 것이며, 명시적으로는 특정한 계수값 <span class="math inline">\(\beta_j\)</span>가 0과 같은지를 의미하는 영가설에 대한 검정을 수행하는 것이다.</p>
<ul>
<li>특정한 가정 하에서 표준화 회귀계수인 <span class="math inline">\(\hat \beta_j/\text{s.e.}_j\)</span>는 <span class="math inline">\(t_{n-k}\)</span> 분포를 따른다.</li>
</ul>
<p><span class="math inline">\(F\)</span> 검정은 회귀모델 전체에 대한 경험적 근거를 입증하는 데 사용된다. 이때의 영가설은 모델 내 상수항을 제외한 모든 회귀계수의 값이 0과 같을 것이라는 진술이다.</p>
<ul>
<li>특정한 가정 하에서 잔차의 제곱합에 대한 전체 변동량의 비율은 <span class="math inline">\(F\)</span> 분포를 따르며, 만약 제곱합의 비율이 어느 수준을 넘으면, 표본 규모 <span class="math inline">\(n\)</span>과 예측변수의 수 <span class="math inline">\(k\)</span>에 따라 영가설은 기각될 수 있다.</li>
</ul>
</div>
</div>
<div id="weighted-regression" class="section level2" number="10.8">
<h2><span class="header-section-number">10.8</span> Weighted regression</h2>
<p>오차가 등분산을 가지고 독립적이고 정규적으로 분포되어 있다고 할 때, 최소자승법을 이용한 회귀모델은 최대가능도 추정법과 같은 결과를 제시한다. 잔차의 제곱합에 있어서 각 항(terms)에는 동일한 가중치가 부여된다.</p>
<p>그러나 몇몇 조건 하에서 모델을 적합할 때, 일부 데이터 관측치에 가중치를 부여해야할 필요가 있다. 이때, 우리는 가중치를 부여한 최소자승법으로 <span class="math inline">\(\hat \beta_{\text{wls}}\)</span>를 추정하고, 이는 <span class="math inline">\(\sum^n_{i=1}w_i(y_i-X_i\beta)^2\)</span>를 최소화하는 결과이며, 이때 가중치 <span class="math inline">\(w = (w_1, \dots, w_n)\)</span>는 음수가 아닌 가중치이다.</p>
<p>OLS처럼 행렬대수를 이용해서 가중치를 부여한 최소제곱 추정량을 다음과 같이 구할 수 있다.</p>
<p><span class="math display">\[
\hat \beta = (X^tW^{-1}X)^{-1}X^tW^{-1}y
\]</span></p>
<p>이때, <span class="math inline">\(W\)</span>는 가중치의 행렬, <span class="math inline">\(W = \text{Diag}(w)\)</span>을 의미한다.</p>
<div id="three-models-leading-to-weighted-regression" class="section level3" number="10.8.1">
<h3><span class="header-section-number">10.8.1</span> Three models leading to weighted regression</h3>
<p>가중치를 부여한 최소자승법은 세 가지의 서로 다른 모델로부터 유도될 수 있다:</p>
<ol style="list-style-type: decimal">
<li>관측된 데이터를 이용해 더 큰 모집단을 대표</li>
</ol>
<ul>
<li><p>회귀모델에 가중치를 부여하는 가장 일반적인 방식.</p></li>
<li><p>전체 모집단에 적합했을 때 얻어지는 가중치가 부여되지 않은(unweighted) 선형모델을 추정하기 위해 표본 데이터에 일정한 가중치를 부여-대표성 있는 표본으로 만들어 적합한 결과</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>중복된 관측치(duplicate observations):</li>
</ol>
<ul>
<li><p>특정한 값이 중복된다는 것은 과대대표된다는 것을 의미.</p></li>
<li><p>제약이 가해진 데이터셋, <span class="math inline">\((x, y, w)\)</span>에 대한 가중치가 부여된 회귀모델은 원데이터에 대한 가중치가 부여되지 않은 회귀분석과 동등하다.</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>이분산(unequal variances)</li>
</ol>
<ul>
<li><p>독립적이고 정규적으로 분포한 오차가 분산이 일정하지 않은 회귀모델에 대한 최대 가능도 추정량은 가중치가 부여된 최소제곱 추정량이라고 할 수 있다. 그리고 이때, 오차의 표준편차, <span class="math inline">\(\text{sd}(\epsilon_i)\)</span>은 <span class="math inline">\(1\sqrt{w_i}\)</span>에 비례한다.</p></li>
<li><p>모델을 적합할 때, 더 큰 분산을 가질 경우, 작은 가중치를 부여하는 식이다.</p></li>
</ul>
<p>위의 세 모델은 동일한 점추정치를 산출하지만 서로 다른 표준 오차와 예측분포를 가진다. 대개의 경우, 가중치는 표본과 모집단 간의 차이를 보정하기 위해 사용되며, 한 번 가중치가 적용되고 나면 가중치를 평균 1을 가지는 벡터로 재정규화한다(R에서는 <code>w &lt;- w/mean(w)</code>로 설정). 그리고 나서 회귀모델에 다음과 같이 가중치를 부여할 수 있다: <code>stan_glm(y ~ x, data = data, weights = w</code>.</p>
</div>
<div id="using-a-matrix-of-weights-to-account-for-correlated-errors" class="section level3" number="10.8.2">
<h3><span class="header-section-number">10.8.2</span> Using a matrix of weights to account for correlated errors</h3>
<p>가중치 행렬 <span class="math inline">\(W\)</span>를 이용해서 공분산행렬 <span class="math inline">\(W^{-1}\)</span>를 가진 정규적으로 분포된 오차 모델에 대한 최대가능도 추정량을 산출할 수 있고, 이를 일반화 최소자승이라고 불린다.</p>
<ul>
<li>상관성을 가지는 모델은 시계열, 공간통계, 클러스터 표본 등 다른 구조화된 데이터에서 찾아볼 수 있다.</li>
</ul>
</div>
</div>
<div id="fitting-the-same-model-to-many-datasets" class="section level2" number="10.9">
<h2><span class="header-section-number">10.9</span> Fitting the same model to many datasets</h2>
<p>회귀모델을 반복적으로 서로 다른 데이터셋에 적합하거나 기존 데이터셋의 서브셋에 적합시키는 것은 흔하다. 이와 같은 반복된 모델링 방법은 거의 사용되지는 않는다. <span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020</a>)</span> 은 그 이유가 교차사례 분석과 같은 자료들에 내재된 문제들을 해결하지 못하기 때문이다. 교차사례나 시계열 등의 자료에서 각 변수들 간의 상관과 같이 동일한 모델을 반복적으로 적용하는 데에는 제약이 있다.</p>
<div id="predicting-party-identification" class="section level3" number="10.9.1">
<h3><span class="header-section-number">10.9.1</span> Predicting party identification</h3>
<p>Figure 10.9는 시간에 따라 추적한 추정된 계수값의 변환을 보여준다. 이념과 인종이 가장 중요하고 그 그 둘의 계수값은 시간이 바뀔 때마 마찬가지로 변화해왔다.</p>
<p>Figure 10.9는 여러 모델을 추정하는 것이 어떻게 유용한지를 보여준다. 여러 예측변수에 기초해서 모델을 쪼개어보는 결과, 각 패널마다의 평균적인 경향성이 드러나는 것을 확인할 수 있기 때문이다.</p>
<pre><code>## Error in select(., year, partyid7, real_ideo, race_adj, age_discrete, : unused arguments (year, partyid7, real_ideo, race_adj, age_discrete, educ1, female, income)</code></pre>
<pre><code>## Error in select(., !age_discrete): unused argument (!age_discrete)</code></pre>
<pre><code>## Error in select(., !c(data, fit)): unused argument (!c(data, fit))</code></pre>
<pre><code>## Error in select(., !c(data, fit)): unused argument (!c(data, fit))</code></pre>
<pre><code>## Error in mutate(., var = fct_inorder(var), q_25 = qnorm(0.25, mean = coef, : object &#39;coefs&#39; not found</code></pre>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ghv2020" class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prediction-and-bayesian-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="assumptions-diagnostics-and-model-evaluation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
