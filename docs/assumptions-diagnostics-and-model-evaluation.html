<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Assumptions, diagnostics, and model evaluation | Reading Notes for Regression and Other Stories</title>
  <meta name="description" content="Chapter 11 Assumptions, diagnostics, and model evaluation | Reading Notes for Regression and Other Stories" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Assumptions, diagnostics, and model evaluation | Reading Notes for Regression and Other Stories" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="pherephobia/regression_hgv" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Assumptions, diagnostics, and model evaluation | Reading Notes for Regression and Other Stories" />
  
  
  

<meta name="author" content="Sanghoon Park" />


<meta name="date" content="2021-07-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regression-with-multiple-predictors.html"/>
<link rel="next" href="transformations-and-regression.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-88838732-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GHV</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-three-challenges-of-statistics"><i class="fa fa-check"></i><b>1.1</b> The three challenges of statistics</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-learn-regression"><i class="fa fa-check"></i><b>1.2</b> Why learn regression?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#some-examples-of-regression"><i class="fa fa-check"></i><b>1.3</b> Some examples of regression</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#a-randomized-experiment-on-the-effect-of-an-educational-television-program"><i class="fa fa-check"></i><b>1.3.1</b> A randomized experiment on the effect of an educational television program</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#comparing-the-peacekeeping-and-gun-control-studies"><i class="fa fa-check"></i><b>1.3.2</b> Comparing the peacekeeping and gun-control studies</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#challenges-in-building-understanding-and-interpreting-regressions"><i class="fa fa-check"></i><b>1.4</b> Challenges in building, understanding, and interpreting regressions</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#regression-to-estimate-a-relationship-of-interest"><i class="fa fa-check"></i><b>1.4.1</b> Regression to estimate a relationship of interest</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#regression-to-adjust-for-differences-between-treatment-and-control-groups"><i class="fa fa-check"></i><b>1.4.2</b> Regression to adjust for differences between treatment and control groups</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#interpreting-coefficients-in-a-predictive-model"><i class="fa fa-check"></i><b>1.4.3</b> Interpreting coefficients in a predictive model</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#building-interpreting-and-checking-regression-models"><i class="fa fa-check"></i><b>1.4.4</b> Building, interpreting, and checking regression models</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#classical-and-bayesian-inference"><i class="fa fa-check"></i><b>1.5</b> Classical and Bayesian inference</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#information"><i class="fa fa-check"></i><b>1.5.1</b> Information</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#assumptions"><i class="fa fa-check"></i><b>1.5.2</b> Assumptions</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#classical-inference"><i class="fa fa-check"></i><b>1.5.3</b> Classical inference</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#bayesian-inference"><i class="fa fa-check"></i><b>1.5.4</b> Bayesian inference</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#computing-least-squares-and-bayesian-regression"><i class="fa fa-check"></i><b>1.6</b> Computing least squares and Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-and-measurement.html"><a href="data-and-measurement.html"><i class="fa fa-check"></i><b>2</b> Data and Measurement</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#examining-where-data-come-from"><i class="fa fa-check"></i><b>2.1</b> Examining where data come from</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#details-of-measurement-can-be-important"><i class="fa fa-check"></i><b>2.1.1</b> Details of measurement can be important</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-and-measurement.html"><a href="data-and-measurement.html#validity-and-reliability"><i class="fa fa-check"></i><b>2.2</b> Validity and reliability</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#validity"><i class="fa fa-check"></i><b>2.2.1</b> Validity</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-and-measurement.html"><a href="data-and-measurement.html#reliability"><i class="fa fa-check"></i><b>2.2.2</b> Reliability</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-and-measurement.html"><a href="data-and-measurement.html#sample-selection"><i class="fa fa-check"></i><b>2.2.3</b> Sample selection</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-and-measurement.html"><a href="data-and-measurement.html#all-graphs-are-comparisons"><i class="fa fa-check"></i><b>2.3</b> All graphs are comparisons</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-and-measurement.html"><a href="data-and-measurement.html#simple-scatterplots"><i class="fa fa-check"></i><b>2.3.1</b> Simple scatterplots</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-and-measurement.html"><a href="data-and-measurement.html#displaying-more-information-on-a-graph"><i class="fa fa-check"></i><b>2.3.2</b> Displaying more information on a graph</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-and-measurement.html"><a href="data-and-measurement.html#multiple-plots"><i class="fa fa-check"></i><b>2.3.3</b> Multiple plots</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-and-measurement.html"><a href="data-and-measurement.html#grids-of-plots"><i class="fa fa-check"></i><b>2.3.4</b> Grids of plots</a></li>
<li class="chapter" data-level="2.3.5" data-path="data-and-measurement.html"><a href="data-and-measurement.html#applying-graphical-principles-to-numerical-displays-and-communication-more-generally"><i class="fa fa-check"></i><b>2.3.5</b> Applying graphical principles to numerical displays and communication more generally</a></li>
<li class="chapter" data-level="2.3.6" data-path="data-and-measurement.html"><a href="data-and-measurement.html#graphics-for-understanding-statistical-models"><i class="fa fa-check"></i><b>2.3.6</b> Graphics for understanding statistical models</a></li>
<li class="chapter" data-level="2.3.7" data-path="data-and-measurement.html"><a href="data-and-measurement.html#graphs-as-comparisons"><i class="fa fa-check"></i><b>2.3.7</b> Graphs as comparisons</a></li>
<li class="chapter" data-level="2.3.8" data-path="data-and-measurement.html"><a href="data-and-measurement.html#graphs-of-fitted-models"><i class="fa fa-check"></i><b>2.3.8</b> Graphs of fitted models</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-and-measurement.html"><a href="data-and-measurement.html#data-and-adjustment-trends-in-mortality-rates"><i class="fa fa-check"></i><b>2.4</b> Data and adjustment: trends in mortality rates</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html"><i class="fa fa-check"></i><b>3</b> Some Basic Methods in Mathematics and Probability</a>
<ul>
<li class="chapter" data-level="3.1" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#weighted-averages"><i class="fa fa-check"></i><b>3.1</b> Weighted averages</a></li>
<li class="chapter" data-level="3.2" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#vectors-and-matrices"><i class="fa fa-check"></i><b>3.2</b> Vectors and matrices</a></li>
<li class="chapter" data-level="3.3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#graphing-a-line"><i class="fa fa-check"></i><b>3.3</b> Graphing a line</a></li>
<li class="chapter" data-level="3.4" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#exponential-and-power-law-growth-and-decline-logarithmic-and-log-log-relationships"><i class="fa fa-check"></i><b>3.4</b> Exponential and power-law growth and decline; logarithmic and log-log relationships</a></li>
<li class="chapter" data-level="3.5" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#probability-distributions"><i class="fa fa-check"></i><b>3.5</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#mean-and-standard-deviation-of-a-probability-distribution"><i class="fa fa-check"></i><b>3.5.1</b> Mean and standard deviation of a probability distribution</a></li>
<li class="chapter" data-level="3.5.2" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#normal-distribution-mean-and-standard-deviation"><i class="fa fa-check"></i><b>3.5.2</b> Normal distribution; mean and standard deviation</a></li>
<li class="chapter" data-level="3.5.3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#linear-transformations"><i class="fa fa-check"></i><b>3.5.3</b> Linear transformations</a></li>
<li class="chapter" data-level="3.5.4" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#mean-and-standard-deviation-of-the-sum-of-correlated-random-variables"><i class="fa fa-check"></i><b>3.5.4</b> Mean and standard deviation of the sum of correlated random variables</a></li>
<li class="chapter" data-level="3.5.5" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#lognormal-distribution"><i class="fa fa-check"></i><b>3.5.5</b> Lognormal distribution</a></li>
<li class="chapter" data-level="3.5.6" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#binomial-distribution"><i class="fa fa-check"></i><b>3.5.6</b> Binomial distribution</a></li>
<li class="chapter" data-level="3.5.7" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#poisson-distribution"><i class="fa fa-check"></i><b>3.5.7</b> Poisson distribution</a></li>
<li class="chapter" data-level="3.5.8" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#unclassified-probability-distribution"><i class="fa fa-check"></i><b>3.5.8</b> Unclassified probability distribution</a></li>
<li class="chapter" data-level="3.5.9" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#probability-distributions-for-error"><i class="fa fa-check"></i><b>3.5.9</b> Probability distributions for error</a></li>
<li class="chapter" data-level="3.5.10" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#comparing-distributions"><i class="fa fa-check"></i><b>3.5.10</b> Comparing distributions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#probability-modeling"><i class="fa fa-check"></i><b>3.6</b> Probability modeling</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#using-an-empirical-forecast"><i class="fa fa-check"></i><b>3.6.1</b> Using an empirical forecast</a></li>
<li class="chapter" data-level="3.6.2" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#using-an-reasonable-seeming-but-inappropriate-probability-model"><i class="fa fa-check"></i><b>3.6.2</b> Using an reasonable-seeming but inappropriate probability model</a></li>
<li class="chapter" data-level="3.6.3" data-path="some-basic-methods-in-mathematics-and-probability.html"><a href="some-basic-methods-in-mathematics-and-probability.html#general-lessons-for-probability-modeling"><i class="fa fa-check"></i><b>3.6.3</b> General lessons for probability modeling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-distributions-and-generative-models"><i class="fa fa-check"></i><b>4.1</b> Sampling distributions and generative models</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-measurement-error-and-model-error"><i class="fa fa-check"></i><b>4.1.1</b> Sampling, measurement error, and model error</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistical-inference.html"><a href="statistical-inference.html#the-sampling-distribution"><i class="fa fa-check"></i><b>4.1.2</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#estimates-standard-errors-and-confidence-intervals"><i class="fa fa-check"></i><b>4.2</b> Estimates, standard errors, and confidence intervals</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="statistical-inference.html"><a href="statistical-inference.html#parameters-estimands-and-estimates"><i class="fa fa-check"></i><b>4.2.1</b> Parameters, estimands, and estimates</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-errors-inferential-uncertainty-and-confidence-intervals"><i class="fa fa-check"></i><b>4.2.2</b> Standard errors, inferential uncertainty, and confidence intervals</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-errors-and-confidence-intervals-for-average-and-proportions"><i class="fa fa-check"></i><b>4.2.3</b> Standard errors and confidence intervals for average and proportions</a></li>
<li class="chapter" data-level="4.2.4" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-error-and-confidence-interval-for-a-proportion-when-y-0-or-y-n"><i class="fa fa-check"></i><b>4.2.4</b> Standard error and confidence interval for a proportion when <span class="math inline">\(y = 0\)</span> or <span class="math inline">\(y = n\)</span></a></li>
<li class="chapter" data-level="4.2.5" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-error-for-a-comparison"><i class="fa fa-check"></i><b>4.2.5</b> Standard error for a comparison</a></li>
<li class="chapter" data-level="4.2.6" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-distribution-of-the-sample-mean-and-standard-deviation-normal-and-chi2-distributions"><i class="fa fa-check"></i><b>4.2.6</b> Sampling distribution of the sample mean and standard deviation; normal and <span class="math inline">\(\chi^2\)</span> distributions</a></li>
<li class="chapter" data-level="4.2.7" data-path="statistical-inference.html"><a href="statistical-inference.html#degrees-of-freedom"><i class="fa fa-check"></i><b>4.2.7</b> Degrees of freedom</a></li>
<li class="chapter" data-level="4.2.8" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals-from-the-t-distribution"><i class="fa fa-check"></i><b>4.2.8</b> Confidence intervals from the <span class="math inline">\(t\)</span> distribution</a></li>
<li class="chapter" data-level="4.2.9" data-path="statistical-inference.html"><a href="statistical-inference.html#inference-for-discrete-data"><i class="fa fa-check"></i><b>4.2.9</b> Inference for discrete data</a></li>
<li class="chapter" data-level="4.2.10" data-path="statistical-inference.html"><a href="statistical-inference.html#linear-transformations-1"><i class="fa fa-check"></i><b>4.2.10</b> Linear transformations</a></li>
<li class="chapter" data-level="4.2.11" data-path="statistical-inference.html"><a href="statistical-inference.html#comparisons-visual-and-numerical"><i class="fa fa-check"></i><b>4.2.11</b> Comparisons, visual and numerical</a></li>
<li class="chapter" data-level="4.2.12" data-path="statistical-inference.html"><a href="statistical-inference.html#weighted-averages-1"><i class="fa fa-check"></i><b>4.2.12</b> Weighted averages</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#bias-and-unmodeled-uncertainty"><i class="fa fa-check"></i><b>4.3</b> Bias and unmodeled uncertainty</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="statistical-inference.html"><a href="statistical-inference.html#bias-in-estimation"><i class="fa fa-check"></i><b>4.3.1</b> Bias in estimation</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistical-inference.html"><a href="statistical-inference.html#adjusting-inferences-to-account-for-bias-and-unmodeled-uncertainty"><i class="fa fa-check"></i><b>4.3.2</b> Adjusting inferences to account for bias and unmodeled uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#statistical-significance-hypothesis-testing-and-statistical-errors"><i class="fa fa-check"></i><b>4.4</b> Statistical significance, hypothesis testing, and statistical errors</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#statistical-significance"><i class="fa fa-check"></i><b>4.4.1</b> Statistical significance</a></li>
<li class="chapter" data-level="4.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#hypothesis-testing-for-simple-comparisons."><i class="fa fa-check"></i><b>4.4.2</b> Hypothesis testing for simple comparisons.</a></li>
<li class="chapter" data-level="4.4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#hypothesis-testing-general-formulation."><i class="fa fa-check"></i><b>4.4.3</b> Hypothesis testing: general formulation.</a></li>
<li class="chapter" data-level="4.4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#comparisons-of-parameters-to-fixed-values-and-each-other-interpreting-confidence-intervals-as-hypothesis-tests."><i class="fa fa-check"></i><b>4.4.4</b> Comparisons of parameters to fixed values and each other: interpreting confidence intervals as hypothesis tests.</a></li>
<li class="chapter" data-level="4.4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#type-1-and-type-2-errors-and-why-we-dont-like-talking-about-them."><i class="fa fa-check"></i><b>4.4.5</b> Type 1 and type 2 errors and why we don’t like talking about them.</a></li>
<li class="chapter" data-level="4.4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#type-m-magnitude-and-type-s-sign-errors."><i class="fa fa-check"></i><b>4.4.6</b> 4.4.6 Type M (magnitude) and type S (sign) errors.</a></li>
<li class="chapter" data-level="4.4.7" data-path="statistical-inference.html"><a href="statistical-inference.html#hypothesis-testing-and-statistical-practice."><i class="fa fa-check"></i><b>4.4.7</b> Hypothesis testing and statistical practice.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#problems-with-the-concept-of-statistical-significance"><i class="fa fa-check"></i><b>4.5</b> Problems with the concept of statistical significance</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="statistical-inference.html"><a href="statistical-inference.html#statistical-significance-is-not-the-same-as-practical-importance."><i class="fa fa-check"></i><b>4.5.1</b> Statistical significance is not the same as practical importance.</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistical-inference.html"><a href="statistical-inference.html#non-significance-is-not-the-same-as-zero."><i class="fa fa-check"></i><b>4.5.2</b> Non-significance is not the same as zero.</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistical-inference.html"><a href="statistical-inference.html#the-difference-between-significant-and-not-significant-is-not-itself-statistically-significant."><i class="fa fa-check"></i><b>4.5.3</b> The difference between “significant” and “not significant” is not itself statistically significant.</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistical-inference.html"><a href="statistical-inference.html#researcher-degrees-of-freedom-p-hacking-and-forking-paths."><i class="fa fa-check"></i><b>4.5.4</b> Researcher degrees of freedom, <span class="math inline">\(p\)</span>-hacking, and forking paths.</a></li>
<li class="chapter" data-level="4.5.5" data-path="statistical-inference.html"><a href="statistical-inference.html#the-statistical-significance-filter."><i class="fa fa-check"></i><b>4.5.5</b> The statistical significance filter.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#moving-beyond-hypothesis-testing"><i class="fa fa-check"></i><b>4.6</b> Moving beyond hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>5</b> Simulation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulation.html"><a href="simulation.html#simulation-of-discrete-probability-models"><i class="fa fa-check"></i><b>5.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="simulation.html"><a href="simulation.html#how-many-girls-in-400-births"><i class="fa fa-check"></i><b>5.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="5.1.2" data-path="simulation.html"><a href="simulation.html#accounting-for-twins"><i class="fa fa-check"></i><b>5.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="simulation.html"><a href="simulation.html#simulation-of-continuous-and-mixed-discretecontinuous-models"><i class="fa fa-check"></i><b>5.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="simulation.html"><a href="simulation.html#simulation-in-r-using-custom-made-functions"><i class="fa fa-check"></i><b>5.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulation.html"><a href="simulation.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation"><i class="fa fa-check"></i><b>5.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="5.4" data-path="simulation.html"><a href="simulation.html#bootstrapping-to-simulate-a-sampling-distribution"><i class="fa fa-check"></i><b>5.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="simulation.html"><a href="simulation.html#choices-in-defining-the-bootstrap-distribution"><i class="fa fa-check"></i><b>5.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="5.4.2" data-path="simulation.html"><a href="simulation.html#limitations-of-bootstrapping"><i class="fa fa-check"></i><b>5.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="simulation.html"><a href="simulation.html#fake-data-simulation-as-a-way-of-life"><i class="fa fa-check"></i><b>5.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html"><i class="fa fa-check"></i><b>6</b> Background on regression modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#regression-models"><i class="fa fa-check"></i><b>6.1</b> Regression models</a></li>
<li class="chapter" data-level="6.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#fitting-a-simple-regression-to-fake-data"><i class="fa fa-check"></i><b>6.2</b> Fitting a simple regression to fake data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#fitting-a-regression-and-displaying-the-results"><i class="fa fa-check"></i><b>6.2.1</b> Fitting a regression and displaying the results</a></li>
<li class="chapter" data-level="6.2.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#comparing-estimates-to-assumed-parameter-values"><i class="fa fa-check"></i><b>6.2.2</b> Comparing estimates to assumed parameter values</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#interpret-coefficients-as-comparisons-not-effects"><i class="fa fa-check"></i><b>6.3</b> Interpret coefficients as comparisons, not effects</a></li>
<li class="chapter" data-level="6.4" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#historical-origins-of-regression"><i class="fa fa-check"></i><b>6.4</b> Historical origins of regression</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#daughters-heights-regressing-to-the-mean"><i class="fa fa-check"></i><b>6.4.1</b> Daughters’ heights “regressing” to the mean</a></li>
<li class="chapter" data-level="6.4.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#fitting-the-model-in-r"><i class="fa fa-check"></i><b>6.4.2</b> Fitting the model in R</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#the-paradox-of-regression-to-the-mean"><i class="fa fa-check"></i><b>6.5</b> The paradox of regression to the mean</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#how-regression-to-the-mean-can-confuse-people-about-causal-inference-demonstration-using-fake-data"><i class="fa fa-check"></i><b>6.5.1</b> How regression to the mean can confuse people about causal inference; demonstration using fake data</a></li>
<li class="chapter" data-level="6.5.2" data-path="background-on-regression-modeling.html"><a href="background-on-regression-modeling.html#relation-of-regression-to-the-mean-to-the-larger-themes-of-the-book"><i class="fa fa-check"></i><b>6.5.2</b> Relation of “regression to the mean” to the larger themes of the book</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html"><i class="fa fa-check"></i><b>7</b> Linear regression with a single predictor</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#example-predicting-presidential-vote-share-from-the-economy"><i class="fa fa-check"></i><b>7.1</b> Example: predicting presidential vote share from the economy</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#fitting-a-linear-model-to-data"><i class="fa fa-check"></i><b>7.1.1</b> Fitting a linear model to data</a></li>
<li class="chapter" data-level="7.1.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#understanding-the-fitted-model"><i class="fa fa-check"></i><b>7.1.2</b> Understanding the fitted model</a></li>
<li class="chapter" data-level="7.1.3" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#graphing-the-fitted-regression-line"><i class="fa fa-check"></i><b>7.1.3</b> Graphing the fitted regression line</a></li>
<li class="chapter" data-level="7.1.4" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#using-the-model-to-predict"><i class="fa fa-check"></i><b>7.1.4</b> Using the model to predict</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#checking-the-model-fitting-procedure-using-fake-data-simulation"><i class="fa fa-check"></i><b>7.2</b> Checking the model-fitting procedure using fake-data simulation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-1-creating-the-pretend-world"><i class="fa fa-check"></i><b>7.2.1</b> Step 1: Creating the pretend world</a></li>
<li class="chapter" data-level="7.2.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-2-simulating-fake-data"><i class="fa fa-check"></i><b>7.2.2</b> Step 2: Simulating fake data</a></li>
<li class="chapter" data-level="7.2.3" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-3-fitting-the-model-and-comparing-fitted-to-assumed-values"><i class="fa fa-check"></i><b>7.2.3</b> Step 3: Fitting the model and comparing fitted to assumed values</a></li>
<li class="chapter" data-level="7.2.4" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#step-4-embedding-the-simulation-in-a-loop"><i class="fa fa-check"></i><b>7.2.4</b> Step 4: Embedding the simulation in a loop</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#formulating-comparisons-as-regression-models"><i class="fa fa-check"></i><b>7.3</b> Formulating comparisons as regression models</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#estimating-the-mean-is-the-same-as-regressing-on-a-constant-term"><i class="fa fa-check"></i><b>7.3.1</b> Estimating the mean is the same as regressing on a constant term</a></li>
<li class="chapter" data-level="7.3.2" data-path="linear-regression-with-a-single-predictor.html"><a href="linear-regression-with-a-single-predictor.html#estimating-a-difference-is-the-same-as-regressing-on-an-indicator-variable"><i class="fa fa-check"></i><b>7.3.2</b> Estimating a difference is the same as regressing on an indicator variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html"><i class="fa fa-check"></i><b>8</b> Fitting regression models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#least-squares-maximum-likelihood-and-bayesian-inference"><i class="fa fa-check"></i><b>8.1</b> Least squares, maximum likelihood, and Bayesian inference</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#least-squares"><i class="fa fa-check"></i><b>8.1.1</b> Least squares</a></li>
<li class="chapter" data-level="8.1.2" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#estimation-of-residual-standard-deviation-sigma"><i class="fa fa-check"></i><b>8.1.2</b> Estimation of residual standard deviation <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="8.1.3" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#computing-the-sum-of-squares-directly"><i class="fa fa-check"></i><b>8.1.3</b> Computing the sum of squares directly</a></li>
<li class="chapter" data-level="8.1.4" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#maximum-likelihood"><i class="fa fa-check"></i><b>8.1.4</b> Maximum likelihood</a></li>
<li class="chapter" data-level="8.1.5" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#where-do-the-standard-errors-come-from-using-the-likelihood-surface-to-assess-uncertainty-in-the-parameter-estimates"><i class="fa fa-check"></i><b>8.1.5</b> Where do the standard errors come from? Using the likelihood surface to assess uncertainty in the parameter estimates</a></li>
<li class="chapter" data-level="8.1.6" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#bayesian-inference-1"><i class="fa fa-check"></i><b>8.1.6</b> Bayesian inference</a></li>
<li class="chapter" data-level="8.1.7" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#point-estimate-mode-based-approximation-and-posterior-simulations"><i class="fa fa-check"></i><b>8.1.7</b> Point estimate, mode-based approximation, and posterior simulations</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#influence-of-individual-points-in-a-fitted-regression"><i class="fa fa-check"></i><b>8.2</b> Influence of individual points in a fitted regression</a></li>
<li class="chapter" data-level="8.3" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#least-squares-slope-as-a-weighted-average-of-slopes-of-pairs"><i class="fa fa-check"></i><b>8.3</b> Least squares slope as a weighted average of slopes of pairs</a></li>
<li class="chapter" data-level="8.4" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#comparing-two-fitting-functions-lm-and-stan_glm"><i class="fa fa-check"></i><b>8.4</b> Comparing two fitting functions: <code>lm</code> and <code>stan_glm</code></a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#reproducing-maximum-likelihood-using-stan_glm-with-flat-priors-and-optimization"><i class="fa fa-check"></i><b>8.4.1</b> Reproducing maximum likelihood using <code>stan_glm</code> with flat priors and optimization</a></li>
<li class="chapter" data-level="8.4.2" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#running-lm"><i class="fa fa-check"></i><b>8.4.2</b> Running <code>lm</code></a></li>
<li class="chapter" data-level="8.4.3" data-path="fitting-regression-models.html"><a href="fitting-regression-models.html#confidence-intervals-uncertainty-intervals-compatibility-intervals"><i class="fa fa-check"></i><b>8.4.3</b> Confidence intervals, uncertainty intervals, compatibility intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html"><i class="fa fa-check"></i><b>9</b> Prediction and Bayesian inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#propagating-uncertainty-in-inference-using-posterior-simulations"><i class="fa fa-check"></i><b>9.1</b> Propagating uncertainty in inference using posterior simulations</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#uncertainty-in-the-regression-coefficients-and-implied-uncertainty-in-the-regression-line"><i class="fa fa-check"></i><b>9.1.1</b> Uncertainty in the regression coefficients and implied uncertainty in the regression line</a></li>
<li class="chapter" data-level="9.1.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#using-the-matrix-of-posterior-simulations-to-express-uncertainty-about-a-parameter-estimate-or-function-of-parameter-estimates"><i class="fa fa-check"></i><b>9.1.2</b> Using the matrix of posterior simulations to express uncertainty about a parameter estimate or function of parameter estimates</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prediction-and-uncertainty-predict-posterior_linpred-and-posterior_predict"><i class="fa fa-check"></i><b>9.2</b> Prediction and uncertainty: predict, posterior_linpred, and posterior_predict</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#point-prediction-using-predict"><i class="fa fa-check"></i><b>9.2.1</b> Point prediction using predict</a></li>
<li class="chapter" data-level="9.2.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#linear-predictor-with-uncertainty-using-posterior_linpred-or-posterior_epred"><i class="fa fa-check"></i><b>9.2.2</b> Linear predictor with uncertainty using posterior_linpred or posterior_epred</a></li>
<li class="chapter" data-level="9.2.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#predictive-distribution-for-a-new-observation-using-posterior_predict"><i class="fa fa-check"></i><b>9.2.3</b> Predictive distribution for a new observation using posterior_predict</a></li>
<li class="chapter" data-level="9.2.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prediction-given-a-range-of-input-values"><i class="fa fa-check"></i><b>9.2.4</b> Prediction given a range of input values</a></li>
<li class="chapter" data-level="9.2.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#propagating-uncertainty"><i class="fa fa-check"></i><b>9.2.5</b> Propagating uncertainty</a></li>
<li class="chapter" data-level="9.2.6" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#simulating-uncertainty-for-the-linear-predictor-and-new-observations"><i class="fa fa-check"></i><b>9.2.6</b> Simulating uncertainty for the linear predictor and new observations</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prior-information-and-bayesian-synthesis"><i class="fa fa-check"></i><b>9.3</b> Prior information and Bayesian synthesis</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#expressing-data-and-prior-information-on-the-same-scale"><i class="fa fa-check"></i><b>9.3.1</b> Expressing data and prior information on the same scale</a></li>
<li class="chapter" data-level="9.3.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#bayesian-information-aggregation"><i class="fa fa-check"></i><b>9.3.2</b> Bayesian information aggregation</a></li>
<li class="chapter" data-level="9.3.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#different-ways-of-assigning-prior-distributions-and-performing-bayesian-calculations"><i class="fa fa-check"></i><b>9.3.3</b> Different ways of assigning prior distributions and performing Bayesian calculations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#example-of-bayesian-inference-beauty-and-sex-ratio"><i class="fa fa-check"></i><b>9.4</b> Example of Bayesian inference: beauty and sex ratio</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prior-information"><i class="fa fa-check"></i><b>9.4.1</b> Prior information</a></li>
<li class="chapter" data-level="9.4.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#prior-estimate-and-standard-error"><i class="fa fa-check"></i><b>9.4.2</b> Prior estimate and standard error</a></li>
<li class="chapter" data-level="9.4.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#data-estimate-and-standard-error"><i class="fa fa-check"></i><b>9.4.3</b> Data estimate and standard error</a></li>
<li class="chapter" data-level="9.4.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#bayes-estimate"><i class="fa fa-check"></i><b>9.4.4</b> Bayes estimate</a></li>
<li class="chapter" data-level="9.4.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#understanding-the-bayes-estimate"><i class="fa fa-check"></i><b>9.4.5</b> Understanding the Bayes estimate</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#uniform-weakly-informative-and-informative-priors-in-regression"><i class="fa fa-check"></i><b>9.5</b> Uniform, weakly informative, and informative priors in regression</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#uniform-prior-distribution"><i class="fa fa-check"></i><b>9.5.1</b> Uniform prior distribution</a></li>
<li class="chapter" data-level="9.5.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#default-prior-distribution"><i class="fa fa-check"></i><b>9.5.2</b> Default prior distribution</a></li>
<li class="chapter" data-level="9.5.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#weakly-informative-prior-distribution-based-on-subject-matter-knowledge"><i class="fa fa-check"></i><b>9.5.3</b> Weakly informative prior distribution based on subject-matter knowledge</a></li>
<li class="chapter" data-level="9.5.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#example-where-an-informative-prior-makes-a-difference-beauty-and-sex-ratio"><i class="fa fa-check"></i><b>9.5.4</b> Example where an informative prior makes a difference: Beauty and sex ratio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html"><i class="fa fa-check"></i><b>10</b> Linear regression with multiple predictors</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#adding-predictors-to-a-model"><i class="fa fa-check"></i><b>10.1</b> Adding predictors to a model</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#starting-with-a-binary-predictor"><i class="fa fa-check"></i><b>10.1.1</b> Starting with a binary predictor</a></li>
<li class="chapter" data-level="10.1.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#a-single-continuous-predictor"><i class="fa fa-check"></i><b>10.1.2</b> A single continuous predictor</a></li>
<li class="chapter" data-level="10.1.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#including-both-predictors"><i class="fa fa-check"></i><b>10.1.3</b> Including both predictors</a></li>
<li class="chapter" data-level="10.1.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#understanding-the-fitted-model-1"><i class="fa fa-check"></i><b>10.1.4</b> Understanding the fitted model</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#interpreting-regression-coefficients"><i class="fa fa-check"></i><b>10.2</b> Interpreting regression coefficients</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#its-not-always-possible-to-change-one-predictor-while-holding-all-others-constant"><i class="fa fa-check"></i><b>10.2.1</b> It’s not always possible to change one predictor while holding all others constant</a></li>
<li class="chapter" data-level="10.2.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#counterfactual-and-predictive-interpretations"><i class="fa fa-check"></i><b>10.2.2</b> Counterfactual and predictive interpretations</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#interactions"><i class="fa fa-check"></i><b>10.3</b> Interactions</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#when-should-we-look-for-interactions"><i class="fa fa-check"></i><b>10.3.1</b> When should we look for interactions?</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#interpreting-regression-coefficients-in-the-presence-of-interactions"><i class="fa fa-check"></i><b>10.3.2</b> Interpreting regression coefficients in the presence of interactions</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#indicator-variables"><i class="fa fa-check"></i><b>10.4</b> Indicator variables</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#centering-a-predictor"><i class="fa fa-check"></i><b>10.4.1</b> Centering a predictor</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#including-a-binary-variable-in-a-regression"><i class="fa fa-check"></i><b>10.4.2</b> Including a binary variable in a regression</a></li>
<li class="chapter" data-level="10.4.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#using-indicator-variables-for-multiple-levels-of-a-categorical-predictor"><i class="fa fa-check"></i><b>10.4.3</b> Using indicator variables for multiple levels of a categorical predictor</a></li>
<li class="chapter" data-level="10.4.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#changing-the-baseline-factor-level"><i class="fa fa-check"></i><b>10.4.4</b> Changing the baseline factor level</a></li>
<li class="chapter" data-level="10.4.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#using-an-index-variable-to-access-a-group-level-predictor"><i class="fa fa-check"></i><b>10.4.5</b> Using an index variable to access a group-level predictor</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#formulating-paired-or-blocked-designs-as-a-regression-problem"><i class="fa fa-check"></i><b>10.5</b> Formulating paired or blocked designs as a regression problem</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#completely-randomized-experiment"><i class="fa fa-check"></i><b>10.5.1</b> Completely randomized experiment</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#paired-design"><i class="fa fa-check"></i><b>10.5.2</b> Paired design</a></li>
<li class="chapter" data-level="10.5.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#block-design"><i class="fa fa-check"></i><b>10.5.3</b> Block design</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#example-uncertainty-in-predicting-congressional-elections"><i class="fa fa-check"></i><b>10.6</b> Example: uncertainty in predicting congressional elections</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#background"><i class="fa fa-check"></i><b>10.6.1</b> Background</a></li>
<li class="chapter" data-level="10.6.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#data-issues"><i class="fa fa-check"></i><b>10.6.2</b> Data issues</a></li>
<li class="chapter" data-level="10.6.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#fitting-the-model"><i class="fa fa-check"></i><b>10.6.3</b> Fitting the model</a></li>
<li class="chapter" data-level="10.6.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#simulation-for-inferences-and-predictions-of-new-data-points"><i class="fa fa-check"></i><b>10.6.4</b> Simulation for inferences and predictions of new data points</a></li>
<li class="chapter" data-level="10.6.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#predictive-simulation-for-a-nonlinear-function-of-new-data"><i class="fa fa-check"></i><b>10.6.5</b> Predictive simulation for a nonlinear function of new data</a></li>
<li class="chapter" data-level="10.6.6" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#combining-simulation-and-analytic-calculations"><i class="fa fa-check"></i><b>10.6.6</b> Combining simulation and analytic calculations</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#mathematical-notation-and-statistical-inference"><i class="fa fa-check"></i><b>10.7</b> Mathematical notation and statistical inference</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#predictors"><i class="fa fa-check"></i><b>10.7.1</b> Predictors</a></li>
<li class="chapter" data-level="10.7.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#regression-in-vector-matrix-notation"><i class="fa fa-check"></i><b>10.7.2</b> Regression in vector-matrix notation</a></li>
<li class="chapter" data-level="10.7.3" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#two-ways-of-writing-the-model"><i class="fa fa-check"></i><b>10.7.3</b> Two ways of writing the model</a></li>
<li class="chapter" data-level="10.7.4" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#nonidentified-parameters-collinearity-and-the-likelihood-function"><i class="fa fa-check"></i><b>10.7.4</b> Nonidentified parameters, collinearity, and the likelihood function</a></li>
<li class="chapter" data-level="10.7.5" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#hypothesis-testing-why-we-do-not-like-t-tests-and-f-tests"><i class="fa fa-check"></i><b>10.7.5</b> Hypothesis testing: why we do not like <span class="math inline">\(t\)</span> tests and <span class="math inline">\(F\)</span> tests</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#weighted-regression"><i class="fa fa-check"></i><b>10.8</b> Weighted regression</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#three-models-leading-to-weighted-regression"><i class="fa fa-check"></i><b>10.8.1</b> Three models leading to weighted regression</a></li>
<li class="chapter" data-level="10.8.2" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#using-a-matrix-of-weights-to-account-for-correlated-errors"><i class="fa fa-check"></i><b>10.8.2</b> Using a matrix of weights to account for correlated errors</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#fitting-the-same-model-to-many-datasets"><i class="fa fa-check"></i><b>10.9</b> Fitting the same model to many datasets</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="linear-regression-with-multiple-predictors.html"><a href="linear-regression-with-multiple-predictors.html#predicting-party-identification"><i class="fa fa-check"></i><b>10.9.1</b> Predicting party identification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html"><i class="fa fa-check"></i><b>11</b> Assumptions, diagnostics, and model evaluation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#assumptions-of-regression-analysis"><i class="fa fa-check"></i><b>11.1</b> Assumptions of regression analysis</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#failures-of-the-assumptions"><i class="fa fa-check"></i><b>11.1.1</b> Failures of the assumptions</a></li>
<li class="chapter" data-level="11.1.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#causal-inference"><i class="fa fa-check"></i><b>11.1.2</b> Causal inference</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#plotting-the-data-and-fitted-model"><i class="fa fa-check"></i><b>11.2</b> Plotting the data and fitted model</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-a-regression-line-as-a-function-of-one-input-variable"><i class="fa fa-check"></i><b>11.2.1</b> Displaying a regression line as a function of one input variable</a></li>
<li class="chapter" data-level="11.2.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-two-fitted-regression-lines"><i class="fa fa-check"></i><b>11.2.2</b> Displaying two fitted regression lines</a></li>
<li class="chapter" data-level="11.2.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-uncertainty-in-the-fitted-regression"><i class="fa fa-check"></i><b>11.2.3</b> Displaying uncertainty in the fitted regression</a></li>
<li class="chapter" data-level="11.2.4" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#displaying-using-one-plot-for-each-input-variable"><i class="fa fa-check"></i><b>11.2.4</b> Displaying using one plot for each input variable</a></li>
<li class="chapter" data-level="11.2.5" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#plotting-the-outcome-vs.-a-continuous-predictor"><i class="fa fa-check"></i><b>11.2.5</b> Plotting the outcome vs. a continuous predictor</a></li>
<li class="chapter" data-level="11.2.6" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#forming-a-linear-predictor-from-a-multiple-regression"><i class="fa fa-check"></i><b>11.2.6</b> Forming a linear predictor from a multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#residual-plots"><i class="fa fa-check"></i><b>11.3</b> Residual plots</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#using-fake-data-simulation-to-understand-residual-plots"><i class="fa fa-check"></i><b>11.3.1</b> Using fake-data simulation to understand residual plots</a></li>
<li class="chapter" data-level="11.3.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#a-confusing-choice-plot-residuals-vs.-predicted-values-or-residuals-vs.-observed-values"><i class="fa fa-check"></i><b>11.3.2</b> A confusing choice: plot residuals vs. predicted values, or residuals vs. observed values?</a></li>
<li class="chapter" data-level="11.3.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#understanding-the-choice-using-fake-data-simulation"><i class="fa fa-check"></i><b>11.3.3</b> Understanding the choice using fake-data simulation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#comparing-data-to-replications-from-a-fitted-model"><i class="fa fa-check"></i><b>11.4</b> Comparing data to replications from a fitted model</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#example-simulation-based-checking-of-a-fitted-normal-distribution"><i class="fa fa-check"></i><b>11.4.1</b> Example: simulation-based checking of a fitted normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#example-predictive-simulation-to-check-the-fit-of-a-time-series-model"><i class="fa fa-check"></i><b>11.5</b> Example: predictive simulation to check the fit of a time-series model</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#fitting-a-first-order-autoregression-to-the-unemployment-series"><i class="fa fa-check"></i><b>11.5.1</b> Fitting a first-order autoregression to the unemployment series</a></li>
<li class="chapter" data-level="11.5.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#simulating-replicated-datasets"><i class="fa fa-check"></i><b>11.5.2</b> Simulating replicated datasets</a></li>
<li class="chapter" data-level="11.5.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#visual-and-numerical-comparisons-of-replicated-to-actual-data"><i class="fa fa-check"></i><b>11.5.3</b> Visual and numerical comparisons of replicated to actual data</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#residual-standard-deviation-sigma-and-explained-variance-r2"><i class="fa fa-check"></i><b>11.6</b> Residual standard deviation <span class="math inline">\(\sigma\)</span> and explained variance <span class="math inline">\(R^2\)</span></a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#difficulties-in-interpreting-residual-standard-deviation-and-explained-variance"><i class="fa fa-check"></i><b>11.6.1</b> Difficulties in interpreting residual standard deviation and explained variance</a></li>
<li class="chapter" data-level="11.6.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#bayesian-r2"><i class="fa fa-check"></i><b>11.6.2</b> Bayesian <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#external-validation-checking-fitted-model-on-new-data"><i class="fa fa-check"></i><b>11.7</b> External validation: checking fitted model on new data</a></li>
<li class="chapter" data-level="11.8" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#cross-validation"><i class="fa fa-check"></i><b>11.8</b> Cross validation</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>11.8.1</b> Leave-one-out cross validation</a></li>
<li class="chapter" data-level="11.8.2" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#fast-leave-one-out-cross-validation"><i class="fa fa-check"></i><b>11.8.2</b> Fast leave-one-out cross validation</a></li>
<li class="chapter" data-level="11.8.3" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#summarizing-prediction-error-using-the-log-score-and-deviance"><i class="fa fa-check"></i><b>11.8.3</b> Summarizing prediction error using the log score and deviance</a></li>
<li class="chapter" data-level="11.8.4" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#overfitting-and-aic"><i class="fa fa-check"></i><b>11.8.4</b> Overfitting and AIC</a></li>
<li class="chapter" data-level="11.8.5" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#interpreting-differences-in-log-scores"><i class="fa fa-check"></i><b>11.8.5</b> Interpreting differences in log scores</a></li>
<li class="chapter" data-level="11.8.6" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#demonstration-of-adding-pure-noise-predictors-to-a-model"><i class="fa fa-check"></i><b>11.8.6</b> Demonstration of adding pure noise predictors to a model</a></li>
<li class="chapter" data-level="11.8.7" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>11.8.7</b> <span class="math inline">\(K\)</span>-fold cross validation</a></li>
<li class="chapter" data-level="11.8.8" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#demonstration-of-k-fold-cross-validation-using-simulated-data"><i class="fa fa-check"></i><b>11.8.8</b> Demonstration of <span class="math inline">\(K\)</span>-fold cross validation using simulated data</a></li>
<li class="chapter" data-level="11.8.9" data-path="assumptions-diagnostics-and-model-evaluation.html"><a href="assumptions-diagnostics-and-model-evaluation.html#concerns-about-model-selection"><i class="fa fa-check"></i><b>11.8.9</b> Concerns about model selection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html"><i class="fa fa-check"></i><b>12</b> Transformations and regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#linear-transformations-2"><i class="fa fa-check"></i><b>12.1</b> Linear transformations</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#scaling-of-predictors-and-regression-coefficients"><i class="fa fa-check"></i><b>12.1.1</b> Scaling of predictors and regression coefficients</a></li>
<li class="chapter" data-level="12.1.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardization-using-z-scores"><i class="fa fa-check"></i><b>12.1.2</b> Standardization using z-scores</a></li>
<li class="chapter" data-level="12.1.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardization-using-an-externally-specified-population-distribution"><i class="fa fa-check"></i><b>12.1.3</b> Standardization using an externally specified population distribution</a></li>
<li class="chapter" data-level="12.1.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardization-using-reasonable-scales"><i class="fa fa-check"></i><b>12.1.4</b> Standardization using reasonable scales</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#centering-and-standardizing-for-models-with-interactions"><i class="fa fa-check"></i><b>12.2</b> Centering and standardizing for models with interactions</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#centering-by-subtracting-the-mean-of-the-data"><i class="fa fa-check"></i><b>12.2.1</b> Centering by subtracting the mean of the data</a></li>
<li class="chapter" data-level="12.2.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-a-conventional-centering-point"><i class="fa fa-check"></i><b>12.2.2</b> Using a conventional centering point</a></li>
<li class="chapter" data-level="12.2.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#standardizing-by-subtracting-the-mean-and-dividing-by-2-standard-deviations"><i class="fa fa-check"></i><b>12.2.3</b> Standardizing by subtracting the mean and dividing by 2 standard deviations</a></li>
<li class="chapter" data-level="12.2.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#why-scale-by-2-standard-deviations"><i class="fa fa-check"></i><b>12.2.4</b> Why scale by 2 standard deviations?</a></li>
<li class="chapter" data-level="12.2.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#multiplying-each-regression-coefficient-by-2-standard-deviations-of-its-predictor"><i class="fa fa-check"></i><b>12.2.5</b> Multiplying each regression coefficient by 2 standard deviations of its predictor</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#correlation-and-regression-to-the-mean"><i class="fa fa-check"></i><b>12.3</b> Correlation and “regression to the mean”</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#the-principal-component-line-and-the-regression-line"><i class="fa fa-check"></i><b>12.3.1</b> The principal component line and the regression line</a></li>
<li class="chapter" data-level="12.3.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#regression-to-the-mean"><i class="fa fa-check"></i><b>12.3.2</b> Regression to the mean</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#logarithmic-transformations"><i class="fa fa-check"></i><b>12.4</b> Logarithmic transformations</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#earnings-and-height-example"><i class="fa fa-check"></i><b>12.4.1</b> Earnings and height example</a></li>
<li class="chapter" data-level="12.4.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#why-we-use-natural-log-rather-than-log-base-10"><i class="fa fa-check"></i><b>12.4.2</b> Why we use natural log rather than log base 10</a></li>
<li class="chapter" data-level="12.4.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#building-a-regression-model-on-the-log-scale"><i class="fa fa-check"></i><b>12.4.3</b> Building a regression model on the log scale</a></li>
<li class="chapter" data-level="12.4.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#further-difficulties-in-interpretation"><i class="fa fa-check"></i><b>12.4.4</b> Further difficulties in interpretation</a></li>
<li class="chapter" data-level="12.4.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#log-log-model-transforming-the-input-and-outcome-variables"><i class="fa fa-check"></i><b>12.4.5</b> Log-log model: transforming the input and outcome variables</a></li>
<li class="chapter" data-level="12.4.6" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#taking-logarithms-even-when-not-necessary"><i class="fa fa-check"></i><b>12.4.6</b> Taking logarithms even when not necessary</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#other-transformations"><i class="fa fa-check"></i><b>12.5</b> Other transformations</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#square-root-transformations"><i class="fa fa-check"></i><b>12.5.1</b> Square root transformations</a></li>
<li class="chapter" data-level="12.5.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#idiosyncratic-transformations"><i class="fa fa-check"></i><b>12.5.2</b> Idiosyncratic transformations</a></li>
<li class="chapter" data-level="12.5.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-continuous-rather-than-discrete-predictors"><i class="fa fa-check"></i><b>12.5.3</b> Using continuous rather than discrete predictors</a></li>
<li class="chapter" data-level="12.5.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-discrete-rather-than-continuous-predictors"><i class="fa fa-check"></i><b>12.5.4</b> Using discrete rather than continuous predictors</a></li>
<li class="chapter" data-level="12.5.5" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#index-and-indicator-variables"><i class="fa fa-check"></i><b>12.5.5</b> Index and indicator variables</a></li>
<li class="chapter" data-level="12.5.6" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#indicator-variables-identifiability-and-the-baseline-condition"><i class="fa fa-check"></i><b>12.5.6</b> Indicator variables, identifiability, and the baseline condition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#building-and-comparing-regression-models-for-prediction"><i class="fa fa-check"></i><b>12.6</b> Building and comparing regression models for prediction</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#general-principles"><i class="fa fa-check"></i><b>12.6.1</b> General principles</a></li>
<li class="chapter" data-level="12.6.2" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#example-predicting-the-yields-of-mesquite-bushes"><i class="fa fa-check"></i><b>12.6.2</b> Example: predicting the yields of mesquite bushes</a></li>
<li class="chapter" data-level="12.6.3" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#using-the-jacobian-to-adjust-the-predictive-comparison-after-a-transformation"><i class="fa fa-check"></i><b>12.6.3</b> Using the Jacobian to adjust the predictive comparison after a transformation</a></li>
<li class="chapter" data-level="12.6.4" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#constructing-a-simpler-model"><i class="fa fa-check"></i><b>12.6.4</b> Constructing a simpler model</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#models-for-regression-coefficients"><i class="fa fa-check"></i><b>12.7</b> Models for regression coefficients</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="transformations-and-regression.html"><a href="transformations-and-regression.html#other-models-for-regression-coefficients"><i class="fa fa-check"></i><b>12.7.1</b> Other models for regression coefficients</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>13</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="13.1" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-a-single-predictor"><i class="fa fa-check"></i><b>13.1</b> Logistic regression with a single predictor</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#example-modeling-political-preference-given-income"><i class="fa fa-check"></i><b>13.1.1</b> Example: modeling political preference given income</a></li>
<li class="chapter" data-level="13.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#the-logistic-regression-model"><i class="fa fa-check"></i><b>13.1.2</b> The logistic regression model</a></li>
<li class="chapter" data-level="13.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#fitting-the-model-using-stan_glm-and-displaying-uncertainty-in-the-fitted-model"><i class="fa fa-check"></i><b>13.1.3</b> Fitting the model using stan_glm and displaying uncertainty in the fitted model</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="logistic-regression.html"><a href="logistic-regression.html#interpreting-logistic-regression-coefficients-and-the-divide-by-4-rule"><i class="fa fa-check"></i><b>13.2</b> Interpreting logistic regression coefficients and the divide-by-4 rule</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#evaluation-at-and-near-the-mean-of-the-data"><i class="fa fa-check"></i><b>13.2.1</b> Evaluation at and near the mean of the data</a></li>
<li class="chapter" data-level="13.2.2" data-path="logistic-regression.html"><a href="logistic-regression.html#the-divide-by-4-rule"><i class="fa fa-check"></i><b>13.2.2</b> The divide-by-4 rule</a></li>
<li class="chapter" data-level="13.2.3" data-path="logistic-regression.html"><a href="logistic-regression.html#interpretation-of-coefficients-as-odds-ratios"><i class="fa fa-check"></i><b>13.2.3</b> Interpretation of coefficients as odds ratios</a></li>
<li class="chapter" data-level="13.2.4" data-path="logistic-regression.html"><a href="logistic-regression.html#coefficient-estimates-and-standard-errors"><i class="fa fa-check"></i><b>13.2.4</b> Coefficient estimates and standard errors</a></li>
<li class="chapter" data-level="13.2.5" data-path="logistic-regression.html"><a href="logistic-regression.html#statistical-significance-1"><i class="fa fa-check"></i><b>13.2.5</b> Statistical significance</a></li>
<li class="chapter" data-level="13.2.6" data-path="logistic-regression.html"><a href="logistic-regression.html#displaying-the-results-of-several-logistic-regressions"><i class="fa fa-check"></i><b>13.2.6</b> Displaying the results of several logistic regressions</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="logistic-regression.html"><a href="logistic-regression.html#predictions-and-comparisons"><i class="fa fa-check"></i><b>13.3</b> Predictions and comparisons</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#point-prediction-using-predict-1"><i class="fa fa-check"></i><b>13.3.1</b> Point prediction using <code>predict</code></a></li>
<li class="chapter" data-level="13.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#linear-predictor-with-uncertainty-using-posterior_linpred"><i class="fa fa-check"></i><b>13.3.2</b> Linear predictor with uncertainty using <code>posterior_linpred</code></a></li>
<li class="chapter" data-level="13.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#expected-outcome-with-uncertainty-using-posterior_epred"><i class="fa fa-check"></i><b>13.3.3</b> Expected outcome with uncertainty using <code>posterior_epred</code></a></li>
<li class="chapter" data-level="13.3.4" data-path="logistic-regression.html"><a href="logistic-regression.html#predictive-distribution-for-a-new-observation-using-posterior_predict-1"><i class="fa fa-check"></i><b>13.3.4</b> Predictive distribution for a new observation using <code>posterior_predict</code></a></li>
<li class="chapter" data-level="13.3.5" data-path="logistic-regression.html"><a href="logistic-regression.html#prediction-given-a-range-of-input-values-1"><i class="fa fa-check"></i><b>13.3.5</b> Prediction given a range of input values</a></li>
<li class="chapter" data-level="13.3.6" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-just-an-intercept"><i class="fa fa-check"></i><b>13.3.6</b> Logistic regression with just an intercept</a></li>
<li class="chapter" data-level="13.3.7" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-a-single-binary-predictor"><i class="fa fa-check"></i><b>13.3.7</b> Logistic regression with a single binary predictor</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="logistic-regression.html"><a href="logistic-regression.html#latent-data-formulation"><i class="fa fa-check"></i><b>13.4</b> Latent-data formulation</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#interpretation-of-the-latent-variables"><i class="fa fa-check"></i><b>13.4.1</b> Interpretation of the latent variables</a></li>
<li class="chapter" data-level="13.4.2" data-path="logistic-regression.html"><a href="logistic-regression.html#nonidentifiability-of-the-latent-scale-parameter"><i class="fa fa-check"></i><b>13.4.2</b> Nonidentifiability of the latent scale parameter</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="logistic-regression.html"><a href="logistic-regression.html#maximum-likelihood-and-bayesian-inference-for-logistic-regression"><i class="fa fa-check"></i><b>13.5</b> Maximum likelihood and Bayesian inference for logistic regression</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="logistic-regression.html"><a href="logistic-regression.html#maximum-likelihood-using-iteratively-weighted-least-squares"><i class="fa fa-check"></i><b>13.5.1</b> Maximum likelihood using iteratively weighted least squares</a></li>
<li class="chapter" data-level="13.5.2" data-path="logistic-regression.html"><a href="logistic-regression.html#bayesian-inference-with-a-uniform-prior-distribution"><i class="fa fa-check"></i><b>13.5.2</b> Bayesian inference with a uniform prior distribution</a></li>
<li class="chapter" data-level="13.5.3" data-path="logistic-regression.html"><a href="logistic-regression.html#default-prior-in-stan_glm"><i class="fa fa-check"></i><b>13.5.3</b> Default prior in <code>stan_glm</code></a></li>
<li class="chapter" data-level="13.5.4" data-path="logistic-regression.html"><a href="logistic-regression.html#bayesian-inference-with-some-prior-information"><i class="fa fa-check"></i><b>13.5.4</b> Bayesian inference with some prior information</a></li>
<li class="chapter" data-level="13.5.5" data-path="logistic-regression.html"><a href="logistic-regression.html#comparing-maximum-likelihood-and-bayesian-inference-using-a-simulation-study"><i class="fa fa-check"></i><b>13.5.5</b> Comparing maximum likelihood and Bayesian inference using a simulation study</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="logistic-regression.html"><a href="logistic-regression.html#cross-validation-and-log-score-for-logistic-regression"><i class="fa fa-check"></i><b>13.6</b> Cross validation and log score for logistic regression</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#understanding-the-log-score-for-discrete-predictions"><i class="fa fa-check"></i><b>13.6.1</b> Understanding the log score for discrete predictions</a></li>
<li class="chapter" data-level="13.6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#log-score-for-logistic-regression"><i class="fa fa-check"></i><b>13.6.2</b> Log score for logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>14</b> Simulation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="simulation-1.html"><a href="simulation-1.html#simulation-of-discrete-probability-models-1"><i class="fa fa-check"></i><b>14.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="simulation-1.html"><a href="simulation-1.html#how-many-girls-in-400-births-1"><i class="fa fa-check"></i><b>14.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="14.1.2" data-path="simulation-1.html"><a href="simulation-1.html#accounting-for-twins-1"><i class="fa fa-check"></i><b>14.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="simulation-1.html"><a href="simulation-1.html#simulation-of-continuous-and-mixed-discretecontinuous-models-1"><i class="fa fa-check"></i><b>14.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="simulation-1.html"><a href="simulation-1.html#simulation-in-r-using-custom-made-functions-1"><i class="fa fa-check"></i><b>14.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="simulation-1.html"><a href="simulation-1.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-1"><i class="fa fa-check"></i><b>14.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="14.4" data-path="simulation-1.html"><a href="simulation-1.html#bootstrapping-to-simulate-a-sampling-distribution-1"><i class="fa fa-check"></i><b>14.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="simulation-1.html"><a href="simulation-1.html#choices-in-defining-the-bootstrap-distribution-1"><i class="fa fa-check"></i><b>14.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="14.4.2" data-path="simulation-1.html"><a href="simulation-1.html#limitations-of-bootstrapping-1"><i class="fa fa-check"></i><b>14.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="simulation-1.html"><a href="simulation-1.html#fake-data-simulation-as-a-way-of-life-1"><i class="fa fa-check"></i><b>14.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>15</b> Simulation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="simulation-2.html"><a href="simulation-2.html#simulation-of-discrete-probability-models-2"><i class="fa fa-check"></i><b>15.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="simulation-2.html"><a href="simulation-2.html#how-many-girls-in-400-births-2"><i class="fa fa-check"></i><b>15.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="15.1.2" data-path="simulation-2.html"><a href="simulation-2.html#accounting-for-twins-2"><i class="fa fa-check"></i><b>15.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="simulation-2.html"><a href="simulation-2.html#simulation-of-continuous-and-mixed-discretecontinuous-models-2"><i class="fa fa-check"></i><b>15.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="simulation-2.html"><a href="simulation-2.html#simulation-in-r-using-custom-made-functions-2"><i class="fa fa-check"></i><b>15.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="simulation-2.html"><a href="simulation-2.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-2"><i class="fa fa-check"></i><b>15.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="15.4" data-path="simulation-2.html"><a href="simulation-2.html#bootstrapping-to-simulate-a-sampling-distribution-2"><i class="fa fa-check"></i><b>15.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="simulation-2.html"><a href="simulation-2.html#choices-in-defining-the-bootstrap-distribution-2"><i class="fa fa-check"></i><b>15.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="15.4.2" data-path="simulation-2.html"><a href="simulation-2.html#limitations-of-bootstrapping-2"><i class="fa fa-check"></i><b>15.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="simulation-2.html"><a href="simulation-2.html#fake-data-simulation-as-a-way-of-life-2"><i class="fa fa-check"></i><b>15.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="simulation-3.html"><a href="simulation-3.html"><i class="fa fa-check"></i><b>16</b> Simulation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="simulation-3.html"><a href="simulation-3.html#simulation-of-discrete-probability-models-3"><i class="fa fa-check"></i><b>16.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="simulation-3.html"><a href="simulation-3.html#how-many-girls-in-400-births-3"><i class="fa fa-check"></i><b>16.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="16.1.2" data-path="simulation-3.html"><a href="simulation-3.html#accounting-for-twins-3"><i class="fa fa-check"></i><b>16.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="simulation-3.html"><a href="simulation-3.html#simulation-of-continuous-and-mixed-discretecontinuous-models-3"><i class="fa fa-check"></i><b>16.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="simulation-3.html"><a href="simulation-3.html#simulation-in-r-using-custom-made-functions-3"><i class="fa fa-check"></i><b>16.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="simulation-3.html"><a href="simulation-3.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-3"><i class="fa fa-check"></i><b>16.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="16.4" data-path="simulation-3.html"><a href="simulation-3.html#bootstrapping-to-simulate-a-sampling-distribution-3"><i class="fa fa-check"></i><b>16.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="simulation-3.html"><a href="simulation-3.html#choices-in-defining-the-bootstrap-distribution-3"><i class="fa fa-check"></i><b>16.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="16.4.2" data-path="simulation-3.html"><a href="simulation-3.html#limitations-of-bootstrapping-3"><i class="fa fa-check"></i><b>16.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="simulation-3.html"><a href="simulation-3.html#fake-data-simulation-as-a-way-of-life-3"><i class="fa fa-check"></i><b>16.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="simulation-4.html"><a href="simulation-4.html"><i class="fa fa-check"></i><b>17</b> Simulation</a>
<ul>
<li class="chapter" data-level="17.1" data-path="simulation-4.html"><a href="simulation-4.html#simulation-of-discrete-probability-models-4"><i class="fa fa-check"></i><b>17.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="simulation-4.html"><a href="simulation-4.html#how-many-girls-in-400-births-4"><i class="fa fa-check"></i><b>17.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="17.1.2" data-path="simulation-4.html"><a href="simulation-4.html#accounting-for-twins-4"><i class="fa fa-check"></i><b>17.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="simulation-4.html"><a href="simulation-4.html#simulation-of-continuous-and-mixed-discretecontinuous-models-4"><i class="fa fa-check"></i><b>17.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="simulation-4.html"><a href="simulation-4.html#simulation-in-r-using-custom-made-functions-4"><i class="fa fa-check"></i><b>17.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="simulation-4.html"><a href="simulation-4.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-4"><i class="fa fa-check"></i><b>17.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="17.4" data-path="simulation-4.html"><a href="simulation-4.html#bootstrapping-to-simulate-a-sampling-distribution-4"><i class="fa fa-check"></i><b>17.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="simulation-4.html"><a href="simulation-4.html#choices-in-defining-the-bootstrap-distribution-4"><i class="fa fa-check"></i><b>17.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="17.4.2" data-path="simulation-4.html"><a href="simulation-4.html#limitations-of-bootstrapping-4"><i class="fa fa-check"></i><b>17.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="simulation-4.html"><a href="simulation-4.html#fake-data-simulation-as-a-way-of-life-4"><i class="fa fa-check"></i><b>17.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="simulation-5.html"><a href="simulation-5.html"><i class="fa fa-check"></i><b>18</b> Simulation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="simulation-5.html"><a href="simulation-5.html#simulation-of-discrete-probability-models-5"><i class="fa fa-check"></i><b>18.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="simulation-5.html"><a href="simulation-5.html#how-many-girls-in-400-births-5"><i class="fa fa-check"></i><b>18.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="18.1.2" data-path="simulation-5.html"><a href="simulation-5.html#accounting-for-twins-5"><i class="fa fa-check"></i><b>18.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="simulation-5.html"><a href="simulation-5.html#simulation-of-continuous-and-mixed-discretecontinuous-models-5"><i class="fa fa-check"></i><b>18.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="simulation-5.html"><a href="simulation-5.html#simulation-in-r-using-custom-made-functions-5"><i class="fa fa-check"></i><b>18.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="simulation-5.html"><a href="simulation-5.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-5"><i class="fa fa-check"></i><b>18.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="18.4" data-path="simulation-5.html"><a href="simulation-5.html#bootstrapping-to-simulate-a-sampling-distribution-5"><i class="fa fa-check"></i><b>18.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="simulation-5.html"><a href="simulation-5.html#choices-in-defining-the-bootstrap-distribution-5"><i class="fa fa-check"></i><b>18.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="18.4.2" data-path="simulation-5.html"><a href="simulation-5.html#limitations-of-bootstrapping-5"><i class="fa fa-check"></i><b>18.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="simulation-5.html"><a href="simulation-5.html#fake-data-simulation-as-a-way-of-life-5"><i class="fa fa-check"></i><b>18.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="simulation-6.html"><a href="simulation-6.html"><i class="fa fa-check"></i><b>19</b> Simulation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="simulation-6.html"><a href="simulation-6.html#simulation-of-discrete-probability-models-6"><i class="fa fa-check"></i><b>19.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="simulation-6.html"><a href="simulation-6.html#how-many-girls-in-400-births-6"><i class="fa fa-check"></i><b>19.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="19.1.2" data-path="simulation-6.html"><a href="simulation-6.html#accounting-for-twins-6"><i class="fa fa-check"></i><b>19.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="simulation-6.html"><a href="simulation-6.html#simulation-of-continuous-and-mixed-discretecontinuous-models-6"><i class="fa fa-check"></i><b>19.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="simulation-6.html"><a href="simulation-6.html#simulation-in-r-using-custom-made-functions-6"><i class="fa fa-check"></i><b>19.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="simulation-6.html"><a href="simulation-6.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-6"><i class="fa fa-check"></i><b>19.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="19.4" data-path="simulation-6.html"><a href="simulation-6.html#bootstrapping-to-simulate-a-sampling-distribution-6"><i class="fa fa-check"></i><b>19.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="simulation-6.html"><a href="simulation-6.html#choices-in-defining-the-bootstrap-distribution-6"><i class="fa fa-check"></i><b>19.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="19.4.2" data-path="simulation-6.html"><a href="simulation-6.html#limitations-of-bootstrapping-6"><i class="fa fa-check"></i><b>19.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="simulation-6.html"><a href="simulation-6.html#fake-data-simulation-as-a-way-of-life-6"><i class="fa fa-check"></i><b>19.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simulation-7.html"><a href="simulation-7.html"><i class="fa fa-check"></i><b>20</b> Simulation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="simulation-7.html"><a href="simulation-7.html#simulation-of-discrete-probability-models-7"><i class="fa fa-check"></i><b>20.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="simulation-7.html"><a href="simulation-7.html#how-many-girls-in-400-births-7"><i class="fa fa-check"></i><b>20.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="20.1.2" data-path="simulation-7.html"><a href="simulation-7.html#accounting-for-twins-7"><i class="fa fa-check"></i><b>20.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="simulation-7.html"><a href="simulation-7.html#simulation-of-continuous-and-mixed-discretecontinuous-models-7"><i class="fa fa-check"></i><b>20.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="simulation-7.html"><a href="simulation-7.html#simulation-in-r-using-custom-made-functions-7"><i class="fa fa-check"></i><b>20.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="simulation-7.html"><a href="simulation-7.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-7"><i class="fa fa-check"></i><b>20.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="20.4" data-path="simulation-7.html"><a href="simulation-7.html#bootstrapping-to-simulate-a-sampling-distribution-7"><i class="fa fa-check"></i><b>20.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="simulation-7.html"><a href="simulation-7.html#choices-in-defining-the-bootstrap-distribution-7"><i class="fa fa-check"></i><b>20.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="20.4.2" data-path="simulation-7.html"><a href="simulation-7.html#limitations-of-bootstrapping-7"><i class="fa fa-check"></i><b>20.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="simulation-7.html"><a href="simulation-7.html#fake-data-simulation-as-a-way-of-life-7"><i class="fa fa-check"></i><b>20.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="simulation-8.html"><a href="simulation-8.html"><i class="fa fa-check"></i><b>21</b> Simulation</a>
<ul>
<li class="chapter" data-level="21.1" data-path="simulation-8.html"><a href="simulation-8.html#simulation-of-discrete-probability-models-8"><i class="fa fa-check"></i><b>21.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="simulation-8.html"><a href="simulation-8.html#how-many-girls-in-400-births-8"><i class="fa fa-check"></i><b>21.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="21.1.2" data-path="simulation-8.html"><a href="simulation-8.html#accounting-for-twins-8"><i class="fa fa-check"></i><b>21.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="simulation-8.html"><a href="simulation-8.html#simulation-of-continuous-and-mixed-discretecontinuous-models-8"><i class="fa fa-check"></i><b>21.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="simulation-8.html"><a href="simulation-8.html#simulation-in-r-using-custom-made-functions-8"><i class="fa fa-check"></i><b>21.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="simulation-8.html"><a href="simulation-8.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-8"><i class="fa fa-check"></i><b>21.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="21.4" data-path="simulation-8.html"><a href="simulation-8.html#bootstrapping-to-simulate-a-sampling-distribution-8"><i class="fa fa-check"></i><b>21.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="simulation-8.html"><a href="simulation-8.html#choices-in-defining-the-bootstrap-distribution-8"><i class="fa fa-check"></i><b>21.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="21.4.2" data-path="simulation-8.html"><a href="simulation-8.html#limitations-of-bootstrapping-8"><i class="fa fa-check"></i><b>21.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="simulation-8.html"><a href="simulation-8.html#fake-data-simulation-as-a-way-of-life-8"><i class="fa fa-check"></i><b>21.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="simulation-9.html"><a href="simulation-9.html"><i class="fa fa-check"></i><b>22</b> Simulation</a>
<ul>
<li class="chapter" data-level="22.1" data-path="simulation-9.html"><a href="simulation-9.html#simulation-of-discrete-probability-models-9"><i class="fa fa-check"></i><b>22.1</b> Simulation of discrete probability models</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="simulation-9.html"><a href="simulation-9.html#how-many-girls-in-400-births-9"><i class="fa fa-check"></i><b>22.1.1</b> How many girls in 400 births?</a></li>
<li class="chapter" data-level="22.1.2" data-path="simulation-9.html"><a href="simulation-9.html#accounting-for-twins-9"><i class="fa fa-check"></i><b>22.1.2</b> Accounting for twins</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="simulation-9.html"><a href="simulation-9.html#simulation-of-continuous-and-mixed-discretecontinuous-models-9"><i class="fa fa-check"></i><b>22.2</b> Simulation of continuous and mixed discrete/continuous models</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="simulation-9.html"><a href="simulation-9.html#simulation-in-r-using-custom-made-functions-9"><i class="fa fa-check"></i><b>22.2.1</b> Simulation in R using custom-made functions</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="simulation-9.html"><a href="simulation-9.html#summarizing-a-set-of-simulations-using-median-and-median-absolute-deviation-9"><i class="fa fa-check"></i><b>22.3</b> Summarizing a set of simulations using median and median absolute deviation</a></li>
<li class="chapter" data-level="22.4" data-path="simulation-9.html"><a href="simulation-9.html#bootstrapping-to-simulate-a-sampling-distribution-9"><i class="fa fa-check"></i><b>22.4</b> Bootstrapping to simulate a sampling distribution</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="simulation-9.html"><a href="simulation-9.html#choices-in-defining-the-bootstrap-distribution-9"><i class="fa fa-check"></i><b>22.4.1</b> Choices in defining the bootstrap distribution</a></li>
<li class="chapter" data-level="22.4.2" data-path="simulation-9.html"><a href="simulation-9.html#limitations-of-bootstrapping-9"><i class="fa fa-check"></i><b>22.4.2</b> Limitations of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="simulation-9.html"><a href="simulation-9.html#fake-data-simulation-as-a-way-of-life-9"><i class="fa fa-check"></i><b>22.5</b> Fake-data simulation as a way of life</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html"><i class="fa fa-check"></i><b>23</b> Exercises of Regression and Other Stories</a>
<ul>
<li class="chapter" data-level="23.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#overview-1"><i class="fa fa-check"></i><b>23.1</b> Overview</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#from-design-to-decision"><i class="fa fa-check"></i><b>23.1.1</b> From design to decision</a></li>
<li class="chapter" data-level="23.1.2" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#sketching-a-regression-model-and-data"><i class="fa fa-check"></i><b>23.1.2</b> Sketching a regression model and data</a></li>
<li class="chapter" data-level="23.1.3" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#goals-of-regression"><i class="fa fa-check"></i><b>23.1.3</b> Goals of regression</a></li>
<li class="chapter" data-level="23.1.4" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#problems-of-statistics"><i class="fa fa-check"></i><b>23.1.4</b> Problems of statistics</a></li>
<li class="chapter" data-level="23.1.5" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#goals-of-regression-1"><i class="fa fa-check"></i><b>23.1.5</b> Goals of regression</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#causal-inference-1"><i class="fa fa-check"></i><b>23.2</b> Causal inference</a></li>
<li class="chapter" data-level="23.3" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#statistics-as-generalization"><i class="fa fa-check"></i><b>23.3</b> Statistics as generalization</a></li>
<li class="chapter" data-level="23.4" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#statistics-as-generalization-1"><i class="fa fa-check"></i><b>23.4</b> Statistics as generalization</a></li>
<li class="chapter" data-level="23.5" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#a-problem-with-linear-models"><i class="fa fa-check"></i><b>23.5</b> A problem with linear models</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#working-through-your-own-example"><i class="fa fa-check"></i><b>23.5.1</b> Working through your own example</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#some-basic-methods-in-mathematics-and-probability-1"><i class="fa fa-check"></i><b>23.6</b> Some basic methods in mathematics and probability</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#weighted-averages-2"><i class="fa fa-check"></i><b>23.6.1</b> Weighted averages</a></li>
<li class="chapter" data-level="23.6.2" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#weighted-averages-3"><i class="fa fa-check"></i><b>23.6.2</b> Weighted averages</a></li>
<li class="chapter" data-level="23.6.3" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#probability-distributions-1"><i class="fa fa-check"></i><b>23.6.3</b> Probability distributions</a></li>
<li class="chapter" data-level="23.6.4" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#probability-distributions-2"><i class="fa fa-check"></i><b>23.6.4</b> Probability distributions</a></li>
<li class="chapter" data-level="23.6.5" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#probability-distributions-3"><i class="fa fa-check"></i><b>23.6.5</b> Probability distributions</a></li>
<li class="chapter" data-level="23.6.6" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#linear-transformations-3"><i class="fa fa-check"></i><b>23.6.6</b> Linear transformations</a></li>
<li class="chapter" data-level="23.6.7" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#linear-transformations-4"><i class="fa fa-check"></i><b>23.6.7</b> Linear transformations</a></li>
<li class="chapter" data-level="23.6.8" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#correlated-random-variables"><i class="fa fa-check"></i><b>23.6.8</b> Correlated random variables</a></li>
<li class="chapter" data-level="23.6.9" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#comparison-of-distributions"><i class="fa fa-check"></i><b>23.6.9</b> Comparison of distributions</a></li>
<li class="chapter" data-level="23.6.10" data-path="exercises-of-regression-and-other-stories.html"><a href="exercises-of-regression-and-other-stories.html#working-through-your-own-example-1"><i class="fa fa-check"></i><b>23.6.10</b> Working through your own example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reading Notes for Regression and Other Stories</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="assumptions-diagnostics-and-model-evaluation" class="section level1" number="11">
<h1><span class="header-section-number">Chapter 11</span> Assumptions, diagnostics, and model evaluation</h1>
<p>이 챕터에서는 회귀모델의 가정과 그 가정들이 합당한지에 대해 평가할 수 있는 진단에 대해 살펴본다.</p>
<ul>
<li><p>가장 중요한 가정은 연구대상에 대한 연구자의 지식이며, 가용한 데이터 하나만을 가지고 가정을 직접적으로 검증할 수 없다.</p></li>
<li><p>모델의 바탕에 놓은 개념들을 이해하고, 실제 세계와 시뮬레이션된 데이터의 사례들의 맥락 속에서 방법들을 발전시키는 것이 필요하다.</p></li>
</ul>
<p><span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020</a>)</span> 은 적합된 모델로부터 예측 시뮬레이션에 기초한 진단을 통해 여러 예측변수를 포함한 회귀모델을 구축하고, 해석하고, 평가하는 데 사용할 일련의 도구들을 제시하고자 한다.</p>
<div id="assumptions-of-regression-analysis" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Assumptions of regression analysis</h2>
<p><span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020, 153</a>)</span> 는 중요도 순으로 회귀모델의 가정들을 나열하고 있다.</p>
<ol style="list-style-type: decimal">
<li><p><em>타당성(Validity)</em></p>
<ul>
<li><p>분석에 사용하는 데이터가 풀고자 하는 연구문제와 들어맞는 것이어야 한다.</p></li>
<li><p>결과변수는 우리가 풀고자 하는/관심을 가지는 현상을 정확하게 반영하여 측정하여야 하고, 모델은 모든 적절한 예측변수들을 포함해야 한다는 것을 의미한다.</p></li>
<li><p>나아가 모델은 적용되는 사례들에 대해 일반화할 수 있어야 한다.</p></li>
<li><p>회귀모델에 어떤 변수들을 넣을지 결정하는 것은 종종 분석에 있어서 가장 까다로운 문제이다.</p>
<ul>
<li>적절한 모든 예측변수들을 포함할 것을 권하지만 과연 어떤 변수가 필수적인지를 결정하는 것과 표준오차가 큰 계수값의 결과를 해석하는 것은 어려운 문제이다.</li>
</ul></li>
<li><p>경험과학 연구에서 사용되는 데이터들은 표본과 모집단 간의 대표성을 확보하기 어렵다. 그러나 이러한 목표를 지향하는 것은 연구자가 신뢰할만한 답을 할 수 있는 혹은 할 수 없는 유형의 연구문제에 대해 보다 정확한 견해를 취할 수 있도록 한다.</p></li>
</ul></li>
<li><p><em>대표성(representativeness)</em></p>
<ul>
<li><p>연구자는 데이터에 회귀모델을 적합하여 보다 큰 모집단에 대한 추론을 이끌어내는 데 사용한다.</p></li>
<li><p>이때, 회귀계수를 해석하는 데 있어서의 묵시적 가정은 표본이 모집단의 대표적 사례라는 것이다.</p>
<ul>
<li><p>우리가 가지고 있는 표본, 데이터는 [모집단에서] 모델에 포함된 예측변수들 <span class="math inline">\(x_1, x_2, \dots, x_n\)</span>이 주어졌을 때의 결과변수, <span class="math inline">\(y\)</span>의 분포를 대표하는 것이라는 가정이다.</p></li>
<li><p>이러한 가정은 연구자로 하여금 가급적 예측변수들을 더 많이 모델에 포하하여 대표성의 가정을 충족시키고자 하는 유인이 된다.</p></li>
<li><p>우리는 모집단을 직접 관측할 수 없기 때문에, 결과변수에 영향을 미칠 것으로 기대되는 변수라면 가능한 한 모델에 포함하고자 하는 합당한 유인을 가지게 되는 것이다.</p></li>
</ul></li>
<li><p>대표성이란 기존에 표본으로 간주되던 데이터가 아닌 경우에도 동일하게 적용된다.</p>
<ul>
<li><p>예를 들어, Section 7.1 에서 16개의 연속적인 선거에 대한 데이터를 다루는 예측 모델을 생각해보자.</p></li>
<li><p>그 데이터들은 공통된 모집단으로부터 얻은 표본이 아니지만, 우리는 그 모델을 통해 미래의 선거를 예측하고자 하는 목적을 가진다.</p></li>
<li><p>미래의 선거를 예측하기 위해 과거 데이터에 회귀모델을 적합하는 것은 수학적으로 관측된 데이터를 가설적인 초모집단(hypothetical superpopulation)으로부터 무작위로 표집한 하나의 표본으로서의 새로운 결과(데이터)와 동일시하는 것이다.</p></li>
<li><p>즉, 오차를 정규오차분포로부터 도출된 무작위 표본으로 간주하는 것이다.</p></li>
</ul></li>
<li><p>어디까지나 일반화(generalization)으로부터 자유롭지 못하다면, 통계적 표집의 개념을 염두에 두어야 하고, 우리가 추론을 이끌어내고자 하는 묵시적/명시적 모집단에 대한 표본의 대표성의 문제 역시 생각해야만 한다.</p></li>
</ul></li>
<li><p><em>가산성과 선형성(additivity and linearity)</em></p>
<ul>
<li><p>수리적으로 선형회귀모델의 가장 중요한 가정은 바로 서로 분리된 예측변수들에 대한 선형 함수의 결정적 요인들(deterministic components)이다: <span class="math inline">\(y = \beta_0 + \beta_1x_1 + \beta_2x_2 + \cdots .\)</span></p></li>
<li><p>가산성이 위배된다면, 데이터를 변환하거나(만약 <span class="math inline">\(y = abc\)</span>라면 <span class="math inline">\(\log y = \log a + \log b + \log c\)</span>) 상호작용을 더하는 것을 고려해볼 수 있다.</p></li>
<li><p>선형성이 위배된다면 예측변수들은 단순히 선형적으로 배열되는 것이 아니라 <span class="math inline">\(1/x\)</span>나 <span class="math inline">\(\log(x)\)</span>의 형태로 투입될 수 있다.</p></li>
<li><p>연구문제들이 비선형적일 수 있지만, 선형회귀모델은 여전히 평균적인 관계 양상을 추정하는 데 있어서 유용할 수 있다.</p>
<ul>
<li>데이터를 더 많이 얻을수록, 그리고 우리가 가진 연구문제가 비선형적일수록, 모델에 비선형성을 반영하려는 노력이 필요해진다.</li>
</ul></li>
</ul></li>
<li><p><em>오차의 독립성(independence of errors)</em></p>
<ul>
<li><p>단순선형회귀모델은 예측선으로부터의 오차는 서로 독립적이라고 가정하며, 이 가정은 시계열/공간/멀티레벨의 조건에서 위배된다.</p>
<ul>
<li>시계열에서는 자기상관(autocorrelation), 공간분석에서는 동시상관(contemporaneous correlation), 멀티레벨에서는 레벨 간 상관 등의 문제로 독립성이 위배될 수 있다.</li>
</ul></li>
</ul></li>
<li><p><em>오차의 등분산(equal variance of errors)</em></p>
<ul>
<li><p>오차의 분산이 동일하지 않을 때, 등분산성(equal variance or homoscedasticity)과 대조되는 개념으로 이분산성(heteroscedasticity)이라고 한다.</p></li>
<li><p>오차의 이분산성은 회귀모델을 통해 확률적 예측을 수행할 때 문제가 될 수 있다.</p></li>
<li><p>하지만 오차의 이분산성은 예측 그 자체의 정확성에는 영향을 미치지 않는다.</p>
<ul>
<li>즉, 계수값 그 자체를 왜곡시키거나 하는 문제는 아니다.</li>
</ul></li>
<li><p>오차의 이분산성이 존재할 때는 가중치를 부여한 최소자승법을 통해 모델을 더 효율적으로 추정하는 것이 가능하다.</p></li>
</ul></li>
<li><p><em>오차의 정규성(normality of errors)</em></p>
<ul>
<li><p>오차항의 분포는 데이터의 개별 관측치들을 예측할 때 중요하다.</p>
<ul>
<li><p>회귀선을 추정하고자 할 때, 정규성 가정은 전혀 중요하지 않다.</p></li>
<li><p>따라서 <span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020</a>)</span> 은 회귀 잔차의 정규성에 대한 진단을 추천하지는 않는다.</p></li>
<li><p>그보다 <span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020</a>)</span> 은 타당성, 대표성, 가산성, 선형성에 대한 가정을 더 중요하게 생각한다.</p></li>
</ul></li>
<li><p>보다 중요한 것은 오차항이 예측변수와 독립적이냐 아니냐 하는 것이다.</p>
<ul>
<li>만약 오차항과 예측변수가 서로 상관관계를 가지고 있다면, 이는 결과변수를 예측하기 위한 적절한 예측변수를 모델에 충분히 포함시키지 못한 결과일 수 있기 때문이다.</li>
</ul></li>
</ul></li>
</ol>
<div id="failures-of-the-assumptions" class="section level3" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Failures of the assumptions</h3>
<p>가정이 위배되었을 때는 어떻게 하는가?</p>
<ul>
<li><p>모델을 기존의 선형회귀모델에서 다른 관계양상을 설명할 수 있는 모델로 확장할 수 있다.</p></li>
<li><p>가정이 합당하도록 데이터 또는 모델을 바꾸는 것이 더 단순할 수 있다.</p>
<ul>
<li><p>데이터를 목적에 맞게 전처리하거나, 대표성 가정에 더 들어맞도록 예측변수를 추가하거나</p></li>
<li><p>비선형성을 포착하기 위한 상호작용항을 더하거나, 예측변수와 결과변수를 변환하여 가산모델(additive model)이 말이 될 수 있도록 할 수 있다.</p></li>
</ul></li>
</ul>
<p>실질적으로 연구자는 모델의 확장, 데이터 공정(전처리) 등을 복합적으로 적용하고 데이터 너머의 범위(extrapolation; generalizability 개념과 연동해서)를 함께 생각해볼 수 있다).</p>
</div>
<div id="causal-inference" class="section level3" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> Causal inference</h3>
<p>회귀계수를 인과적으로 해석하고자 한다면 추가적인 가정들이 필요하다. 이 가정들의 내용은 제4부에서 더 자세히 다룬다. 회귀분석의 맥락에서 인과적 추론은 다양한 예측변수들이 특정한 값에 고정되었을 때 나타날 수 있는 결과에 대한 예측의 형태로 간주된다.</p>
<ul>
<li><p>회귀계수에 대한 인과적 해석을 부여하는 것에는 근본적인 오류가 존재한다.</p></li>
<li><p>회귀모델은 서로 다른 관측치들로부터 얻은 데이터에 적합한다. 그러나 인과적 질문은 어떤 한 사람에게 벌어진 일에 관한 내용이다.</p></li>
<li><p>엄밀하게 말하면 회귀모델의 기울기는 서로 다른 관측치의 차이를 비교하며, 평균 차이를 보여주는 것이다.</p></li>
<li><p>그 평균적인 경향성은 반드시 특정 개별 관측치가 반드시 그러할 것이라는 의미를 갖지는 않는다.</p></li>
</ul>
</div>
</div>
<div id="plotting-the-data-and-fitted-model" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Plotting the data and fitted model</h2>
<p>그래픽은 데이터를 시각화하고, 모델을 이해하고, 적합된 모델에서는 설명되지 않은 데이터 내의 패턴들을 드러내는 데 유용하다.</p>
<div id="displaying-a-regression-line-as-a-function-of-one-input-variable" class="section level3" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Displaying a regression line as a function of one input variable</h3>
<p>아이들의 시험성적 예제를 통해 R에서 적합된 모델의 구체적인 정보들을 살펴보도록 하자.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb216-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstantools)</span>
<span id="cb216-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb216-3" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq)</span>
<span id="cb216-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb216-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb216-5" aria-hidden="true" tabindex="-1"></a>kidiq <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mom_iq, <span class="at">y =</span> kid_score)) <span class="sc">+</span> </span>
<span id="cb216-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb216-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb216-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb216-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> T) <span class="sc">+</span> </span>
<span id="cb216-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb216-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mother IQ score&quot;</span>,</span>
<span id="cb216-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb216-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Child test score&quot;</span>)</span></code></pre></div>
<p><img src="regression-ghv_files/figure-html/unnamed-chunk-410-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Figure 11.1은 개별 관측치들에 대한 산포도와 적합된 회귀모델로부터 추정된 계수값을 사용한 회귀선-<span class="math inline">\(y = \hat a + \hat x\)</span>을 보여준다.</p>
</div>
<div id="displaying-two-fitted-regression-lines" class="section level3" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Displaying two fitted regression lines</h3>
<div id="model-with-no-interaction" class="section level4" number="11.2.2.1">
<h4><span class="header-section-number">11.2.2.1</span> Model with no interaction</h4>
<p>두 개의 예측변수를 가진 모델의 경우, 우리는 각 예측변수와 결과변수에 대해 그릴 수 있다.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_hs <span class="sc">+</span> mom_iq, <span class="at">data=</span>kidiq)</span>
<span id="cb217-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-2" aria-hidden="true" tabindex="-1"></a>b_hat <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_3)</span>
<span id="cb217-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-3" aria-hidden="true" tabindex="-1"></a>kidiq <span class="sc">%&gt;%</span> </span>
<span id="cb217-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">colors =</span> <span class="fu">if_else</span>(mom_hs<span class="sc">==</span><span class="dv">1</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;gray&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb217-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mom_iq, <span class="at">y =</span> kid_score, <span class="at">color =</span> colors)) <span class="sc">+</span> </span>
<span id="cb217-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span> </span>
<span id="cb217-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> futurevisions<span class="sc">::</span><span class="fu">futurevisions</span>(<span class="st">&quot;mars&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb217-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> b_hat[<span class="dv">1</span>] <span class="sc">+</span> b_hat[<span class="dv">2</span>],</span>
<span id="cb217-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> b_hat[<span class="dv">3</span>], </span>
<span id="cb217-10"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> futurevisions<span class="sc">::</span><span class="fu">futurevisions</span>(<span class="st">&quot;mars&quot;</span>)[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb217-11"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> b_hat[<span class="dv">1</span>],</span>
<span id="cb217-12"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> b_hat[<span class="dv">3</span>],</span>
<span id="cb217-13"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> futurevisions<span class="sc">::</span><span class="fu">futurevisions</span>(<span class="st">&quot;mars&quot;</span>)[<span class="dv">2</span>]) <span class="sc">+</span> </span>
<span id="cb217-14"><a href="assumptions-diagnostics-and-model-evaluation.html#cb217-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mother IQ score&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Child test score&quot;</span>)</span></code></pre></div>
<p><img src="regression-ghv_files/figure-html/unnamed-chunk-411-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>mom_hs</code>가 연속형 예측변수라면 우리는 <code>kid_score</code>와 <code>mom_iq</code> 간의 관계를 <code>mom_hs</code>의 서로 다른 두 값에 따른 적합된 회귀선으로 비교하여 보여줄 수 있다.</p>
</div>
<div id="model-with-interaction" class="section level4" number="11.2.2.2">
<h4><span class="header-section-number">11.2.2.2</span> Model with interaction</h4>
<p>상호작용항을 포함한 모델에 대해 앞서와 동일한 플롯을 그릴 수 있다. 이 경우 다른 점은 두 회귀선이 서로 다른 기울기를 가지게 된다는 것이다.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-1" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_hs <span class="sc">+</span> mom_iq <span class="sc">+</span> mom_hs<span class="sc">:</span>mom_iq, <span class="at">data=</span>kidiq)</span>
<span id="cb218-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-2" aria-hidden="true" tabindex="-1"></a>b_hat <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_4)</span>
<span id="cb218-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-3" aria-hidden="true" tabindex="-1"></a>kidiq <span class="sc">%&gt;%</span> </span>
<span id="cb218-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">colors =</span> <span class="fu">if_else</span>(mom_hs<span class="sc">==</span><span class="dv">1</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;gray&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb218-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mom_iq, <span class="at">y =</span> kid_score, <span class="at">color =</span> colors)) <span class="sc">+</span> </span>
<span id="cb218-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span> </span>
<span id="cb218-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> futurevisions<span class="sc">::</span><span class="fu">futurevisions</span>(<span class="st">&quot;mars&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb218-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> b_hat[<span class="dv">1</span>] <span class="sc">+</span> b_hat[<span class="dv">2</span>],</span>
<span id="cb218-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> b_hat[<span class="dv">3</span>] <span class="sc">+</span> b_hat[<span class="dv">4</span>], </span>
<span id="cb218-10"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> futurevisions<span class="sc">::</span><span class="fu">futurevisions</span>(<span class="st">&quot;mars&quot;</span>)[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb218-11"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> b_hat[<span class="dv">1</span>],</span>
<span id="cb218-12"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> b_hat[<span class="dv">3</span>],</span>
<span id="cb218-13"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> futurevisions<span class="sc">::</span><span class="fu">futurevisions</span>(<span class="st">&quot;mars&quot;</span>)[<span class="dv">2</span>]) <span class="sc">+</span> </span>
<span id="cb218-14"><a href="assumptions-diagnostics-and-model-evaluation.html#cb218-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mother IQ score&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Child test score&quot;</span>)</span></code></pre></div>
<p><img src="regression-ghv_files/figure-html/unnamed-chunk-412-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="displaying-uncertainty-in-the-fitted-regression" class="section level3" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> Displaying uncertainty in the fitted regression</h3>
<p>Section 9.1에서 추정된 회귀계수에서 어떻게 사후 시뮬레이션이 불확실성을 보여주는지에 대해서 논의하였다. 여기에서는 어떻게 시뮬레이션을 통해 추론의 불확실성을 시각적으로 보여줄 수 있는지를 살펴본다. 다음과 같은 단순한 모델을 생각해보자:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb219-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data=</span>kidiq)</span></code></pre></div>
<p>회귀선에 대한 불확실성을 보여주는 10번의 시뮬레이션의 적합된 회귀선을 그려보자. <code>lm</code> 함수를 쓰면 시뮬레이션 값을 가지지 않기 때문에 다변량 무작위 정규분포로부터 계수값에 대한 시뮬레이션을 10개 추출해서 다음과 같이 그래프를 그렸다.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb220-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-2" aria-hidden="true" tabindex="-1"></a>sims_2 <span class="ot">&lt;-</span>  <span class="fu">rmvnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="fu">coef</span>(fit_2), <span class="at">sigma =</span> <span class="fu">vcov</span>(fit_2))</span>
<span id="cb220-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-3" aria-hidden="true" tabindex="-1"></a>n_sims_2 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sims_2)</span>
<span id="cb220-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-4" aria-hidden="true" tabindex="-1"></a>beta_hat_2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(sims_2, <span class="dv">2</span>, median)</span>
<span id="cb220-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-6" aria-hidden="true" tabindex="-1"></a>kidiq <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mom_iq, <span class="at">y =</span> kid_score)) <span class="sc">+</span> </span>
<span id="cb220-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb220-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> sims_2[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb220-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> sims_2[<span class="dv">1</span>,<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb220-10"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> sims_2[<span class="dv">2</span>,<span class="dv">1</span>],</span>
<span id="cb220-11"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> sims_2[<span class="dv">2</span>,<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb220-12"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> sims_2[<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb220-13"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> sims_2[<span class="dv">3</span>,<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb220-14"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> sims_2[<span class="dv">4</span>,<span class="dv">1</span>],</span>
<span id="cb220-15"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> sims_2[<span class="dv">4</span>,<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb220-16"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> sims_2[<span class="dv">5</span>,<span class="dv">1</span>],</span>
<span id="cb220-17"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> sims_2[<span class="dv">5</span>,<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb220-18"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> sims_2[<span class="dv">6</span>,<span class="dv">1</span>],</span>
<span id="cb220-19"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> sims_2[<span class="dv">6</span>,<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb220-20"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> sims_2[<span class="dv">7</span>,<span class="dv">1</span>],</span>
<span id="cb220-21"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> sims_2[<span class="dv">7</span>,<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb220-22"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> sims_2[<span class="dv">8</span>,<span class="dv">1</span>],</span>
<span id="cb220-23"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> sims_2[<span class="dv">8</span>,<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb220-24"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> sims_2[<span class="dv">9</span>,<span class="dv">1</span>],</span>
<span id="cb220-25"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> sims_2[<span class="dv">9</span>,<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb220-26"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> sims_2[<span class="dv">10</span>,<span class="dv">1</span>],</span>
<span id="cb220-27"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> sims_2[<span class="dv">10</span>,<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb220-28"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> beta_hat_2[<span class="dv">1</span>],</span>
<span id="cb220-29"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> beta_hat_2[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb220-30"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mother IQ score&quot;</span>,</span>
<span id="cb220-31"><a href="assumptions-diagnostics-and-model-evaluation.html#cb220-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Child test score&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-414"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-414-1.png" alt="Data and regression of child’s test score on maternal IQ, with the solid line showing the fitted regression model and light lines indicating uncertainty in the fitted regression." width="672" />
<p class="caption">
Figure 11.1: Data and regression of child’s test score on maternal IQ, with the solid line showing the fitted regression model and light lines indicating uncertainty in the fitted regression.
</p>
</div>
</div>
<div id="displaying-using-one-plot-for-each-input-variable" class="section level3" number="11.2.4">
<h3><span class="header-section-number">11.2.4</span> Displaying using one plot for each input variable</h3>
<p>회귀모델이 엄마의 고등학교 수료 여부에 대한 더미변수를 포함하고 있다고 해보자.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb221-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_hs <span class="sc">+</span> mom_iq, <span class="at">data=</span>kidiq)</span>
<span id="cb221-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb221-2" aria-hidden="true" tabindex="-1"></a>sims_3 <span class="ot">&lt;-</span>  <span class="fu">rmvnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="fu">coef</span>(fit_3), <span class="at">sigma =</span> <span class="fu">vcov</span>(fit_3))</span>
<span id="cb221-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb221-3" aria-hidden="true" tabindex="-1"></a>n_sims_3 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sims_3)</span>
<span id="cb221-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb221-4" aria-hidden="true" tabindex="-1"></a>beta_fit_3 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_3)</span>
<span id="cb221-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb221-5" aria-hidden="true" tabindex="-1"></a>beta_hat_3 <span class="ot">&lt;-</span> <span class="fu">apply</span>(sims_3, <span class="dv">2</span>, median)</span></code></pre></div>
<p>이 시뮬레이션 결과를 바탕으로 Figure 11.2를 그려보자.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-416"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-416-1.png" alt="Data and regression of child’s test score on maternal IQ and high school completion, shown as a function of each of the two input variables with the other held at its average value. Light lines indicate uncertainty in the regressions. Values for mother’s high school completion have been jittered to make the points more distinct." width="864" />
<p class="caption">
Figure 11.2: Data and regression of child’s test score on maternal IQ and high school completion, shown as a function of each of the two input variables with the other held at its average value. Light lines indicate uncertainty in the regressions. Values for mother’s high school completion have been jittered to make the points more distinct.
</p>
</div>
</div>
<div id="plotting-the-outcome-vs.-a-continuous-predictor" class="section level3" number="11.2.5">
<h3><span class="header-section-number">11.2.5</span> Plotting the outcome vs. a continuous predictor</h3>
<p>주어진 처치변수 중 더미변수인 <span class="math inline">\(z\)</span>와 처치 전 연속형 예측변수인 <span class="math inline">\(x\)</span>가 주어졌다고 할 때, 연속형 결과변수 <span class="math inline">\(y\)</span>를 갖는 모델을 다음과 같이 구축했다고 하자.</p>
<p><span class="math display">\[
y = a + bx + \theta z + error
\]</span></p>
<p>그리고 이제 가상의 데이터를 시뮬레이션해보자.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb222-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>; a <span class="ot">&lt;-</span> <span class="dv">1</span>; b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb222-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-4" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">5</span> ;sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb222-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-6" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> </span>
<span id="cb222-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb222-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>),</span>
<span id="cb222-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, n <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">sample</span>(),</span>
<span id="cb222-10"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> a <span class="sc">+</span> b <span class="sc">*</span> x <span class="sc">+</span> theta <span class="sc">*</span> z <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma)</span>
<span id="cb222-11"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb222-12"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-13"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-13" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> z, <span class="at">data =</span> data_1)</span>
<span id="cb222-14"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-15"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-15" aria-hidden="true" tabindex="-1"></a>lines <span class="ot">&lt;-</span> </span>
<span id="cb222-16"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tribble</span>(</span>
<span id="cb222-17"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-17" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>z, <span class="sc">~</span>intercept, <span class="sc">~</span>slope,</span>
<span id="cb222-18"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="fu">coef</span>(fit_1)[[<span class="st">&quot;(Intercept)&quot;</span>]], <span class="fu">coef</span>(fit_1)[[<span class="st">&quot;x&quot;</span>]],</span>
<span id="cb222-19"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-19" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="fu">coef</span>(fit_1)[[<span class="st">&quot;(Intercept)&quot;</span>]] <span class="sc">+</span> <span class="fu">coef</span>(fit_1)[[<span class="st">&quot;z&quot;</span>]], <span class="fu">coef</span>(fit_1)[[<span class="st">&quot;x&quot;</span>]]</span>
<span id="cb222-20"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb222-21"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-22"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-22" aria-hidden="true" tabindex="-1"></a>data_1 <span class="sc">%&gt;%</span> </span>
<span id="cb222-23"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">color =</span> <span class="fu">factor</span>(z))) <span class="sc">+</span></span>
<span id="cb222-24"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb222-25"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb222-26"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">slope =</span> slope, <span class="at">intercept =</span> intercept, <span class="at">color =</span> <span class="fu">factor</span>(z)),</span>
<span id="cb222-27"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> lines</span>
<span id="cb222-28"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb222-29"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(z)) <span class="sc">+</span> </span>
<span id="cb222-30"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>futurevisions<span class="sc">::</span><span class="fu">futurevisions</span>(<span class="st">&quot;mars&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb222-31"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb222-32"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb222-33"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Pre-treatment predictor, x&quot;</span>,</span>
<span id="cb222-34"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Outcome, y&quot;</span>,</span>
<span id="cb222-35"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Treatment&quot;</span></span>
<span id="cb222-36"><a href="assumptions-diagnostics-and-model-evaluation.html#cb222-36" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-417"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-417-1.png" alt="From a hypothetical study of a pre-treatment variable $x$, treatment indicator $z$, and outcome $y$: data and fitted regression line plotted separately for control and treatment groups." width="672" />
<p class="caption">
Figure 11.3: From a hypothetical study of a pre-treatment variable <span class="math inline">\(x\)</span>, treatment indicator <span class="math inline">\(z\)</span>, and outcome <span class="math inline">\(y\)</span>: data and fitted regression line plotted separately for control and treatment groups.
</p>
</div>
<p>회귀모델을 적합하고 데이터와 적합된 모델을 그래프로 나타내보자. Figure 11.3은 각각 연속형 <span class="math inline">\(x\)</span>, 이산형 <span class="math inline">\(z\)</span>에 대해서 서로 다른 <span class="math inline">\(z\)</span>값에서의 <span class="math inline">\(y\)</span>-<span class="math inline">\(x\)</span>의 관계를 보여준다.</p>
</div>
<div id="forming-a-linear-predictor-from-a-multiple-regression" class="section level3" number="11.2.6">
<h3><span class="header-section-number">11.2.6</span> Forming a linear predictor from a multiple regression</h3>
<p>이전의 예제를 확장해서 <span class="math inline">\(k\)</span>개의 사전 처치 예측변수들-<span class="math inline">\(x_k, k = 1,\dots,K\)</span>에 대한 처치 더미변수 <span class="math inline">\(z\)</span>의 경우를 생각해보자.</p>
<p><span class="math display">\[
y = b_0 + b_1x_1 + \cdots + b_Kx_K + \theta_z + \text{error}.
\]</span></p>
<p>이 데이터의 경우에는 어떻게 시각화를 해줄 수 있을까?</p>
<ol style="list-style-type: decimal">
<li><p>다른 사전 예측변수들의 값을 평균으로 고정시켜둔 상태에서 <span class="math inline">\(z=0\)</span>일 때와 <span class="math inline">\(z=1\)</span>일 때에 대해 <span class="math inline">\(y\)</span>-<span class="math inline">\(x_K\)</span> 관계를 시각화할 수 있다.</p></li>
<li><p>통제집단을 <span class="math inline">\((z=0)\)</span>로, 처치 집단을 <span class="math inline">\((z=1)\)</span>인 집단으로 상정하여 결과변수 <span class="math inline">\(y\)</span>에 대한 선형예측, <span class="math inline">\(\hat y = \hat b_0 \hat b_1 x_1 + \cdots + \hat b_Kx_K + \hat \theta z\)</span>를 각각 두 집단에서 추정하는 방식이 있다.</p>
<ul>
<li>먼저 페이크데이터를 이용해 <span class="math inline">\(K= 10\)</span>인 예측변수들과 상수항을 가지는 회귀모델을 구축, 시뮬레이션을 해보자.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb223-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>; k <span class="ot">&lt;-</span> <span class="dv">10</span>; a <span class="ot">&lt;-</span> <span class="dv">1</span>; b <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>k</span>
<span id="cb223-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-4" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">5</span>; sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb223-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-6" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> </span>
<span id="cb223-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb223-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n <span class="sc">*</span> k, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>), </span>
<span id="cb223-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">nrow =</span> n, <span class="at">ncol =</span> k),</span>
<span id="cb223-10"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, n <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">sample</span>(),</span>
<span id="cb223-11"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">as.double</span>(a <span class="sc">+</span> X <span class="sc">%*%</span> b <span class="sc">+</span> theta <span class="sc">*</span> z <span class="sc">+</span> </span>
<span id="cb223-12"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-12" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma))</span>
<span id="cb223-13"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb223-14"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-15"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-15" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X <span class="sc">+</span> z, <span class="at">data =</span> data_2)</span>
<span id="cb223-16"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-17"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-17" aria-hidden="true" tabindex="-1"></a>data_2 <span class="sc">%&gt;%</span></span>
<span id="cb223-18"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred =</span> <span class="fu">predict</span>(fit_2)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-19"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pred, y, <span class="at">color =</span> <span class="fu">factor</span>(z))) <span class="sc">+</span></span>
<span id="cb223-20"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb223-21"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb223-22"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb223-23"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(z)) <span class="sc">+</span> </span>
<span id="cb223-24"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> futurevisions<span class="sc">::</span><span class="fu">futurevisions</span>(<span class="st">&quot;mars&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb223-25"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb223-26"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb223-27"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Outcome vs. predicted value&quot;</span>,</span>
<span id="cb223-28"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Predicted value of y&quot;</span>,</span>
<span id="cb223-29"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Outcome, y&quot;</span>,</span>
<span id="cb223-30"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Treatment&quot;</span></span>
<span id="cb223-31"><a href="assumptions-diagnostics-and-model-evaluation.html#cb223-31" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-418"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-418-1.png" alt="From a hypothetical study of 10 pre-treatment variables $X$, treatment indicator $z$, and outcome $y$: Outcome plotted vs. fitted linear predictor $\hat y$ (so that the fitted regression line is by definition $y = \hat y$), plotted separately for control and treatment groups." width="768" />
<p class="caption">
Figure 11.4: From a hypothetical study of 10 pre-treatment variables <span class="math inline">\(X\)</span>, treatment indicator <span class="math inline">\(z\)</span>, and outcome <span class="math inline">\(y\)</span>: Outcome plotted vs. fitted linear predictor <span class="math inline">\(\hat y\)</span> (so that the fitted regression line is by definition <span class="math inline">\(y = \hat y\)</span>), plotted separately for control and treatment groups.
</p>
</div>
<p>Figure 11.4는 예측된 <span class="math inline">\(y\)</span>와 관측된 <span class="math inline">\(y\)</span> 간의 관계를 나타낸다. 오차항 <span class="math inline">\(u\)</span>는선형 예측값, <span class="math inline">\(E(y)\)</span>에 의해 정의된다. 만약 오차가 크지 않다면 관측된 <span class="math inline">\(y\)</span>와 예측값 <span class="math inline">\(\hat y\)</span>는 동일 선상에 놓이게 될 것이다.</p>
</div>
</div>
<div id="residual-plots" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Residual plots</h2>
<p>데이터와 적합된 회귀선을 그래프로 시각화한다면, 우리는 데이터와 모델로 인한 기대값 간의 차이를 살펴보는 것으로 적합이 잘 되었는지를 평가할 수 있다: 그 차이가 바로 잔차(<em>residuals</em>)이다.</p>
<p><span class="math display">\[
r_i = y_i - X_i\hat \beta.
\]</span></p>
<p>잔차를 구해보자: <span class="math inline">\(r_i = y_i - (\hat b_0 + \hat b_1 x_{i1} + \cdots + \hat b_K x_{iK} + \hat \theta z_i)\)</span>.</p>
<p>만약 모델이 정확하다면 잔차를 그래프로 나타냈을 때, 우리는 대략적으로 무작위 분포된 잔차의 분포를 볼 수 있게 된다. Figure 11.5를 보자.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb224-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-3" aria-hidden="true" tabindex="-1"></a>data_2 <span class="sc">%&gt;%</span></span>
<span id="cb224-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb224-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred =</span> <span class="fu">predict</span>(fit_2),</span>
<span id="cb224-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid =</span> <span class="fu">residuals</span>(fit_2)</span>
<span id="cb224-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb224-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pred, resid, <span class="at">color =</span> <span class="fu">factor</span>(z))) <span class="sc">+</span></span>
<span id="cb224-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb224-10"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb224-11"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(z)) <span class="sc">+</span> </span>
<span id="cb224-12"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb224-13"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> futurevisions<span class="sc">::</span><span class="fu">futurevisions</span>(<span class="st">&quot;mars&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb224-14"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb224-15"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb224-16"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Residual vs. predicted value&quot;</span>,</span>
<span id="cb224-17"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Predicted value of y&quot;</span>,</span>
<span id="cb224-18"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Residual, r&quot;</span>,</span>
<span id="cb224-19"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Treatment&quot;</span></span>
<span id="cb224-20"><a href="assumptions-diagnostics-and-model-evaluation.html#cb224-20" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-419"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-419-1.png" alt="Continuing Figure 11.4, the residual, $r = y- \hat y$, vs. the fitted linear predictor $\hat y$, plotted separately for control and treatment groups." width="768" />
<p class="caption">
Figure 11.5: Continuing Figure 11.4, the residual, <span class="math inline">\(r = y- \hat y\)</span>, vs. the fitted linear predictor <span class="math inline">\(\hat y\)</span>, plotted separately for control and treatment groups.
</p>
</div>
<p>Figure 11.6은 시험성적 예제에서 엄마의 IQ로 아이의 시험성적을 회귀분석한 데 대한 잔차 그래프를 보여준다.</p>
<ul>
<li><p>Figure 11.6은 강한 패턴을 보여주지는 않는다.</p></li>
<li><p>잔차 그래프는 모델적합도와 관련된 체계적 문제들을 확인할 수 있게 한다.</p></li>
<li><p>Figure 11.6은 모델로부터 구한 오차가 평균을 0으로 하며 예측변수와 독립적이라는 것을 보여준다.</p></li>
</ul>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq)</span>
<span id="cb225-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-3" aria-hidden="true" tabindex="-1"></a>kidiq <span class="sc">%&gt;%</span> </span>
<span id="cb225-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resid =</span> <span class="fu">residuals</span>(fit_2),</span>
<span id="cb225-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> resid <span class="sc">+</span> <span class="fu">sd</span>(resid),</span>
<span id="cb225-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> resid <span class="sc">-</span> <span class="fu">sd</span>(resid)) <span class="ot">-&gt;</span> newkids</span>
<span id="cb225-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-8" aria-hidden="true" tabindex="-1"></a>newkids <span class="sc">%&gt;%</span> </span>
<span id="cb225-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mom_iq, resid)) <span class="sc">+</span></span>
<span id="cb225-10"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb225-11"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(newkids<span class="sc">$</span>upper), </span>
<span id="cb225-12"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb225-13"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(newkids<span class="sc">$</span>lower), </span>
<span id="cb225-14"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb225-15"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb225-16"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb225-17"><a href="assumptions-diagnostics-and-model-evaluation.html#cb225-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mother IQ score&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residual&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-420"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-420-1.png" alt="Residual plot for child test score data when regressed on maternal IQ, with dotted lines showing $\pm 1$ standard-deviation bounds. The residuals show no striking patterns." width="768" />
<p class="caption">
Figure 11.6: Residual plot for child test score data when regressed on maternal IQ, with dotted lines showing <span class="math inline">\(\pm 1\)</span> standard-deviation bounds. The residuals show no striking patterns.
</p>
</div>
<div id="using-fake-data-simulation-to-understand-residual-plots" class="section level3" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Using fake-data simulation to understand residual plots</h3>
<p>모델, <span class="math inline">\(y = X\beta + \epsilon\)</span>으로부터 페이크데이터를 시뮬레이션했다고 했을 때, 모델을 시뮬레이션된 데이터에 재적합하고 계수 <span class="math inline">\(\beta\)</span>에 대한 68%, 95%의 구간을 확인할 수 있다.</p>
</div>
<div id="a-confusing-choice-plot-residuals-vs.-predicted-values-or-residuals-vs.-observed-values" class="section level3" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> A confusing choice: plot residuals vs. predicted values, or residuals vs. observed values?</h3>
<p>실제 데이터에 대한 단순한 모델을 적합해보고, 기초통계학 수업(<code>scores</code>)에서 중간고사 성적으로 기말시험 성적을 예측해보자.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb226-1" aria-hidden="true" tabindex="-1"></a>file_scores <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/ros-master/Introclass/data/gradesW4315.dat&quot;</span>)</span>
<span id="cb226-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb226-2" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> </span>
<span id="cb226-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb226-3" aria-hidden="true" tabindex="-1"></a>  file_scores <span class="sc">%&gt;%</span> </span>
<span id="cb226-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.table</span>(<span class="at">header =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb226-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb226-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb226-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb226-7" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(final <span class="sc">~</span> midterm, <span class="at">data =</span> scores)</span>
<span id="cb226-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb226-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = final ~ midterm, data = scores)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -36.832  -6.573   2.761   8.880  29.055 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  64.5048    16.9778   3.799 0.000394 ***
## midterm       0.7036     0.2144   3.281 0.001888 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 14.75 on 50 degrees of freedom
## Multiple R-squared:  0.1772, Adjusted R-squared:  0.1607 
## F-statistic: 10.77 on 1 and 50 DF,  p-value: 0.001888</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sigma</span>(fit_1)</span></code></pre></div>
<pre><code>## [1] 14.75195</code></pre>
<p>이제 계수들을 시뮬레이션해서 평균 예측값인 <span class="math inline">\(y_i^{\text{pred}}\)</span>와 잔차 <span class="math inline">\(y_i - y_i^{\text{pred}}\)</span>를 구해보자.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb230-1" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="fu">coef</span>(fit_1), <span class="at">sigma =</span><span class="fu">vcov</span>(fit_1))</span>
<span id="cb230-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb230-2" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_1)</span>
<span id="cb230-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb230-3" aria-hidden="true" tabindex="-1"></a>resid <span class="ot">&lt;-</span> scores<span class="sc">$</span>final <span class="sc">-</span> predicted</span></code></pre></div>
<p>Figure 11.7은 모델로부터 얻은 잔차를 두 가지 서로 다른 방식으로 보여준다.</p>
<ol style="list-style-type: lower-alpha">
<li><p>예측값과 잔차 간의 관계를 보여주는 것</p></li>
<li><p>관측값과 잔차 간의 관계를 보여주는 것</p></li>
</ol>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-1" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> </span>
<span id="cb231-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb231-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred =</span> <span class="fu">predict</span>(fit_1),</span>
<span id="cb231-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid =</span> <span class="fu">residuals</span>(fit_1)</span>
<span id="cb231-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> scores</span>
<span id="cb231-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-7" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span></span>
<span id="cb231-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pred, resid)) <span class="sc">+</span></span>
<span id="cb231-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb231-10"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb231-11"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb231-12"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb231-13"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Residual vs. predicted value&quot;</span>,</span>
<span id="cb231-14"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Predicted value&quot;</span>,</span>
<span id="cb231-15"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Residual&quot;</span></span>
<span id="cb231-16"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> panelscore1</span>
<span id="cb231-17"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-18"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-18" aria-hidden="true" tabindex="-1"></a>scores <span class="sc">%&gt;%</span> </span>
<span id="cb231-19"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(final, resid)) <span class="sc">+</span></span>
<span id="cb231-20"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb231-21"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb231-22"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb231-23"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb231-24"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Residual vs. observed value&quot;</span>,</span>
<span id="cb231-25"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Observed value&quot;</span>,</span>
<span id="cb231-26"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Residual&quot;</span></span>
<span id="cb231-27"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> panelscore2</span>
<span id="cb231-28"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-29"><a href="assumptions-diagnostics-and-model-evaluation.html#cb231-29" aria-hidden="true" tabindex="-1"></a>panelscore1 <span class="sc">+</span> panelscore2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-423"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-423-1.png" alt="From a model predicting final exam grades from midterms: plots of regression residuals versus predicted and versus observed values. The left plot looks reasonable but the right plot shows strong patterns. How to understand these? An exploration using fake data (see Figure 11.8) shows that, even if the model were correct, we would expect the right plot to show strong patterns. The plot of residuals versus observed thus does not indicate a problem with the model." width="768" />
<p class="caption">
Figure 11.7: From a model predicting final exam grades from midterms: plots of regression residuals versus predicted and versus observed values. The left plot looks reasonable but the right plot shows strong patterns. How to understand these? An exploration using fake data (see Figure 11.8) shows that, even if the model were correct, we would expect the right plot to show strong patterns. The plot of residuals versus observed thus does not indicate a problem with the model.
</p>
</div>
<p>하지만 Figure 11.7b는 문제의 소지가 있어보인다. 왜냐하면 잔차 역시도 원래는 관측된 값에 포함된-우리가 관측하지 못한 변동성일 것이기 때문에 관측값과 잔차는 어떻게든 일정한 체계적 관계를 맺기 때문이다.</p>
</div>
<div id="understanding-the-choice-using-fake-data-simulation" class="section level3" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> Understanding the choice using fake-data simulation</h3>
<p>주어진 모델 추정량을 바탕으로 계수값과 표준편차를 설정하고 실제 중간고사 성적을 예측변수로 기말고사 성적을 페이크데이터로 시뮬레이션해서 만들어보자.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb232-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">64.5</span>; b <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb232-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb232-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">14.8</span></span>
<span id="cb232-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb232-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scores)</span>
<span id="cb232-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb232-4" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>final_fake <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>scores<span class="sc">$</span>midterm <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma)</span></code></pre></div>
<p>페이크데이터에 회귀모델을 적합하고 예측값과 잔차를 컴퓨팅해보자.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb233-1" aria-hidden="true" tabindex="-1"></a>fit_fake <span class="ot">&lt;-</span> <span class="fu">lm</span>(final_fake <span class="sc">~</span> midterm, <span class="at">data=</span>scores)</span>
<span id="cb233-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb233-2" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="fu">coef</span>(fit_fake), <span class="at">sigma =</span> <span class="fu">vcov</span>(fit_fake))</span>
<span id="cb233-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb233-3" aria-hidden="true" tabindex="-1"></a>predicted_fake <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(sims[,<span class="dv">1</span>] <span class="sc">+</span> sims[,<span class="dv">2</span>] <span class="sc">%*%</span> <span class="fu">t</span>(scores<span class="sc">$</span>midterm))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-426"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-426-1.png" alt="From fake data: plots of regression residuals versus (a) predicted or (b) observed values. Data were simulated from the fitted family of regression models, and so we know that the pattern on the right does not represent any sort of model failure. This is an illustration of the use of fake data to evaluate diagnostic plots. Compare to the corresponding plots of real data in Figure 11.7." width="768" />
<p class="caption">
Figure 11.8: From fake data: plots of regression residuals versus (a) predicted or (b) observed values. Data were simulated from the fitted family of regression models, and so we know that the pattern on the right does not represent any sort of model failure. This is an illustration of the use of fake data to evaluate diagnostic plots. Compare to the corresponding plots of real data in Figure 11.7.
</p>
</div>
<p>Figure 11.8은 <code>resid_fake</code> 대 <code>predicted_fake</code>와 관측된 <code>final_fake</code> 간의 관계를 보여주는 플롯이다. 우리는 이 플롯을 보고 모델을 평가할 수 있다(좌측을 보고).</p>
</div>
</div>
<div id="comparing-data-to-replications-from-a-fitted-model" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Comparing data to replications from a fitted model</h2>
<p>시뮬레이션은 여러 용도로 사용할 수 있다"</p>
<ul>
<li><p>가설적인 확률 모델의 함의를 탐색(Section 5.1)</p></li>
<li><p>데이터에 적합된 통계모델의 함의를 탐색(Section 10.6)</p></li>
<li><p>알려진 모수의 진실값에 대한 추정량들을 비교함으로서 통계절차의 특성을 연구(Section 7.2와 11.3)</p></li>
<li><p>사후 예측분포 확인(posterior predictive checking): 주어진 적합된 모델로 재현된 데이터셋으로 시뮬레이팅한 이후 관측된 데이터와 비교하는 것</p></li>
</ul>
<div id="example-simulation-based-checking-of-a-fitted-normal-distribution" class="section level3" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Example: simulation-based checking of a fitted normal distribution</h3>
<p>모델 적합도(model fit)를 확인하기 위한 가장 기초적인 방법은 재현된 데이터셋을 제시하고 실제 데이터와 비교하는 것이다.</p>
<p>Figure 11.9는 Simon Newcomb가 1882년에 광속을 측정하기 위한 실험의 일부로 사용된 데이터를 보여준다. 먼저 예측변수 하나 없이 선형회귀모델을 적합해 데이터에 대한 정규분포를 적합해본다.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb234-1" aria-hidden="true" tabindex="-1"></a>file_newcomb <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/ros-master/Newcomb/data/newcomb.txt&quot;</span>)</span>
<span id="cb234-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb234-2" aria-hidden="true" tabindex="-1"></a>newcomb <span class="ot">&lt;-</span> <span class="fu">read_table2</span>(file_newcomb)</span>
<span id="cb234-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb234-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> newcomb)</span></code></pre></div>
<p>그 다음으로는 적합된 모델로부터 모수를 시뮬레이션하는 것이다. 이 예제에서는 상수항 <span class="math inline">\(\beta_0\)</span>와 잔차의 표준편차 <span class="math inline">\(\sigma\)</span>를 얻을 수 있다.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb235-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>newcomb, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb235-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb235-2" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(fit)</span>
<span id="cb235-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb235-3" aria-hidden="true" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sims)</span></code></pre></div>
<p>이제 시뮬레이션을 해보자.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb236-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(newcomb<span class="sc">$</span>y)</span>
<span id="cb236-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb236-2" aria-hidden="true" tabindex="-1"></a>y_rep <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(n_sims, n))</span>
<span id="cb236-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sims) {</span>
<span id="cb236-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb236-4" aria-hidden="true" tabindex="-1"></a>  y_rep[s,] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, sims[s,<span class="dv">1</span>], sims[s,<span class="dv">2</span>])</span>
<span id="cb236-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb236-5" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p><code>posterior_predict()</code> 함수로 재현된 데이터셋에 대한 예측값의 사후분포를 확인해보자.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb237-1" aria-hidden="true" tabindex="-1"></a>y_rep <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit)</span></code></pre></div>
<div id="visual-comparison-of-actual-and-replicated-datasets" class="section level4" number="11.4.1.1">
<h4><span class="header-section-number">11.4.1.1</span> Visual comparison of actual and replicated datasets</h4>
<p>Figure 11.9는 Simon Newcomb’s 데이터의 분포를 보여준다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-431"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-431-1.png" alt="Histogram of Simon Newcomb’s measurements for estimating the speed of light, from Stigler (1977). The data represent the amount of time required for light to travel a distance of 7442 meters and are recorded as deviations from 24 800 nanoseconds." width="480" />
<p class="caption">
Figure 11.9: Histogram of Simon Newcomb’s measurements for estimating the speed of light, from Stigler (1977). The data represent the amount of time required for light to travel a distance of 7442 meters and are recorded as deviations from 24 800 nanoseconds.
</p>
</div>
<p>Figure 11.10은 무작위로 표집된 데이터셋 중 20개의 관측치에 대한 플롯을 보여준다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-432"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-432-1.png" alt="Twenty replications, $y^{rep}$, of the speed-of-light data from the predictive distribution under the normal model; compare to observed data, $y$, in Figure 11.9. Each histogram displays the result of drawing 66 independent values $y_{i}^{rep}$ from a common normal distribution with mean and standard deviation $(\mu, \sigma)$ simulated from the fitted model." width="864" />
<p class="caption">
Figure 11.10: Twenty replications, <span class="math inline">\(y^{rep}\)</span>, of the speed-of-light data from the predictive distribution under the normal model; compare to observed data, <span class="math inline">\(y\)</span>, in Figure 11.9. Each histogram displays the result of drawing 66 independent values <span class="math inline">\(y_{i}^{rep}\)</span> from a common normal distribution with mean and standard deviation <span class="math inline">\((\mu, \sigma)\)</span> simulated from the fitted model.
</p>
</div>
<p>실제 데이터와 재현 데이터 간에는 명확한 체계적 차이가 나타난다.</p>
</div>
<div id="checking-model-fit-using-a-numerical-data-summary" class="section level4" number="11.4.1.2">
<h4><span class="header-section-number">11.4.1.2</span> Checking model fit using a numerical data summary</h4>
<p>데이터를 보여주는 것은 모델 적합도를 확인하기 위한 보다 집중된 검정 통계량을 제안할 수 있다. 검정 통계량 <span class="math inline">\(T(y)\)</span>는 데이터의 최소값과 같으며 이를 바탕으로 우리는 각각의 재현된 데이터셋에 대한 $T(y^{})를 계산하게 된다.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb238-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="cf">function</span>(y) {</span>
<span id="cb238-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(y)</span>
<span id="cb238-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb238-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb238-4" aria-hidden="true" tabindex="-1"></a>test_rep <span class="ot">&lt;-</span> <span class="fu">apply</span>(y_rep, <span class="dv">1</span>, test)</span></code></pre></div>
<p>재현된 데이터들의 최소값들의 히스토그램을 그리고 관측 데이터의 최소값을 수직선으로 나타내보자.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-434"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-434-1.png" alt="Smallest observation of Newcomb’s speed-of-light data (the vertical line at the left of the graph), compared to the smallest observations from each of 20 posterior predictive simulated datasets displayed in Figure 11.10." width="672" />
<p class="caption">
Figure 11.11: Smallest observation of Newcomb’s speed-of-light data (the vertical line at the left of the graph), compared to the smallest observations from each of 20 posterior predictive simulated datasets displayed in Figure 11.10.
</p>
</div>
<p>이 그래프는 시뮬레이션으로 만든 재현데이터 각각의 최소관측값이 Newcomb의 관측값 중 가장 작은값에 비해 훨씬 더 크다는 것을 보여준다.</p>
</div>
</div>
</div>
<div id="example-predictive-simulation-to-check-the-fit-of-a-time-series-model" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> Example: predictive simulation to check the fit of a time-series model</h2>
<p>예측 시뮬레이션은 각 시점의 분포가 이전 시점의 데이터에 의해 영향을 받는 시계열 모델에서 더 복잡하다. 여기서는 단순자기회귀(autoregressive) 모델로 설명한다.</p>
<div id="fitting-a-first-order-autoregression-to-the-unemployment-series" class="section level3" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Fitting a first-order autoregression to the unemployment series</h3>
<p>Figure 11.13은 1947년부터 2004년 사이의 미국 내 연간 실업률에 대한 시계열 자료를 보여준다. 얼마나 데이터가 1계 자기회귀에 따라 잘 적합되는지, 즉 이전 연도의 실업률에 대한 회귀모델을 분석해본다.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb239-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(unemp)</span>
<span id="cb239-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb239-2" aria-hidden="true" tabindex="-1"></a>unemp<span class="sc">$</span>y_lag <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, unemp<span class="sc">$</span>y[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)])</span>
<span id="cb239-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb239-3" aria-hidden="true" tabindex="-1"></a>fit_lag <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(y <span class="sc">~</span> y_lag, <span class="at">data=</span>unemp, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb239-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_lag)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      y ~ y_lag
##  observations: 69
##  predictors:   2
## ------
##             Median MAD_SD
## (Intercept) 1.3    0.5   
## y_lag       0.8    0.1   
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 1.0    0.1   
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>이 결과는 생각보다 데이터에 대한 모델의 적합도에 대해 많은 정보를 알려주지 않는다. 이 적합을 분석하기 위해서 적합된 모델로부터 재현 데이터를 시뮬레이션한다.</p>
</div>
<div id="simulating-replicated-datasets" class="section level3" number="11.5.2">
<h3><span class="header-section-number">11.5.2</span> Simulating replicated datasets</h3>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb241-1" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(fit_lag)</span>
<span id="cb241-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb241-2" aria-hidden="true" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sims)</span></code></pre></div>
<p>시뮬레이션된 시계열 데이터를 채워넣기 위한 재현 데이터셋의 용기(container)를 만든다.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb242-1" aria-hidden="true" tabindex="-1"></a>y_rep <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(n_sims, n))</span>
<span id="cb242-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sims){</span>
<span id="cb242-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb242-3" aria-hidden="true" tabindex="-1"></a>  y_rep[s,<span class="dv">1</span>] <span class="ot">&lt;-</span> y[<span class="dv">1</span>]</span>
<span id="cb242-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb242-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb242-5" aria-hidden="true" tabindex="-1"></a>    y_rep[s,t] <span class="ot">&lt;-</span> sims[s,<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span> </span>
<span id="cb242-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb242-6" aria-hidden="true" tabindex="-1"></a>      sims[s,<span class="st">&quot;y_lag&quot;</span>] <span class="sc">*</span> y_rep[s,t<span class="dv">-1</span>] <span class="sc">+</span></span>
<span id="cb242-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb242-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, sims[s,<span class="st">&quot;sigma&quot;</span>])</span>
<span id="cb242-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb242-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb242-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb242-9" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p>이렇게 얻은 시뮬레이션 결과는 <code>posterior_prect()</code> 함수로 분석을 수행할 수 없는데 시계열 자료에서는 각 연도를 그 전년도에 조건지어서 시뮬레이션을 해야하기 때문이다.</p>
</div>
<div id="visual-and-numerical-comparisons-of-replicated-to-actual-data" class="section level3" number="11.5.3">
<h3><span class="header-section-number">11.5.3</span> Visual and numerical comparisons of replicated to actual data</h3>
<p>첫째로 시뮬레이션된 데이터셋을 시각화하고 실제 데이터와 비교할 수 있다. 실제 데이터를 시각화해보자.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-439"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-439-1.png" alt="Time series of U.S. annual unemployment rates from 1947 to 2016. We fit a first-order autoregression to these data and then simulate several datasets, shown in Figure 11.14, from the fitted model." width="480" />
<p class="caption">
Figure 11.12: Time series of U.S. annual unemployment rates from 1947 to 2016. We fit a first-order autoregression to these data and then simulate several datasets, shown in Figure 11.14, from the fitted model.
</p>
</div>
<p>20개의 시뮬레이션 결과는 서로 다른 패턴들을 보여준다. 자기회귀모델은 시계열을 서로 다른 측면들을 명확하게 보여줄 수 있다.</p>
<pre><code>## Error in validate_data(data, if_missing = environment(formula)): object &#39;unemployment&#39; not found</code></pre>
<pre><code>## Error in seq(min(unemployment$year), max(unemployment$year)): object &#39;unemployment&#39; not found</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;unemployment&#39; not found</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;years&#39; not found</code></pre>
<pre><code>## Error in double(length = n_years): object &#39;n_years&#39; not found</code></pre>
<pre><code>## Error in UseMethod(&quot;filter&quot;): no applicable method for &#39;filter&#39; applied to an object of class &quot;c(&#39;matrix&#39;, &#39;array&#39;, &#39;double&#39;, &#39;numeric&#39;)&quot;</code></pre>
<p>위의 시계열 시뮬레이션 시각화 결과를 보면 재현된 데이터들은 원 데이터에서 보여주지 않는 패턴을 보여준다. 바로 실제 시계열 자료에서 나타나는 보다 부드러운 패턴보다 위아래로 단기의 등폭이 더 심하다는 것이다.</p>
<p>이러한 차이를 수량화해주기 위해서, 실업률의 감소에 뒤이어 바로 증가가 있었던 해의 빈도를 세는 검정통계량을 정의해보고 추정할 수 있다.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb249-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="cf">function</span>(y){</span>
<span id="cb249-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb249-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb249-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb249-3" aria-hidden="true" tabindex="-1"></a>  y_lag <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, y[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)])</span>
<span id="cb249-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb249-4" aria-hidden="true" tabindex="-1"></a>  y_lag_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, y[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-2</span>)])</span>
<span id="cb249-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb249-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">sign</span>(y<span class="sc">-</span>y_lag) <span class="sc">!=</span> <span class="fu">sign</span>(y_lag<span class="sc">-</span>y_lag_2), <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb249-6"><a href="assumptions-diagnostics-and-model-evaluation.html#cb249-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb249-7"><a href="assumptions-diagnostics-and-model-evaluation.html#cb249-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-8"><a href="assumptions-diagnostics-and-model-evaluation.html#cb249-8" aria-hidden="true" tabindex="-1"></a>test_y <span class="ot">&lt;-</span> <span class="fu">test</span>(unemp<span class="sc">$</span>y)</span>
<span id="cb249-9"><a href="assumptions-diagnostics-and-model-evaluation.html#cb249-9" aria-hidden="true" tabindex="-1"></a>test_rep <span class="ot">&lt;-</span> <span class="fu">apply</span>(y_rep, <span class="dv">1</span>, test)</span>
<span id="cb249-10"><a href="assumptions-diagnostics-and-model-evaluation.html#cb249-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test_rep)</span></code></pre></div>
<pre><code>## test_rep
##   0   5   6   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25 
##   9   3   4   9   3   7   6   5   9   8  15  20  15  32  56  67  83 146 156 173 213 
##  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43 
## 279 321 346 326 319 303 297 230 169 114 102  67  34  25  11   8   6   4</code></pre>
<p>실제로 관측된 시계열 자료에서는 26번의 변동이 포착된다. 앞서 수행한 <code>n_sims = 4000</code>인 시뮬레이션에서 99%의 데이터가 26번 이상의 변동을 가지고 있고, 80% 정도에 해당하는 시뮬레이션 데이터들이 [31, 41] 사이에 변동을 보인다. 즉, 모델이 데이터의 특성을 잘 포착하지 못하고 있다는 것을 의미한다.</p>
<ul>
<li><p>이 검정은 자기회귀를 기각하지 못하지만, 데이터의 특정한 측면을 보여준다는 데 의의가 있다.</p>
<ul>
<li><p>단순히 회귀모델을 적합하는 것에서는 확인할 수 없는 데이터의 경향성에 대한 정보를 제공하는 것이다.</p></li>
<li><p>실제 시계열 자료의 변동은 모델에서 기대되는 것보다 훨씬 덜 빈번한 양상을 보였다.</p></li>
</ul></li>
<li><p>이러한 시각화 노력을 통해 우리는 관측자료와 재현자료(시뮬레이션) 간 체계적 차이를 더 쉽게 포착할 수 있다.</p></li>
</ul>
</div>
</div>
<div id="residual-standard-deviation-sigma-and-explained-variance-r2" class="section level2" number="11.6">
<h2><span class="header-section-number">11.6</span> Residual standard deviation <span class="math inline">\(\sigma\)</span> and explained variance <span class="math inline">\(R^2\)</span></h2>
<p>잔차의 표준편차, <span class="math inline">\(\sigma\)</span>는 잔차, <span class="math inline">\(r_i = y_i - X_i\hat \beta\)</span>를 요약해서 보여준다.</p>
<p>표준편차의 크기는 결과변수의 총 변동량에 비교했을 때 좀 더 중요한 의미를 가진다. 모델의 적합도는 <span class="math inline">\(\sigma\)</span>를 요약하는 것으로 보여줄 수 있다.</p>
<ul>
<li>잔차의 표준편차가 작을수록 더 좋은 모델 적합도를 보인다.</li>
</ul>
<p>그리고 <span class="math inline">\(R^2\)</span>는 결과변수의 총 변동량에 비해 모델에 의해서 설명되는 분산을 보여준다.</p>
<ul>
<li>설명되지 않은 분산은 <span class="math inline">\(\sigma^2\)</span>로 나타내고, 만약 데이터의 표준편차를 <span class="math inline">\(s_y\)</span>라고 한다면 <span class="math inline">\(R^2\)</span>다음과 같이 나타낼 수 있다.</li>
</ul>
<p><span class="math display">\[
R^2 = 1 - (\hat \sigma^2/s^2_y)
\]</span></p>
<ul>
<li>모델이 최소자승법을 통해 적합되었다면 아래와 같이 설명된 분산을 직접적으로 표현할 수 있다.</li>
</ul>
<p><span class="math display">\[
R^2 = V^n_{i=1}\hat y_i/s^2_y
\]</span>
이때, <span class="math inline">\(\hat y_i = X_i\hat \beta\)</span>이며 <span class="math inline">\(V\)</span>는 표본 분산을 나타낸다.</p>
<p><span class="math display">\[
V^n_{i=1}z_i = \frac{1}{n-1}\sum^{n}_{i=1}(z_i-\bar z)^2, \text{for any vector } z\text{ of length }n.
\]</span></p>
<p><span class="math inline">\(R^2\)</span>를 이해하기 위해서, 하나의 예측변수를 가진 단순회귀모델을 생각해보자: <span class="math inline">\(\hat y = \hat a + \hat b x\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>회귀선이 거의 수평선인 <span class="math inline">\(\bar y\)</span>와 거의 같다고 해보자. 그렇다면 모든 <span class="math inline">\(i\)</span>에 대해서 <span class="math inline">\(\hat a + \hat b x_i \approx \bar y\)</span>가 된다. 이 경우에 개별 잔차는 <span class="math inline">\(y_i - (\hat a + \hat b x_i)\)</span>로 계산할 수 있고, 이 결과는 거의 <span class="math inline">\(y_i - \bar y\)</span>와 같게 된다. 따라서 <span class="math inline">\(\sigma \approx s_y\)</span>가 된다. 그러므로 <span class="math inline">\(R^2 \approx 0\)</span>이라고 할 수 있고, 이는 회귀선이 실제로 <span class="math inline">\(y\)</span>의 변동을 설명하는 것이 거의 없다는 의미이다. 이 경우, 추정된 절편 <span class="math inline">\(\hat a\)</span>는 대략적으로 <span class="math inline">\(\bar y\)</span>이며, 추정된 기울기 <span class="math inline">\(\hat b\)</span>는 거의 0에 가깝게 된다.</p></li>
<li><p>이번에는 또 다른 시나리오, 회귀선이 거의 완벽하게 모든 관측치를 지나는 경우를 생각해보자. 따라서 이 경우에 잔차는 거의 0이 된다. 그렇다면 <span class="math inline">\(\sigma\)</span>는 0에 가까워지고 <span class="math inline">\(s_y\)</span>는 훨씬 더 작아지며, <span class="math inline">\(R^2 \approx 1\)</span>이 된다. 즉, 회귀선은 실질적으로 <span class="math inline">\(y\)</span>의 모든 변동성을 설명한다는 것이며, 일반적으로 <span class="math inline">\(R^2\)</span>가 거의 1에 가까워질수록 모델 적합도가 더 나아진다고 할 수 있다.</p></li>
</ol>
<p><span class="math inline">\(R^2\)</span>에 대해서 알아야할 것들이 몇 가지 있다.</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(R^2\)</span>는 회귀모델의 <span class="math inline">\(x\)</span>나 <span class="math inline">\(y\)</span>를 어떠한 상수와 곱한다고 해서 변화하지는 않는다.</p>
<ul>
<li>따라서 예측변수의 단위를 변화시키고 싶거나 혹은 해석에 변화를 주더라도 데이터에 대한 모델 적합의 요약 결과를 변화시키기는 못한다.</li>
</ul></li>
<li><p>하나의 예측변수를 가진 최소자승 회귀모델에서 <span class="math inline">\(R^2\)</span>는 <span class="math inline">\(x\)</span>와 <span class="math inline">\(y\)</span> 간의 상관관계의 제곱 값과 동일하다.</p></li>
</ol>
<p><span class="math inline">\(n-k\)</span>, 데이터 관측치의 개수에서 추정된 계수값을 뺀 것을 잔차 추정에 대한 자유도(degree of freedom)라고 한다.</p>
<ul>
<li>빈도주의적 접근법에서 추정하는 회귀모델에서는 <span class="math inline">\(k\)</span>는 반드시 <span class="math inline">\(n\)</span>보다 작아야 한다. 그렇지 않으면 데이터는 완벽하게 적합되고 회귀모델의 오차를 전혀 추정할 수 없게 된다.</li>
</ul>
<div id="difficulties-in-interpreting-residual-standard-deviation-and-explained-variance" class="section level3" number="11.6.1">
<h3><span class="header-section-number">11.6.1</span> Difficulties in interpreting residual standard deviation and explained variance</h3>
<p>회귀모델에서 우리가 주로 관심을 가지고 있는 것은 변동성을 보여주는 <span class="math inline">\(\epsilon\)</span>보다 모델의 결정주의적인 요인들-<span class="math inline">\(X\beta\)</span>이다. 그러나 잔차의 표준편차도 살펴볼 필요가 있다. 동일한 <span class="math inline">\(\hat a _ \hat b x\)</span>를 가지고 있더라도 다른 <span class="math inline">\(\sigma\)</span> 값에 따라서 전달하는 함의가 크게 다를 수 있기 때문이다.</p>
<ul>
<li><p>예를 들어, 회귀선은 동일하더라도 <span class="math inline">\(\hat \sigma = 0.17\)</span>인 데이터와 <span class="math inline">\(\hat \sigma = 0.32\)</span>인 데이터를 놓고 보면 <span class="math inline">\(\hat \sigma = 0.32\)</span>인 데이터가 훨씬 관측치들이 넓게 분포하고 있는 것을 확인할 수 있다<span class="citation">(<a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>: 169)</span>.</p></li>
<li><p>마찬가지로 회귀선이 동일하더라도 <span class="math inline">\(R^2=0.3\)</span>인 경우와 <span class="math inline">\(R^2=0.1\)</span>인 경우도 전자가 데이터가 회귀선에 더 접하는 면이 많게 분포되어 모델이 <span class="math inline">\(y\)</span>의 변동량을 더 많이 설명하는 차이가 있다는 것을 알 수 있다<span class="citation">(<a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>: 169)</span>.</p></li>
</ul>
</div>
<div id="bayesian-r2" class="section level3" number="11.6.2">
<h3><span class="header-section-number">11.6.2</span> Bayesian <span class="math inline">\(R^2\)</span></h3>
<p><span class="math inline">\(R^2\)</span>는 적합된 모델의 점추정량에 따라 정의된다. 하지만 베이지언 추론에서는 항상 불확실성에 대해 고민하기 때문에, <span class="math inline">\(R^2\)</span>에 대한 접근 방식이 좀 다르다.</p>
<p>먼저 베이지언 <span class="math inline">\(R^2\)</span>란 단순하게 베이지언 예측, <span class="math inline">\(X\hat\beta\)</span>를 만들기 위해 <span class="math inline">\(\beta\)</span>에 대한 사후평균추정량을 사용해서 잔차의 표준편차를 컴퓨팅하고 그것을 <span class="math inline">\(R^2 = 1-(\hat \sigma^2/s^2_y)\)</span>에 대입하거나 평균 예측값의 표준편차를 컴퓨팅해 <span class="math inline">\(R^2 = V^n_{i=1}\hat y_i/s^2_y\)</span>에 대입하여 베이지언 <span class="math inline">\(R^2\)</span>을 구할 수 있다.</p>
<p>이 방식에는 두 가지 문제점이 있다:</p>
<ol style="list-style-type: decimal">
<li><p>베이지언 컴퓨테이션에서 점추정량을 사용하기 위한 불확실성을 놓쳐버리고 만다.</p></li>
<li><p>두 공식 중 두 번째 공식은 때로 <span class="math inline">\(R^2\)</span>가 1보다 큰 결과를 산출할 수 있다.</p>
<ul>
<li><p>적합된 모델이 종속변수의 100% 이상을 설명한다는 것은 상식적으로 말이 되지 않는다.</p></li>
<li><p>첫 번째 공식의 경우 추정된 잔차의 분산이 실제 데이터 분산보다 커서 추정된 <span class="math inline">\(R^2\)</span>가 0보다 작아질 수 있다는 문제점이 존재한다.</p></li>
</ul></li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-442"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-442-1.png" alt="Simple example showing the challenge of defining $R^2$ for a fitted Bayesian model. (a) Data, least squares regression line, and fitted Bayes line, which is a compromise between the prior and the least squares fit. The standard deviation of the fitted values from the Bayes model (the open circles on the line) is greater than the standard deviation of the data, so the usual definition of $R^2$ will not work. (b) Posterior mean fitted regression line along with 20 draws of the line from  the posterior distribution. We compute Bayesian $R^2$ by evaluating formula (11.5) for each posterior simulation draw and then taking the median." width="864" />
<p class="caption">
Figure 11.13: Simple example showing the challenge of defining <span class="math inline">\(R^2\)</span> for a fitted Bayesian model. (a) Data, least squares regression line, and fitted Bayes line, which is a compromise between the prior and the least squares fit. The standard deviation of the fitted values from the Bayes model (the open circles on the line) is greater than the standard deviation of the data, so the usual definition of <span class="math inline">\(R^2\)</span> will not work. (b) Posterior mean fitted regression line along with 20 draws of the line from the posterior distribution. We compute Bayesian <span class="math inline">\(R^2\)</span> by evaluating formula (11.5) for each posterior simulation draw and then taking the median.
</p>
</div>
<p>이 예제는 단순한 <span class="math inline">\(R^2\)</span>가 부적절할 수도 있다는 것을 보여준다. <span class="math inline">\(y = \beta_0 + \beta_1 x + \text{error}\)</span>라는 모델이 있고, <span class="math inline">\(\beta\)</span>에 대한 강한 사전정보가 존재하지만 그에 비해 관측치의 개수는 적다고 하자.</p>
<ul>
<li><p>먼저 최소자승회귀모델로 그린 회귀선은 <span class="math inline">\(R^2=0.77\)</span>의 모델 적합도를 갖는다고 하자.</p></li>
<li><p>베이지안 모델적합은 강한 사전정보로 <span class="math inline">\(\beta_0\sim N(0, 0.2)\)</span>이며, <span class="math inline">\(\beta_1\sim N(1, 0.2)\)</span>라고 하자.</p>
<ul>
<li><p>베이지안 모델로부터 적합된 값의 표준편차는 1.3이며 데이터의 표준편차는 1.08이다.</p></li>
<li><p>따라서 이 경우에 <span class="math inline">\(R^2 &gt; 1\)</span>이 된다.</p></li>
</ul></li>
</ul>
<p><span class="math inline">\(R^2\)</span>를 데이터의 예측분포를 바탕으로 나타내면 다음과 같다:</p>
<p><span class="math display">\[
\text{alternative }R^2 = \frac{\text{Explained variance}}{\text{Explained variance + Residual variance}} = \frac{\text{var}_\text{fit}}{\text{var}_\text{fit}+\text{var}_\text{res}}
\]</span></p>
<p>첫 번째 통계량은 새로운 데이터로부터 얻은 기대값의 분산이고 두 번째 항은 새로운 잔차로부터 얻은 기대분산이다.</p>
<p>베이지언 추론에서 우리는 일련의 사후 시뮬레이션으로 추출한 결과들을 가지고 작업한다. 각각의 시뮬레이션 추출된 표본 <span class="math inline">\(s\)</span>에 대해서 예측값 <span class="math inline">\(\hat y_i^s = X_i\beta^s\)</span>와 잔차의 분산 <span class="math inline">\(\sigma^2_s\)</span>의 벡터, 그리고 설명변동량의 비율을 컴퓨팅할 수 있다.</p>
<p><span class="math display">\[
\text{Bayesian } R^2_s = \frac{V^n_{i=1}\hat y_i^s}{V^n_{i=1}\hat y_i^s + \sigma^2_s}.
\]</span></p>
<p>이렇게 구한 결과는 항상 0과 1 사이에 위차하게 된다. 베이지언 버전에서는 <span class="math inline">\(\beta\)</span>에 대한 점추정량보다는 <span class="math inline">\(\beta\)</span>의 시뮬레이션된 값을 바탕으로 하는 예측값을 보여주게 된다.</p>
</div>
</div>
<div id="external-validation-checking-fitted-model-on-new-data" class="section level2" number="11.7">
<h2><span class="header-section-number">11.7</span> External validation: checking fitted model on new data</h2>
<p>모델을 검증하는 가장 기본적인 방법은 예측값과 실제 데이터를 비교하는 것이다.</p>
<ul>
<li><p>예측값의 경향이 실제 관측된 데이터의 경향성을 따라가는지</p></li>
<li><p>잔차와 예측값의 관계가 서로 독립적인지</p></li>
<li><p>잔차의 크기가 어느 정도인지(클수록 모델이 놓치는 부분이 많다는 것)</p></li>
</ul>
<p>자세한 예제는 <span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020, 172</a>)</span> 를 참고.</p>
</div>
<div id="cross-validation" class="section level2" number="11.8">
<h2><span class="header-section-number">11.8</span> Cross validation</h2>
<p>모델을 통해 얻은 예측값과 실제 데이터를 비교함으로써 적합도를 평가할 수도 있지만, 이 경우에는 예측값이 모델의 일반화 정도를 과대평가할 수 있다.</p>
<p>교차 타당화에서는 데이터의 일부를 사용해서 모델을 적합하고 그 일부를 제외한 나머지 데이터를 사용해서 미래의 데이터에 대한 일종의 대리(proxy; <code>hold-out-sest</code>이라고 한다)를 만들어서 추정해 비교한다.</p>
<p>모델링 작업에 따라서 데이터를 나누는 방법은 다양할 수 있다.</p>
<ul>
<li><p>개별 관측치를 빼가면서 수행하는 교차 타당화(<em>leave-one-out</em> cross validation)</p></li>
<li><p>일단의 관측치를 제외해가는 교차 타당화(<em>leave-one-group-out</em> cross validation)</p></li>
<li><p>과거의 데이터로 미래의 관측치를 예측하는 교차 타당화(<em>leave-future-out</em> corss validation)</p></li>
</ul>
<p>교차타당화는 추정과 평가에 있어서 동일한 데이터를 사용함에 따라 제기될 수 있는 과적합 문제를 해결하지만 얼마나 많은 수로 데이터를 나누어 적합시키느냐에 따른 비용이 소요될 수 있다.</p>
<div id="leave-one-out-cross-validation" class="section level3" number="11.8.1">
<h3><span class="header-section-number">11.8.1</span> Leave-one-out cross validation</h3>
<p>LOO는 개별 관측치를 제외할 때마다 <span class="math inline">\(n\)</span>번 모델을 적합해야 한다. R의 <code>loo</code> 패키지를 이용할 수 있다.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb251-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>; x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n; a <span class="ot">&lt;-</span> <span class="fl">0.2</span>; b <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb251-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb251-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb251-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1224</span>)</span>
<span id="cb251-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb251-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>x <span class="sc">+</span> sigma<span class="sc">*</span><span class="fu">rnorm</span>(n)</span>
<span id="cb251-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb251-5" aria-hidden="true" tabindex="-1"></a>fake <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span></code></pre></div>
<p>이 페이크데이터로부터 회귀모델을 하나 추정하고, 18번째 관측치를 빼고 다시 추정해보자.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb252-1" aria-hidden="true" tabindex="-1"></a>fit_all <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> fake, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb252-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb252-2" aria-hidden="true" tabindex="-1"></a>fit_minus_18 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> fake[<span class="sc">-</span><span class="dv">18</span>,], <span class="at">refresh =</span> <span class="dv">0</span>)</span></code></pre></div>
<p>이제 18번째 데이터 관측치에 대한 예측을 평가해보자. 사후 예측분포는 모든 가능한 모수값들에 걸쳐 평균을 내는 것으로 얻을 수 있다. 사후 시뮬레이션 표본추출을 이용해서,관측된 데이터 <span class="math inline">\(y\)</span>와 <span class="math inline">\(X\)</span>에 조건적인 예측변수 <span class="math inline">\(x^{new}\)</span>를 가진 <span class="math inline">\(y^{new}\)</span>의 새로운 데이터 관측치에 대한 사후 예측분포는 확률적 개념으로 다음과 같이 개략적으로 추정될 수 있다:</p>
<p><span class="math display">\[
\Pr(y^{\text{new}}|x^{\text{new}}) \approx \frac{1}{S}\sum^S_{s=1}\Pr(y^{\text{new}}|x^{\text{new}}, \beta^s, \sigma^s).
\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-445"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-445-1.png" alt="(a) Simulated data, along with the posterior mean and predictive distribution for the 18th data point from fitted linear regressions. The solid curve shows the posterior predictive distribution for $y_18$ given the line fit to all the data, and the dashed line shows the posterior predictive distribution given the line fit to all the data  except the 18th observation. (b) Residuals from the fitted models. Solid circles show residuals from the model fit to all the data; open circles show leave-one-out residuals, where each observation is compared to its expected value from the model holding that data point out of the fit." width="864" />
<p class="caption">
Figure 11.14: (a) Simulated data, along with the posterior mean and predictive distribution for the 18th data point from fitted linear regressions. The solid curve shows the posterior predictive distribution for <span class="math inline">\(y_18\)</span> given the line fit to all the data, and the dashed line shows the posterior predictive distribution given the line fit to all the data except the 18th observation. (b) Residuals from the fitted models. Solid circles show residuals from the model fit to all the data; open circles show leave-one-out residuals, where each observation is compared to its expected value from the model holding that data point out of the fit.
</p>
</div>
<p>LOO 교차 타당화에서는 모든 관측치를 한 번씩 제외하는 과정을 반복해야한다.</p>
</div>
<div id="fast-leave-one-out-cross-validation" class="section level3" number="11.8.2">
<h3><span class="header-section-number">11.8.2</span> Fast leave-one-out cross validation</h3>
<p>기존의 LOO 교차 타당화는 <span class="math inline">\(n\)</span>이 클수록 시간이 오래 걸린다는 단점이 있다. <code>{loo}</code> 패키지는 베이지언 추론에 입각하여 이 시간을 단축시키기 위한 함수를 제공한다.</p>
<ul>
<li><p>사후 분포를 사전분포와 가능도의 곱으로 계산하는 것이다.</p></li>
<li><p>만약 관측치들이 조건적으로 독립적이라면, 가능도는 모든 개별 관측치에 대한 산물일 것이다: 베이지언 개념에서 사후 분포 <span class="math inline">\(\Pr(\theta|y)\propto\Pr(\theta)\prod^n_{i=1}\Pr(y_i|\theta)\)</span>를 유도할 수 있다. 이때, <span class="math inline">\(\theta\)</span>는 모델 내 존재하는 모든 파라미터 값이며, 예측변수 <span class="math inline">\(X\)</span>에 조건적이다.</p></li>
</ul>
<p>여기서 자세한 추정 절차에 대해서는 논의하지 않는다. <span class="citation"><a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari</a> (<a href="#ref-ghv2020" role="doc-biblioref">2020, 174</a>)</span> 참고.</p>
</div>
<div id="summarizing-prediction-error-using-the-log-score-and-deviance" class="section level3" number="11.8.3">
<h3><span class="header-section-number">11.8.3</span> Summarizing prediction error using the log score and deviance</h3>
<p>모델 예측의 정확성을 평가하는 것에도 여러 가지 방법이 있다. 그 중 하나가 가능도에 로그값을 취한 뒤, 어떤 변수가 포함되었을 경우와 포함되지 않았을 경우에 모델의 설명력이 얼마나 변화하는지를 살펴보는 것이다.</p>
<p>보다 일반적으로 로그값은 비정규적인 오차 분포를 살펴볼 때 유용하며, 특정한 점추정량이 아니라 예측분포 전체의 정확성에 관심을 가지고 있을 때 그 사용이 적절하다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-446"></span>
<img src="regression-ghv_files/figure-html/unnamed-chunk-446-1.png" alt="Log posterior predictive densities and log LOO predictive densities from a regression model fitted to the data shown in Figure 11.20a. The solid circles represent log predictive densities relative to the model fit to all the data, and the open circles correspond to leave-one-out fits. The open circles are always lower than the solid circles, because removing an observation from the likelihood causes the model to fit less well to that data point." width="672" />
<p class="caption">
Figure 11.15: Log posterior predictive densities and log LOO predictive densities from a regression model fitted to the data shown in Figure 11.20a. The solid circles represent log predictive densities relative to the model fit to all the data, and the open circles correspond to leave-one-out fits. The open circles are always lower than the solid circles, because removing an observation from the likelihood causes the model to fit less well to that data point.
</p>
</div>
</div>
<div id="overfitting-and-aic" class="section level3" number="11.8.4">
<h3><span class="header-section-number">11.8.4</span> Overfitting and AIC</h3>
<p>교차 타당화는 과적합의 문제를 피하고자 수행하는 것이라고 했을 때, 이 과적합의 문제를 교정하는 또 다른 방법은 바로 모델에 적합된 파라미터의 수를 설명하는 로그 스코어를 조정하는 것이라고 할 수 있다.</p>
<ul>
<li><p>간단히 말하면, MLE를 사용한 모델에서는 <em>Akaike information criterion; AIC</em>라고 하는, AIC=<span class="math inline">\(\text{deviance}+2k\)</span>로 정의되는 값을 통해서 적합된 모델이 새로운 데이터를 예측할 경우에 얼마만큼의 편차를 추정할지 살펴볼 수 있다. 편차는 로그 스코어에 -2를 곱한 값이기 때문에 AIC는 과적합을 설명하기 위한 로그 스코어로부터 <span class="math inline">\(k\)</span>를 뺀 것과 같다.</p></li>
<li><p>더 간단히 말하면, 그냥 패널티를 주는 방법이다. 변수가 추가되어서 모델이 정말 더 많은 것을 설명하면 좋겠지만, 추가되서 설명하는 것보다 단지 추가되서 모델이 복잡해질 뿐이라면 안 넣느니만 못하다. 따라서 모델 내 파라미터의 수를 일종의 패널티로 모델의 설명력을 비교분석할 수 있는 지표가 AIC인 것이다.</p></li>
</ul>
</div>
<div id="interpreting-differences-in-log-scores" class="section level3" number="11.8.5">
<h3><span class="header-section-number">11.8.5</span> Interpreting differences in log scores</h3>
<p>로그 스코어를 직접적으로 해석하는 경우는 거의 없다. 우리는 대개 둘 이상의 모델의 로그 스코어 값을 구해 그 차이를 살펴본다.</p>
<ul>
<li><p>이 경우, 기준이 되는 비교 모델은 대개 아무런 선형 예측변수가 포함되지 않은, 절편값만 있는 모델이 된다.</p></li>
<li><p>절편만으로 종속변수를 설명했을 때와 비교하여 예측변수들이 추가될 때마다 얼마나 모델의 설명력이 개선되는지, 추가되는 것에 비해 개선이 형편없는지 등을 살펴보게 되는 것이다.</p></li>
</ul>
</div>
<div id="demonstration-of-adding-pure-noise-predictors-to-a-model" class="section level3" number="11.8.6">
<h3><span class="header-section-number">11.8.6</span> Demonstration of adding pure noise predictors to a model</h3>
<p>예측변수를 모델에 더할 때, 설사 그 예측변수가 순수한 잡음(pure noise)일지라도, 데이터에 대한 적합과 표본 내 예측된 측정지표는 일반적으로 개선된다. 즉, 변수를 추가하면 설명력은 자동으로 올라간다.</p>
<p>예측변수에 잡음이 추가되더라도 모델의 적합도는 개선되는 것을 확인할 수 있다<span class="citation">(<a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>: 176)</span>. 하지만 이를 통해 개선된 적합도가 바람직하다고 할 수 없다. 오히려 표본은 설명하되 우리가 가진 표본 이외의 데이터, 모집단을 보여줄 수 있는 또 다른 표본 등은 설명하지 못하는 과적합의 문제를 생각해볼 수 있다.</p>
</div>
<div id="k-fold-cross-validation" class="section level3" number="11.8.7">
<h3><span class="header-section-number">11.8.7</span> <span class="math inline">\(K\)</span>-fold cross validation</h3>
<p>LOO 교차 타당화는 이론적으로 <span class="math inline">\(n\)</span>번 반복해서 모델을 재적합할 것을 요구한다. 문제는 <span class="math inline">\(n\)</span>의 크기가 클수록 그 시간이 오래 걸리며, 불안정해질 수 있다는 것에 있다. 만약 LOO 교차타당화가 불안정하다면, <span class="math inline">\(K-fold\)</span> 교차 타당화를 대안으로 생각해볼 수 있다. <span class="math inline">\(K-fold\)</span> 교차 타당화는 데이터를 <span class="math inline">\(K\)</span>개의 서브셋으로 무작위로 세분하고 각 서브셋에 대한 적합을 나머지 데이터에 대한 모델 적합도에 기초하여 평가하는 것이다. 따라서 <span class="math inline">\(K-fold\)</span> 타당도는 오직 <span class="math inline">\(K\)</span>개의 새로운 모델 적합도만 필요하다.</p>
</div>
<div id="demonstration-of-k-fold-cross-validation-using-simulated-data" class="section level3" number="11.8.8">
<h3><span class="header-section-number">11.8.8</span> Demonstration of <span class="math inline">\(K\)</span>-fold cross validation using simulated data</h3>
<p>10-fold 교차 타당화를 페이크데이터를 통해 살펴보자. 무작위이지만 독립적이지는 않은 30개의 예측변수를 가진 <span class="math inline">\(60\times30\)</span>의 행렬을 시뮬레이팅하는 것에서 시작한다. <code>mvrnorm</code> 함수를 이용하여 0.8의 상관관계를 가진 다변량 정규분포로부터 시뮬레이션 표본을 추출해본다.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb253-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb253-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb253-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb253-3" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb253-4"><a href="assumptions-diagnostics-and-model-evaluation.html#cb253-4" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> rho<span class="sc">*</span><span class="fu">array</span>(<span class="dv">1</span>, <span class="fu">c</span>(k,k)) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>rho)<span class="sc">*</span><span class="fu">diag</span>(k)</span>
<span id="cb253-5"><a href="assumptions-diagnostics-and-model-evaluation.html#cb253-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="fu">rep</span>(<span class="dv">0</span>,k), Sigma)</span></code></pre></div>
<p>대충 (-1, 1, 2)로 자의적으로 설정한 세 개의 첫 번째 계수들, <span class="math inline">\(\beta_1, \beta_2, \beta_3\)</span>을 가진 모델 <span class="math inline">\(X\beta + \text{error}\)</span>로부터 <span class="math inline">\(y\)</span>를 시뮬레이션해보았다. 그리고 나머지 계수들은 0으로 일단 설정하고 독립적인 오차는 <span class="math inline">\(\sim N(0, 2)\)</span>라고 상정하였다:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb254-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">0</span>, k<span class="dv">-3</span>))</span>
<span id="cb254-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb254-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> X <span class="sc">%*%</span> b <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">rnorm</span>(n)</span>
<span id="cb254-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb254-3" aria-hidden="true" tabindex="-1"></a>fake <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, y)</span></code></pre></div>
<p>이제 약한 사전분포를 사용하여 선형 회귀모델을 적합해보자:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb255-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(y <span class="sc">~</span> ., <span class="at">prior=</span><span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), </span>
<span id="cb255-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb255-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>fake, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb255-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb255-3" aria-hidden="true" tabindex="-1"></a>loo_1 <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit_1)</span></code></pre></div>
<p>이때 <code>loo(fit_1)</code>는 다음과 같은 경고 메시지를 보이게 된다:</p>
<blockquote>
<p><code>Warning: Found 19 observations with a pareto_k &gt; 0.7.</code>
<code>With this many problematic observations we recommend calling 'kfold'</code>
<code>with argument 'K=10' to perform 10-fold cross-validation rather than LOO.</code></p>
</blockquote>
<p>따라서 메시지에 따라 다음과 같이 설정해준다.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb256-1" aria-hidden="true" tabindex="-1"></a>kfold_1 <span class="ot">&lt;-</span> <span class="fu">kfold</span>(fit_1, <span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb256-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kfold_1)</span></code></pre></div>
<pre><code>## 
## Based on 10-fold cross-validation
## 
##            Estimate  SE
## elpd_kfold    -75.9 1.0
## p_kfold          NA  NA
## kfoldic       151.7 2.0</code></pre>
<p>무작위로 세분화된 데이터는 약 10개의 비슷한 규모로 나뉘어지며, 우리는 모델을 10번 적합하되, 적합할 때마다 데이터의 9/10씩 적합하는 것과 같다. 이 결과는 교차 타당화를 수행해서 얻은 데이터의 추정된 로그 스코어 값이며, LOO에 따라 동일한 척도 위에 놓인 것이다.</p>
<p>다음으로는 좀 더 정보를 포함한 사전정보를 이용해서 대안 모델들로부터 얻은 적합도를 약한 사전정보로 추정했던 모델의 적합도와 비교하는 것이다.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="assumptions-diagnostics-and-model-evaluation.html#cb258-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">update</span>(fit_1, <span class="at">prior=</span><span class="fu">hs</span>())</span>
<span id="cb258-2"><a href="assumptions-diagnostics-and-model-evaluation.html#cb258-2" aria-hidden="true" tabindex="-1"></a>kfold_2 <span class="ot">&lt;-</span> <span class="fu">kfold</span>(fit_2, <span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb258-3"><a href="assumptions-diagnostics-and-model-evaluation.html#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(kfold_1, kfold_2)</span></code></pre></div>
<pre><code>##       elpd_diff se_diff
## fit_2   0.0       0.0  
## fit_1 -33.2       2.7</code></pre>
<p>로그 스코어에 대한 두 교차 타당화 추정량을 비교한 결과를 제시한다. 이 결과에 따르면 모델 2가 모델 1보다 더 퍼포먼스가 좋다. 설명을 잘 한다는 것을 의미한다.</p>
</div>
<div id="concerns-about-model-selection" class="section level3" number="11.8.9">
<h3><span class="header-section-number">11.8.9</span> Concerns about model selection</h3>
<p>여러 개의 모델을 염두에 두고 있을 때, 교차 타당화를 이용해 예측 성과가 더 좋을 것을 비교 및 평가해서 모델을 선택할 수 있다. 하지만 모델을 이처럼 추정된 예측 성과를 최적화하는 모델로 선정하는 것이 좋은 결과를 가져오는 것은 아니다.</p>
<ol style="list-style-type: decimal">
<li><p>목표가 우리가 획득한 것/관측한 것과 같은 데이터에 대한 예측뿐이라고 한다면, 단지 하나를 고르기보다는 여러 모델들을 평균내는 것이 더 좋을 수도 있다.</p></li>
<li><p>만약 새로운 데이터셋에 대한 예측이 목적이라면 표본과 모집단 간의 차이를 설명할 수 있는 예측 오차들에 대한 가중치를 부여하는 것이 필요하다.</p></li>
<li><p>여러 모델들 가운데 하나를 선택하거나 평균을 내는 것보다 더 나은 것은 앞선 모델을 포괄할 수 있는 확장된 모델을 수립하는 것일 수 있다.</p></li>
<li><p>인과추론이라는 측면에서 모델에 중간결과가 포함되었을 때, 회귀계수를 해석하는 것이 더 어려워질 수 있다. 따라서 일반적으로 모델의 영향력을 높이는 변수라고 할지라도 사후처치 변수들을 모델에 포함하는 것을 추천하지 않는다<span class="citation">(<a href="#ref-ghv2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>: 180)</span>.</p>
<ul>
<li><p>만약 사후처치 예측변수들이 인과성을 보여주고자 하는 회귀모델에 포함된다면, 추정된 처치 효과를 떼어내기 위해 추가적인 노력이 요구된다.</p></li>
<li><p>이 경우이는 단순히 처치변수의 계수값만 보는 것으로는 충분하지 않기 때문이다.</p></li>
</ul></li>
</ol>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ghv2020" class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regression-with-multiple-predictors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="transformations-and-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
